<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EAST5.0监管报送项目评估系统</title>

  <!-- Bank System Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Microsoft+YaHei:wght@400;500;700&family=SimHei:wght@400;700&display=swap" rel="stylesheet">

  <!-- Element Plus UI for Banking -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

  <!-- Element Plus -->
  <script src="https://unpkg.com/element-plus"></script>

  <!-- Custom Banking System Styles -->
  <style>
    * {
      font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #f0f2f5;
      color: #333;
      overflow: hidden;
    }

    /* Banking System Color Palette */
    :root {
      --bank-primary-dark: #1e3a8a;
      --bank-primary: #2563eb;
      --bank-primary-light: #3b82f6;
      --bank-secondary: #64748b;
      --bank-success: #059669;
      --bank-warning: #d97706;
      --bank-danger: #dc2626;
      --bank-bg-main: #f0f2f5;
      --bank-bg-sidebar: #1f2937;
      --bank-bg-card: #ffffff;
      --bank-border: #e5e7eb;
      --bank-text-primary: #111827;
      --bank-text-secondary: #6b7280;
    }

    /* Banking System Layout */
    .bank-layout {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    .bank-sidebar {
      width: 260px;
      background: var(--bank-bg-sidebar);
      color: white;
      flex-shrink: 0;
      overflow-y: auto;
      transition: all 0.3s ease;
    }

    .bank-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .bank-header {
      height: 60px;
      background: var(--bank-bg-card);
      border-bottom: 1px solid var(--bank-border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      flex-shrink: 0;
    }

    .bank-content {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: var(--bank-bg-main);
    }

    /* Bank Header Styles */
    .bank-header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .bank-header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .bank-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--bank-primary-dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .bank-user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--bank-text-secondary);
    }

    .bank-user-avatar {
      width: 36px;
      height: 36px;
      background: var(--bank-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 14px;
    }

    /* Bank Sidebar Styles */
    .bank-sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(0, 0, 0, 0.2);
    }

    .bank-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
    }

    .bank-logo-icon {
      width: 40px;
      height: 40px;
      background: var(--bank-primary);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bank-logo-text {
      font-size: 16px;
      font-weight: 600;
    }

    .bank-logo-subtitle {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 2px;
    }

    .bank-menu {
      padding: 15px 0;
    }

    .bank-menu-item {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.2s ease;
      cursor: pointer;
      border-left: 3px solid transparent;
      font-size: 14px;
    }

    .bank-menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .bank-menu-item.active {
      background: rgba(37, 99, 235, 0.2);
      color: white;
      border-left-color: var(--bank-primary);
    }

    .bank-menu-icon {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bank-menu-subtitle {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.6);
      margin-top: 2px;
    }

    /* Bank Card Styles */
    .bank-card {
      background: var(--bank-bg-card);
      border: 1px solid var(--bank-border);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .bank-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--bank-border);
    }

    .bank-card-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--bank-text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .bank-card-subtitle {
      font-size: 12px;
      color: var(--bank-text-secondary);
      margin-top: 4px;
    }

    /* Bank Form Styles */
    .bank-form {
      display: grid;
      gap: 20px;
    }

    .bank-form-group {
      display: grid;
      gap: 8px;
    }

    .bank-form-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--bank-text-primary);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .bank-form-label.required::after {
      content: '*';
      color: var(--bank-danger);
    }

    .bank-form-control {
      padding: 8px 12px;
      border: 1px solid var(--bank-border);
      border-radius: 4px;
      font-size: 14px;
      transition: all 0.2s ease;
      background: white;
    }

    .bank-form-control:focus {
      outline: none;
      border-color: var(--bank-primary);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
    }

    /* Bank Button Styles */
    .bank-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .bank-btn-primary {
      background: var(--bank-primary);
      color: white;
    }

    .bank-btn-primary:hover {
      background: var(--bank-primary-dark);
    }

    .bank-btn-secondary {
      background: var(--bank-bg-card);
      color: var(--bank-text-primary);
      border: 1px solid var(--bank-border);
    }

    .bank-btn-secondary:hover {
      background: #f8fafc;
    }

    .bank-btn-success {
      background: var(--bank-success);
      color: white;
    }

    .bank-btn-warning {
      background: var(--bank-warning);
      color: white;
    }

    .bank-btn-danger {
      background: var(--bank-danger);
      color: white;
    }

    /* Bank Table Styles */
    .bank-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--bank-bg-card);
      border: 1px solid var(--bank-border);
      border-radius: 8px;
      overflow: hidden;
    }

    .bank-table th,
    .bank-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--bank-border);
      font-size: 14px;
    }

    .bank-table th {
      background: #f8fafc;
      font-weight: 600;
      color: var(--bank-text-primary);
    }

    .bank-table tbody tr:hover {
      background: #f8fafc;
    }

    .bank-table tbody tr:last-child td {
      border-bottom: none;
    }

    /* Bank Status Badge */
    .bank-badge {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      display: inline-block;
    }

    .bank-badge-primary {
      background: rgba(37, 99, 235, 0.1);
      color: var(--bank-primary);
    }

    .bank-badge-success {
      background: rgba(5, 150, 105, 0.1);
      color: var(--bank-success);
    }

    .bank-badge-warning {
      background: rgba(217, 119, 6, 0.1);
      color: var(--bank-warning);
    }

    .bank-badge-danger {
      background: rgba(220, 38, 38, 0.1);
      color: var(--bank-danger);
    }

    /* Bank Progress Bar */
    .bank-progress {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
    }

    .bank-progress-bar {
      height: 100%;
      background: var(--bank-primary);
      transition: width 0.3s ease;
    }
    .gradient-warning {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }
    .gradient-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    /* Glass effect */
    .glass {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Enhanced Animations */
    @keyframes slideInUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes slideInDown {
      from { transform: translateY(-30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes slideInLeft {
      from { transform: translateX(-30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideInRight {
      from { transform: translateX(30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    @keyframes bounce {
      0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
      40%, 43% { transform: translate3d(0, -30px, 0); }
      70% { transform: translate3d(0, -15px, 0); }
      90% { transform: translate3d(0, -4px, 0); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.5); }
      50% { box-shadow: 0 0 40px rgba(59, 130, 246, 0.8); }
    }
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    @keyframes scale {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
      20%, 40%, 60%, 80% { transform: translateX(10px); }
    }

    .animate-slide-up {
      animation: slideInUp 0.6s ease-out;
    }
    .animate-slide-down {
      animation: slideInDown 0.6s ease-out;
    }
    .animate-slide-left {
      animation: slideInLeft 0.6s ease-out;
    }
    .animate-slide-right {
      animation: slideInRight 0.6s ease-out;
    }
    .animate-fade-in {
      animation: fadeIn 0.6s ease-out;
    }
    .animate-pulse-slow {
      animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    .animate-bounce {
      animation: bounce 1s infinite;
    }
    .animate-float {
      animation: float 3s ease-in-out infinite;
    }
    .animate-glow {
      animation: glow 2s ease-in-out infinite;
    }
    .animate-rotate {
      animation: rotate 2s linear infinite;
    }
    .animate-scale {
      animation: scale 2s ease-in-out infinite;
    }
    .animate-shake {
      animation: shake 0.5s;
    }
    .shimmer {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 1000px 100%;
      animation: shimmer 2s infinite;
    }

    /* Enhanced Button styles */
    .btn {
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      text-transform: none;
      letter-spacing: 0.025em;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:active {
      transform: scale(0.95);
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: white;
      color: #374151;
      border: 2px solid #e5e7eb;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .btn-secondary:hover {
      border-color: #3b82f6;
      color: #3b82f6;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      transform: translateY(-2px);
    }

    .btn-success {
      background: linear-gradient(135deg, #10b981 0%, #047857 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
    }

    .btn-ghost {
      background: transparent;
      color: #374151;
      border: 2px solid transparent;
    }

    .btn-ghost:hover {
      background: #f9fafb;
      border-color: #e5e7eb;
    }

    /* Card styles */
    .card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      border: 1px solid #f1f5f9;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6, #10b981);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card:hover {
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      transform: translateY(-4px);
    }

    .card:hover::before {
      opacity: 1;
    }

    /* Enhanced form controls */
    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: white;
    }

    .form-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      transform: translateY(-2px);
    }

    .form-input::placeholder {
      color: #9ca3af;
    }

    /* Loading states */
    .loading {
      position: relative;
      pointer-events: none;
      opacity: 0.7;
    }

    .loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #3b82f6;
      border-radius: 50%;
      animation: rotate 1s linear infinite;
    }

    /* Progress indicators */
    .progress {
      width: 100%;
      height: 8px;
      background: #f1f5f9;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6);
      border-radius: 4px;
      transition: width 0.3s ease;
      position: relative;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      animation: shimmer 2s infinite;
    }

    /* Notification styles */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 20px;
      border-radius: 12px;
      background: white;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border-left: 4px solid #3b82f6;
      z-index: 1000;
      transform: translateX(400px);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.success {
      border-left-color: #10b981;
    }

    .notification.warning {
      border-left-color: #f59e0b;
    }

    .notification.error {
      border-left-color: #ef4444;
    }

    /* Hover states and micro-interactions */
    .hover-lift {
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-lift:hover {
      transform: translateY(-2px);
    }

    .hover-scale {
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hover-scale:hover {
      transform: scale(1.02);
    }

    .hover-glow:hover {
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
    }

    /* Comprehensive Responsive Design */

    /* Extra large devices (1200px and up) */
    @media (min-width: 1200px) {
      .container-desktop {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }
    }

    /* Large devices (desktops, 992px and up) */
    @media (min-width: 992px) and (max-width: 1199.98px) {
      .container-desktop {
        max-width: 960px;
      }
      .sidebar-col {
        flex: 0 0 25%;
        max-width: 25%;
      }
      .main-content-col {
        flex: 0 0 75%;
        max-width: 75%;
      }
    }

    /* Medium devices (tablets, 768px and up) */
    @media (min-width: 768px) and (max-width: 991.98px) {
      .container-desktop {
        max-width: 720px;
        padding: 0 1.5rem;
      }
      .sidebar-col {
        flex: 0 0 30%;
        max-width: 30%;
      }
      .main-content-col {
        flex: 0 0 70%;
        max-width: 70%;
      }
      .grid-cols-3 {
        grid-template-columns: repeat(2, 1fr);
      }
      .grid-cols-4 {
        grid-template-columns: repeat(3, 1fr);
      }
      .text-h1 {
        font-size: 2rem;
        line-height: 2.5rem;
      }
      .text-h2 {
        font-size: 1.75rem;
        line-height: 2.25rem;
      }
    }

    /* Small devices (landscape phones, 576px and up) */
    @media (min-width: 576px) and (max-width: 767.98px) {
      .container-desktop {
        max-width: 540px;
        padding: 0 1rem;
      }
      .grid-cols-2,
      .grid-cols-3,
      .grid-cols-4 {
        grid-template-columns: repeat(2, 1fr);
      }
      .main-grid {
        grid-template-columns: 1fr;
      }
      .sidebar-col {
        order: 2;
        margin-top: 2rem;
      }
      .main-content-col {
        order: 1;
      }
      .sidebar .card {
        position: static;
      }
      .header-actions {
        flex-wrap: wrap;
        gap: 0.5rem;
      }
      .collaboration-status {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
    }

    /* Extra small devices (portrait phones, less than 576px) */
    @media (max-width: 575.98px) {
      .container-desktop {
        padding: 0 0.75rem;
      }

      /* Header mobile optimizations */
      header {
        padding: 1rem 0;
      }
      header .container {
        padding: 0 0.75rem;
      }
      .header-content {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }
      .header-logo {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
      .header-logo h1 {
        font-size: 1.25rem;
        line-height: 1.75rem;
      }
      .header-logo p {
        font-size: 0.875rem;
      }
      .header-actions {
        width: 100%;
        justify-content: space-between;
      }
      .collaboration-info {
        display: none;
      }
      .collaboration-buttons {
        display: flex;
        gap: 0.5rem;
      }

      /* Layout mobile optimizations */
      .main-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
      .sidebar-col {
        order: 2;
        margin-top: 1rem;
      }
      .main-content-col {
        order: 1;
      }
      .sidebar .card {
        position: static;
        margin-bottom: 1rem;
      }

      /* Grid mobile optimizations */
      .grid-cols-1,
      .grid-cols-2,
      .grid-cols-3,
      .grid-cols-4,
      .grid-cols-5,
      .grid-cols-6 {
        grid-template-columns: 1fr;
        gap: 0.75rem;
      }
      .md\\:grid-cols-2,
      .lg\\:grid-cols-2,
      .lg\\:grid-cols-3,
      .md\\:grid-cols-3,
      .md\\:grid-cols-4 {
        grid-template-columns: 1fr;
      }

      /* Card mobile optimizations */
      .card {
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 0.75rem;
      }
      .card p {
        font-size: 0.875rem;
        line-height: 1.5;
      }

      /* Button mobile optimizations */
      .btn {
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        border-radius: 8px;
        min-height: 44px; /* Touch-friendly size */
      }
      .btn-sm {
        padding: 0.5rem 0.75rem;
        font-size: 0.75rem;
        min-height: 36px;
      }
      .btn-lg {
        padding: 1rem 1.5rem;
        font-size: 1rem;
        min-height: 52px;
      }
      .btn-mobile-full {
        width: 100%;
        justify-content: center;
      }

      /* Form mobile optimizations */
      .form-input {
        padding: 0.75rem;
        font-size: 16px; /* Prevents zoom on iOS */
        border-radius: 8px;
        min-height: 44px;
      }
      .form-label {
        font-size: 0.875rem;
        margin-bottom: 0.25rem;
      }

      /* Text mobile optimizations */
      .text-h1 {
        font-size: 1.5rem;
        line-height: 2rem;
        margin-bottom: 0.5rem;
      }
      .text-h2 {
        font-size: 1.25rem;
        line-height: 1.75rem;
        margin-bottom: 0.5rem;
      }
      .text-h3 {
        font-size: 1.125rem;
        line-height: 1.5rem;
        margin-bottom: 0.25rem;
      }
      .text-h4 {
        font-size: 1rem;
        line-height: 1.5rem;
      }
      .text-body-large {
        font-size: 1rem;
        line-height: 1.5rem;
      }
      .text-body-base {
        font-size: 0.875rem;
        line-height: 1.5rem;
      }
      .text-body-small {
        font-size: 0.75rem;
        line-height: 1.25rem;
      }

      /* Navigation mobile optimizations */
      .nav-item {
        padding: 0.75rem;
        border-radius: 8px;
        margin-bottom: 0.25rem;
      }
      .nav-item svg {
        width: 1rem;
        height: 1rem;
      }
      .nav-item span {
        font-size: 0.875rem;
      }

      /* Stats mobile optimizations */
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
      }
      .stat-card {
        padding: 0.75rem;
        text-align: center;
      }
      .stat-value {
        font-size: 1.25rem;
      }
      .stat-label {
        font-size: 0.75rem;
      }

      /* Table mobile optimizations */
      .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      .mobile-table {
        font-size: 0.75rem;
      }
      .mobile-table th,
      .mobile-table td {
        padding: 0.5rem;
        white-space: nowrap;
      }

      /* Modal mobile optimizations */
      .modal-content {
        margin: 1rem;
        max-width: calc(100% - 2rem);
        max-height: calc(100vh - 2rem);
        border-radius: 12px;
      }
      .modal-header {
        padding: 1rem;
        border-bottom: 1px solid #e5e7eb;
      }
      .modal-body {
        padding: 1rem;
        overflow-y: auto;
        max-height: calc(100vh - 8rem);
      }
      .modal-footer {
        padding: 1rem;
        border-top: 1px solid #e5e7eb;
        flex-direction: column;
        gap: 0.5rem;
      }
      .modal-footer .btn {
        width: 100%;
      }

      /* Chart mobile optimizations */
      .chart-container {
        height: 250px !important;
        margin: 1rem 0;
      }
      .chart-legend {
        font-size: 0.75rem;
        flex-wrap: wrap;
        gap: 0.25rem;
      }

      /* Timeline mobile optimizations */
      .timeline {
        padding-left: 1.5rem;
      }
      .timeline::before {
        left: 0.25rem;
      }
      .timeline-item::before {
        left: -0.75rem;
        width: 0.75rem;
        height: 0.75rem;
      }
      .timeline-item {
        padding-bottom: 1rem;
      }

      /* Progress bar mobile optimizations */
      .progress {
        height: 6px;
        border-radius: 3px;
      }
      .progress-bar {
        border-radius: 3px;
      }

      /* Badge mobile optimizations */
      .badge {
        padding: 0.25rem 0.5rem;
        font-size: 0.625rem;
        border-radius: 0.25rem;
      }

      /* Tooltip mobile optimizations */
      .tooltip {
        display: none; /* Hide tooltips on mobile */
      }

      /* Tabs mobile optimizations */
      .tabs {
        border-bottom: 1px solid #e5e7eb;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      .tab {
        padding: 0.75rem 1rem;
        font-size: 0.875rem;
        white-space: nowrap;
        border-bottom: 2px solid transparent;
      }
      .tab.active {
        border-bottom-color: #3b82f6;
        color: #3b82f6;
      }

      /* Alert mobile optimizations */
      .alert {
        padding: 0.75rem;
        border-radius: 8px;
        font-size: 0.875rem;
      }

      /* Pagination mobile optimizations */
      .pagination {
        justify-content: center;
        flex-wrap: wrap;
        gap: 0.25rem;
      }
      .pagination-item {
        min-width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        font-size: 0.875rem;
      }

      /* Breadcrumb mobile optimizations */
      .breadcrumb {
        flex-wrap: wrap;
        gap: 0.25rem;
        font-size: 0.75rem;
      }
      .breadcrumb-item {
        white-space: nowrap;
      }

      /* Spinner mobile optimizations */
      .spinner {
        width: 1.5rem;
        height: 1.5rem;
        border-width: 0.125rem;
      }

      /* Floating action button for mobile */
      .fab {
        position: fixed;
        bottom: 1rem;
        right: 1rem;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
        color: white;
        border: none;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        transition: all 0.3s ease;
      }
      .fab:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
      }

      /* Mobile-specific utilities */
      .mobile-hidden {
        display: none !important;
      }
      .mobile-block {
        display: block !important;
      }
      .mobile-flex {
        display: flex !important;
      }
      .mobile-text-center {
        text-align: center !important;
      }
      .mobile-px-2 {
        padding-left: 0.5rem;
        padding-right: 0.5rem;
      }
      .mobile-py-4 {
        padding-top: 1rem;
        padding-bottom: 1rem;
      }
      .mobile-mb-4 {
        margin-bottom: 1rem;
      }
      .mobile-mt-4 {
        margin-top: 1rem;
      }

      /* Touch-friendly interactions */
      .mobile-tappable {
        min-height: 44px;
        min-width: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Swipe gestures support */
      .swipe-container {
        touch-action: pan-x;
        overflow-x: hidden;
      }

      /* Mobile keyboard optimizations */
      input[type="text"],
      input[type="email"],
      input[type="password"],
      input[type="number"],
      textarea,
      select {
        font-size: 16px; /* Prevents zoom on iOS */
      }

      /* Safe area support for iPhone X and up */
      @supports (padding: max(0px)) {
        .safe-area-top {
          padding-top: max(1rem, env(safe-area-inset-top));
        }
        .safe-area-bottom {
          padding-bottom: max(1rem, env(safe-area-inset-bottom));
        }
        .safe-area-left {
          padding-left: max(0.75rem, env(safe-area-inset-left));
        }
        .safe-area-right {
          padding-right: max(0.75rem, env(safe-area-inset-right));
        }
      }
    }

    /* Landscape mobile optimizations */
    @media (max-width: 767.98px) and (orientation: landscape) {
      .header-content {
        flex-direction: row;
        align-items: center;
      }
      .modal-content {
        max-height: 90vh;
      }
      .chart-container {
        height: 200px !important;
      }
    }

    /* High DPI displays */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .border-custom {
        border-width: 0.5px;
      }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    /* Mobile-specific additional styles */
    .mobile-device .mobile-hidden {
      display: none !important;
    }

    .mobile-device .mobile-block {
      display: block !important;
    }

    .mobile-device .mobile-flex {
      display: flex !important;
    }

    .mobile-device .mobile-tappable {
      min-height: 44px;
      min-width: 44px;
    }

    .mobile-device .mobile-focus {
      outline: 2px solid #3b82f6;
      outline-offset: 2px;
    }

    .mobile-device .sidebar {
      position: fixed;
      top: 0;
      left: -100%;
      width: 280px;
      height: 100vh;
      background: white;
      z-index: 999;
      transition: left 0.3s ease;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }

    .mobile-device .sidebar.active {
      left: 0;
    }

    .mobile-device .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      z-index: 998;
      display: none;
    }

    .mobile-device .sidebar-overlay.active {
      display: block;
    }

    .mobile-device .container-desktop {
      padding-left: 1rem;
      padding-right: 1rem;
    }

    .mobile-device .card {
      margin-bottom: 1rem;
      border-radius: 12px;
    }

    .mobile-device .btn {
      min-height: 44px;
      padding: 0.75rem 1rem;
      font-size: 0.875rem;
      border-radius: 8px;
    }

    .mobile-device .modal {
      padding: 1rem;
    }

    .mobile-device .modal-content {
      margin: 1rem;
      max-height: calc(100vh - 2rem);
      border-radius: 12px;
    }

    .mobile-device .chart-container {
      height: 250px !important;
    }

    .mobile-device .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .mobile-device .form-input {
      font-size: 16px; /* Prevents zoom on iOS */
      padding: 0.75rem;
      border-radius: 8px;
      min-height: 44px;
    }

    .touch-device:hover {
      /* Disable hover effects on touch devices */
      background-color: inherit !important;
      transform: none !important;
      box-shadow: inherit !important;
    }

    .mobile-optimized {
      /* Performance optimizations for mobile */
      will-change: transform;
      backface-visibility: hidden;
      perspective: 1000px;
    }

    .mobile-optimized .animate-slide-up,
    .mobile-optimized .animate-slide-down,
    .mobile-optimized .animate-slide-left,
    .mobile-optimized .animate-slide-right {
      animation-duration: 0.3s !important;
    }

    .mobile-optimized .animate-pulse-slow,
    .mobile-optimized .animate-float,
    .mobile-optimized .animate-glow {
      animation: none !important;
    }

    /* Tablet-specific styles */
    .tablet-device .container-desktop {
      padding-left: 1.5rem;
      padding-right: 1.5rem;
    }

    .tablet-device .sidebar {
      position: static;
      width: auto;
      height: auto;
    }

    .tablet-device .grid-cols-4 {
      grid-template-columns: repeat(3, 1fr);
    }

    .tablet-device .chart-container {
      height: 300px !important;
    }

    /* Desktop-specific styles */
    .desktop-device .fab {
      display: none;
    }

    .desktop-device .mobile-menu {
      display: none !important;
    }

    /* Safe area adjustments for notched devices */
    @supports (padding: max(0px)) {
      .mobile-device {
        padding-left: max(1rem, env(safe-area-inset-left));
        padding-right: max(1rem, env(safe-area-inset-right));
      }

      .mobile-device header {
        padding-top: max(1rem, env(safe-area-inset-top));
      }

      .mobile-device .fab {
        bottom: max(1rem, env(safe-area-inset-bottom));
        right: max(1rem, env(safe-area-inset-right));
      }
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
      .card {
        border: 2px solid #000;
      }

      .btn {
        border: 2px solid #000;
      }

      .form-input {
        border: 2px solid #000;
      }
    }

    /* Mobile landscape adjustments */
    @media (max-width: 767.98px) and (orientation: landscape) {
      .header-content {
        flex-direction: row;
        align-items: center;
        padding: 0.5rem 0;
      }

      .header-logo h1 {
        font-size: 1rem;
      }

      .header-logo p {
        display: none;
      }

      .fab {
        bottom: 0.5rem;
        right: 0.5rem;
        width: 48px;
        height: 48px;
      }

      .chart-container {
        height: 200px !important;
      }
    }

    /* Dark mode mobile adjustments */
    @media (prefers-color-scheme: dark) and (max-width: 767.98px) {
      .mobile-device .card {
        background: #1f2937;
        border-color: #374151;
      }

      .mobile-device .sidebar {
        background: #1f2937;
        color: #f9fafb;
      }

      .mobile-device .modal-content {
        background: #1f2937;
        color: #f9fafb;
      }
    }

    /* User Management Styles */
    .user-section {
      position: relative;
    }

    #user-menu {
      min-width: 256px;
      max-width: 320px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(8px);
    }

    #user-menu::before {
      content: '';
      position: absolute;
      top: -8px;
      right: 20px;
      width: 16px;
      height: 16px;
      background: white;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-bottom: none;
      border-right: none;
      transform: rotate(45deg);
    }

    .form-checkbox {
      width: 1rem;
      height: 1rem;
      color: #3b82f6;
      border-radius: 0.25rem;
    }

    .form-checkbox:checked {
      background-color: #3b82f6;
      border-color: #3b82f6;
    }

    .no-animations * {
      animation: none !important;
      transition: none !important;
    }

    .user-avatar {
      transition: all 0.3s ease;
    }

    .user-avatar:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }

    .permission-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .permission-item {
      padding: 0.75rem;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      background: #f9fafb;
      transition: all 0.3s ease;
    }

    .permission-item:hover {
      border-color: #3b82f6;
      background: #eff6ff;
    }

    .team-member-table {
      border-collapse: collapse;
      width: 100%;
    }

    .team-member-table th,
    .team-member-table td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    .team-member-table tbody tr:hover {
      background: #f9fafb;
    }

    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 0.5rem;
    }

    .status-online {
      background: #10b981;
      animation: pulse 2s infinite;
    }

    .status-offline {
      background: #6b7280;
    }

    .status-busy {
      background: #f59e0b;
    }

    /* Mobile user menu adjustments */
    @media (max-width: 767.98px) {
      #user-menu {
        position: fixed;
        top: 0;
        right: 0;
        left: 0;
        bottom: 0;
        max-width: 100%;
        border-radius: 0;
        margin: 0;
      }

      #user-menu::before {
        display: none;
      }

      .permission-grid {
        grid-template-columns: 1fr;
      }
    }

    /* User profile picture styles */
    .profile-picture {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #3b82f6;
      margin: 0 auto 1rem;
      display: block;
    }

    .role-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .role-admin {
      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
      color: white;
    }

    .role-manager {
      background: linear-gradient(135deg, #10b981 0%, #047857 100%);
      color: white;
    }

    .role-user {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      color: white;
    }

    .role-viewer {
      background: linear-gradient(135deg, #6b7280 0%, #374151 100%);
      color: white;
    }

    /* Permission tree styles */
    .permission-tree {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .permission-tree li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f3f4f6;
    }

    .permission-tree li:last-child {
      border-bottom: none;
    }

    .permission-category {
      font-weight: 600;
      color: #1f2937;
      margin-bottom: 0.5rem;
      display: block;
    }

    .permission-item-checkbox {
      display: flex;
      align-items: center;
      padding: 0.25rem 0;
      margin-left: 1rem;
    }

    .permission-item-checkbox input[type="checkbox"] {
      margin-right: 0.5rem;
    }

    /* User settings toggle switches */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 3rem;
      height: 1.5rem;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #cbd5e1;
      transition: 0.3s;
      border-radius: 1.5rem;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 1.125rem;
      width: 1.125rem;
      left: 0.1875rem;
      bottom: 0.1875rem;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: #3b82f6;
    }

    input:checked + .toggle-slider:before {
      transform: translateX(1.5rem);
    }

    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      .card {
        background: #1f2937;
        border-color: #374151;
      }

      .form-input {
        background: #374151;
        border-color: #4b5563;
        color: #f9fafb;
      }

      .form-input::placeholder {
        color: #6b7280;
      }
    }
      gap: 8px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
      color: white;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
    }
    .btn-secondary {
      background: white;
      color: #475569;
      border: 2px solid #e2e8f0;
    }
    .btn-secondary:hover {
      background: #f8fafc;
      border-color: #cbd5e1;
    }

    /* Card styles */
    .card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
      transition: all 0.3s ease;
    }
    .card:hover {
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      transform: translateY(-4px);
    }

    /* Status badges */
    .badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    .badge-success {
      background: #10b981;
      color: white;
    }
    .badge-warning {
      background: #f59e0b;
      color: white;
    }
    .badge-danger {
      background: #ef4444;
      color: white;
    }
    .badge-info {
      background: #3b82f6;
      color: white;
    }

    /* Progress bars */
    .progress {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #1e40af);
      border-radius: 4px;
      transition: width 1s ease;
    }

    /* Sidebar navigation */
    .nav-item {
      padding: 12px 16px;
      border-radius: 8px;
      transition: all 0.2s ease;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .nav-item:hover {
      background: #f1f5f9;
    }
    .nav-item.active {
      background: #dbeafe;
      color: #1e40af;
      font-weight: 600;
    }

    /* Loading states */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Tabs */
    .tab {
      padding: 12px 24px;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
      cursor: pointer;
      font-weight: 500;
    }
    .tab:hover {
      color: #3b82f6;
    }
    .tab.active {
      color: #1e40af;
      border-bottom-color: #3b82f6;
    }

    /* Table styles */
    .table {
      width: 100%;
      border-collapse: collapse;
    }
    .table th {
      background: #f8fafc;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      color: #374151;
      border-bottom: 1px solid #e5e7eb;
    }
    .table td {
      padding: 12px;
      border-bottom: 1px solid #f3f4f6;
    }
    .table tr:hover {
      background: #f9fafb;
    }

    /* Metric cards */
    .metric-card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      border-left: 4px solid;
      transition: all 0.3s ease;
    }
    .metric-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    .metric-primary { border-left-color: #3b82f6; }
    .metric-success { border-left-color: #10b981; }
    .metric-warning { border-left-color: #f59e0b; }
    .metric-danger { border-left-color: #ef4444; }

    /* Timeline styles */
    .timeline {
      position: relative;
      padding-left: 30px;
    }
    .timeline::before {
      content: '';
      position: absolute;
      left: 10px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #e5e7eb;
    }
    .timeline-item {
      position: relative;
      padding-bottom: 20px;
    }
    .timeline-item::before {
      content: '';
      position: absolute;
      left: -25px;
      top: 4px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #3b82f6;
      border: 2px solid white;
    }
    .timeline-item.completed::before {
      background: #10b981;
    }
    .timeline-item.current::before {
      background: #f59e0b;
      box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.2);
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="app" class="bank-layout">
    <!-- 左侧导航栏 -->
    <aside class="bank-sidebar">
      <div class="bank-sidebar-header">
        <div class="bank-logo">
          <div class="bank-logo-icon">
            <svg width="24" height="24" fill="white" viewBox="0 0 24 24">
              <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
          </div>
          <div>
            <div class="bank-logo-text">EAST5.0监管报送</div>
            <div class="bank-logo-subtitle">项目评估管理系统</div>
          </div>
        </div>
      </div>

      <nav class="bank-menu">
        <div class="bank-menu-item active" onclick="switchModule('dashboard')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
            </svg>
          </div>
          <div>
            <div>工作台</div>
            <div class="bank-menu-subtitle">Dashboard</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('project')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
            </svg>
          </div>
          <div>
            <div>项目管理</div>
            <div class="bank-menu-subtitle">Project Management</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('sow')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
            </svg>
          </div>
          <div>
            <div>SOW管理</div>
            <div class="bank-menu-subtitle">Statement of Work</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('wbs')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M3,3H11V11H3V3M13,3H21V11H13V3M3,13H11V21H3V13M13,13H21V21H13V13Z"/>
            </svg>
          </div>
          <div>
            <div>WBS分解</div>
            <div class="bank-menu-subtitle">Work Breakdown</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('cost')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"/>
            </svg>
          </div>
          <div>
            <div>成本估算</div>
            <div class="bank-menu-subtitle">Cost Estimation</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('risk')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12,2L13.09,8.26L19,9L13.09,9.74L12,16L10.91,9.74L5,9L10.91,8.26L12,2Z"/>
            </svg>
          </div>
          <div>
            <div>风险评估</div>
            <div class="bank-menu-subtitle">Risk Assessment</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('report')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19M17,17H7V10H17V17Z"/>
            </svg>
          </div>
          <div>
            <div>报告生成</div>
            <div class="bank-menu-subtitle">Report Generation</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('template')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M4,6H2V20A2,2 0 0,0 4,22H18V20H4M6,2V18H20V2H6M8,4H18V16H8V4Z"/>
            </svg>
          </div>
          <div>
            <div>模板管理</div>
            <div class="bank-menu-subtitle">Template Library</div>
          </div>
        </div>

        <div class="bank-menu-item" onclick="switchModule('settings')">
          <div class="bank-menu-icon">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
            </svg>
          </div>
          <div>
            <div>系统设置</div>
            <div class="bank-menu-subtitle">System Settings</div>
          </div>
        </div>
      </nav>
    </aside>

    <!-- 主内容区域 -->
    <main class="bank-main">
      <!-- 顶部标题栏 -->
      <header class="bank-header">
        <div class="bank-header-left">
          <div class="bank-title">
            <svg width="20" height="20" fill="var(--bank-primary)" viewBox="0 0 24 24">
              <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
            </svg>
            <span id="module-title">工作台</span>
          </div>
          <div class="bank-breadcrumb">
            <span id="breadcrumb-path">首页 / 工作台</span>
          </div>
        </div>

        <div class="bank-header-right">
          <div class="bank-user-info">
            <span id="user-name-display">项目经理</span>
            <div class="bank-user-avatar" id="user-avatar-main">PM</div>
          </div>
        </div>
      </header>

      <!-- 内容区域 -->
      <div class="bank-content" id="main-content">
        <!-- 工作台内容 -->
        <div id="dashboard-content" class="module-content">
          <div class="bank-card">
            <div class="bank-card-header">
              <div class="bank-card-title">
                <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                  <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                </svg>
                系统概览
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
              <div class="bank-card" style="background: linear-gradient(135deg, #1e40af 0%, #3730a3 100%); color: white;">
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">12</div>
                <div style="font-size: 14px; opacity: 0.9;">总项目数</div>
                <div style="font-size: 12px; opacity: 0.7; margin-top: 4px;">本月新增 3 个</div>
              </div>

              <div class="bank-card" style="background: linear-gradient(135deg, #059669 0%, #047857 100%); color: white;">
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">8</div>
                <div style="font-size: 14px; opacity: 0.9;">进行中项目</div>
                <div style="font-size: 12px; opacity: 0.7; margin-top: 4px;">按期完成率 85%</div>
              </div>

              <div class="bank-card" style="background: linear-gradient(135deg, #d97706 0%, #b45309 100%); color: white;">
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">¥2,850万</div>
                <div style="font-size: 14px; opacity: 0.9;">项目总价值</div>
                <div style="font-size: 12px; opacity: 0.7; margin-top: 4px;">平均预算 ¥237万</div>
              </div>

              <div class="bank-card" style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white;">
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 8px;">3</div>
                <div style="font-size: 14px; opacity: 0.9;">待审批项目</div>
                <div style="font-size: 12px; opacity: 0.7; margin-top: 4px;">需要您处理</div>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bank-card">
              <div class="bank-card-header">
                <div class="bank-card-title">最近项目</div>
                <button class="bank-btn-primary bank-btn-sm">查看全部</button>
              </div>

              <table class="bank-table">
                <thead>
                  <tr>
                    <th>项目名称</th>
                    <th>状态</th>
                    <th>进度</th>
                    <th>负责人</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>EAST5.0监管报送系统</td>
                    <td><span class="bank-badge bank-badge-success">进行中</span></td>
                    <td>
                      <div class="bank-progress">
                        <div class="bank-progress-bar" style="width: 65%;"></div>
                      </div>
                    </td>
                    <td>张经理</td>
                  </tr>
                  <tr>
                    <td>1104报表系统升级</td>
                    <td><span class="bank-badge bank-badge-warning">待审批</span></td>
                    <td>
                      <div class="bank-progress">
                        <div class="bank-progress-bar" style="width: 30%;"></div>
                      </div>
                    </td>
                    <td>李主管</td>
                  </tr>
                  <tr>
                    <td>客户风险评级系统</td>
                    <td><span class="bank-badge bank-badge-primary">规划中</span></td>
                    <td>
                      <div class="bank-progress">
                        <div class="bank-progress-bar" style="width: 15%;"></div>
                      </div>
                    </td>
                    <td>王总监</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="bank-card">
              <div class="bank-card-header">
                <div class="bank-card-title">系统通知</div>
                <button class="bank-btn-secondary bank-btn-sm">标记已读</button>
              </div>

              <div style="max-height: 300px; overflow-y: auto;">
                <div style="padding: 12px 0; border-bottom: 1px solid var(--bank-border);">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <div style="width: 8px; height: 8px; background: var(--bank-danger); border-radius: 50%;"></div>
                    <span style="font-weight: 500; font-size: 14px;">重要通知</span>
                    <span style="font-size: 12px; color: var(--bank-text-secondary);">2小时前</span>
                  </div>
                  <div style="font-size: 13px; color: var(--bank-text-secondary); line-height: 1.4;">
                    EAST5.0监管报送系统项目需要您审批，请及时处理相关文档。
                  </div>
                </div>

                <div style="padding: 12px 0; border-bottom: 1px solid var(--bank-border);">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <div style="width: 8px; height: 8px; background: var(--bank-warning); border-radius: 50%;"></div>
                    <span style="font-weight: 500; font-size: 14px;">进度提醒</span>
                    <span style="font-size: 12px; color: var(--bank-text-secondary);">5小时前</span>
                  </div>
                  <div style="font-size: 13px; color: var(--bank-text-secondary); line-height: 1.4;">
                    1104报表系统升级项目已完成第一阶段，请查看详细报告。
                  </div>
                </div>

                <div style="padding: 12px 0;">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                    <div style="width: 8px; height: 8px; background: var(--bank-success); border-radius: 50%;"></div>
                    <span style="font-weight: 500; font-size: 14px;">系统消息</span>
                    <span style="font-size: 12px; color: var(--bank-text-secondary);">1天前</span>
                  </div>
                  <div style="font-size: 13px; color: var(--bank-text-secondary); line-height: 1.4;">
                    系统将于本周六凌晨2点进行例行维护，预计持续2小时。
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

                <!-- User Dropdown Menu -->
                <div id="user-menu" class="absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg py-2 z-50 hidden">
                  <div class="px-4 py-3 border-b border-gray-200">
                    <p class="text-sm font-medium text-gray-900" id="menu-user-name">项目经理</p>
                    <p class="text-xs text-gray-500" id="menu-user-email">pm@company.com</p>
                    <p class="text-xs text-blue-600 mt-1" id="menu-user-role">管理员权限</p>
                  </div>

                  <div class="py-2">
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showUserProfile()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                      </svg>
                      个人资料
                    </a>
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showUserSettings()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      </svg>
                      设置
                    </a>
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showUserPermissions()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                      </svg>
                      权限管理
                    </a>
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showTeamManagement()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a4.25 4.25 0 11-8.5 0 4.25 4.25 0 018.5 0z"></path>
                      </svg>
                      团队管理
                    </a>
                  </div>

                  <div class="border-t border-gray-200 py-2">
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showSystemAdmin()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                      </svg>
                      系统管理
                    </a>
                    <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="showHelp()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                      帮助中心
                    </a>
                  </div>

                  <div class="border-t border-gray-200 py-2">
                    <a href="#" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50" onclick="logout()">
                      <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                      </svg>
                      退出登录
                    </a>
                  </div>
                </div>
              </div>

              <!-- Collaboration Status -->
              <div class="flex items-center space-x-2 collaboration-info">
                <div class="flex -space-x-2">
                  <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center border-2 border-white">
                    <span class="text-xs font-bold text-white">PM</span>
                  </div>
                  <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white">
                    <span class="text-xs font-bold text-white">TL</span>
                  </div>
                  <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center border-2 border-white">
                    <span class="text-xs font-bold text-white">QA</span>
                  </div>
                  <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center border-2 border-white">
                    <span class="text-xs font-bold text-white">+2</span>
                  </div>
                </div>
                <div>
                  <p class="text-sm font-medium">5人在线</p>
                  <p class="text-xs opacity-75">协作中</p>
                </div>
              </div>

              <!-- Collaboration Actions -->
              <div class="flex items-center space-x-2 collaboration-buttons">
                <button class="btn btn-ghost text-white border-white/30 hover:bg-white/10 p-2 mobile-tappable" onclick="toggleChat()" data-tooltip="协作聊天">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                  </svg>
                </button>
                <button class="btn btn-ghost text-white border-white/30 hover:bg-white/10 p-2 mobile-tappable" onclick="toggleComments()" data-tooltip="评论">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path>
                  </svg>
                </button>
                <button class="btn btn-ghost text-white border-white/30 hover:bg-white/10 p-2 mobile-tappable" onclick="toggleVersionHistory()" data-tooltip="版本历史">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container-desktop container mx-auto px-6 py-8">
    <div class="grid grid-cols-12 gap-6 main-grid">
      <!-- Sidebar -->
      <aside class="col-span-3 sidebar-col">
        <div class="card p-6 sticky top-6 mobile-hidden">
          <h3 class="text-lg font-semibold mb-4 text-gray-900">项目工作台</h3>

          <!-- Project Actions -->
          <div class="mb-6">
            <button class="btn btn-primary w-full mb-2" onclick="createNewProject()" data-tooltip="创建新项目">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              新建项目
            </button>
            <button class="btn btn-secondary w-full" onclick="showProjectTemplates()" data-tooltip="从模板创建">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
              </svg>
              项目模板
            </button>
          </div>

          <!-- Evaluation Steps -->
          <h4 class="text-sm font-semibold mb-3 text-gray-700">评估步骤</h4>
          <nav class="space-y-2 mb-6">
            <div class="nav-item active" onclick="switchStep('upload')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
              </svg>
              <span>SOW文档上传</span>
            </div>
            <div class="nav-item" onclick="switchStep('analysis')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
              <span>智能解析分析</span>
            </div>
            <div class="nav-item" onclick="switchStep('wbs')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
              </svg>
              <span>WBS分解</span>
            </div>
            <div class="nav-item" onclick="switchStep('estimation')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span>成本估算</span>
            </div>
            <div class="nav-item" onclick="switchStep('risk')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.314 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
              </svg>
              <span>风险评估</span>
            </div>
            <div class="nav-item" onclick="switchStep('report')">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v1a1 1 0 001 1h4a1 1 0 001-1v-1m3-2V8a2 2 0 00-2-2H8a2 2 0 00-2 2v6m3-2h6"></path>
              </svg>
              <span>评估报告</span>
            </div>
          </nav>

          <!-- Project History -->
          <h4 class="text-sm font-semibold mb-3 text-gray-700">最近项目</h4>
          <div class="space-y-2" id="recent-projects">
            <!-- Will be populated by JavaScript -->
          </div>

          <!-- Quick Stats -->
          <div class="mt-6 pt-6 border-t">
            <h4 class="text-sm font-semibold mb-3 text-gray-700">快速统计</h4>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">总项目数</span>
                <span class="font-semibold" id="total-projects">0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">本月分析</span>
                <span class="font-semibold" id="monthly-analysis">0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">节省时间</span>
                <span class="font-semibold text-green-600" id="time-saved">0h</span>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="col-span-9 main-content-col">
        <!-- Step 1: SOW Upload -->
        <section id="upload-step" class="step-content">
          <div class="card p-8 mb-6">
            <div class="text-center mb-8">
              <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
              </div>
              <h2 class="text-3xl font-bold text-gray-900 mb-2">上传SOW文档</h2>
              <p class="text-gray-600">支持Word、PDF、Excel格式，系统将自动解析项目信息</p>
            </div>

            <!-- File Upload Area -->
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center mb-6 hover:border-blue-400 transition-colors cursor-pointer"
                 ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
              <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <p class="text-lg text-gray-900 mb-2">拖拽SOW文档到此处</p>
              <p class="text-sm text-gray-500 mb-4">或者</p>
              <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
                选择文件
              </button>
              <input type="file" id="file-input" class="hidden" accept=".doc,.docx,.pdf,.xls,.xlsx" onchange="handleFileSelect(event)">
            </div>

            <!-- Quick Demo -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-lg font-semibold text-blue-900 mb-2">快速演示</h4>
                  <p class="text-blue-700">使用示例EAST5.0项目SOW文档进行演示</p>
                </div>
                <button class="btn btn-primary" onclick="loadDemoSOW()">
                  加载演示SOW
                </button>
              </div>
            </div>
          </div>

          <!-- Recent Files -->
          <div class="card p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">最近处理的文档</h3>
            <div class="space-y-3">
              <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                <div class="flex items-center space-x-3">
                  <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                  </div>
                  <div>
                    <p class="font-medium text-gray-900">EAST5.0监管报送系统SOW.docx</p>
                    <p class="text-sm text-gray-500">上传于 2小时前 • 2.3MB</p>
                  </div>
                </div>
                <div class="flex items-center space-x-2">
                  <span class="badge badge-success">已解析</span>
                  <button class="text-blue-600 hover:text-blue-800">查看</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 2: Analysis -->
        <section id="analysis-step" class="step-content hidden">
          <div class="card p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">SOW智能解析分析</h2>

            <!-- Analysis Progress -->
            <div class="mb-8">
              <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-medium text-gray-700">解析进度</span>
                <span class="text-sm text-gray-500">85%</span>
              </div>
              <div class="progress">
                <div class="progress-bar" style="width: 85%"></div>
              </div>
            </div>

            <!-- Parsed Information -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">项目基本信息</h3>
                <div class="space-y-3">
                  <div class="flex justify-between">
                    <span class="text-gray-600">项目名称</span>
                    <span class="font-medium">EAST5.0监管数据报送系统</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">客户方</span>
                    <span class="font-medium">XXX银行股份有限公司</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">项目周期</span>
                    <span class="font-medium">7个月（28周）</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">合同金额</span>
                    <span class="font-medium">待估算</span>
                  </div>
                </div>
              </div>

              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">技术复杂度指标</h3>
                <div class="space-y-3">
                  <div class="flex justify-between">
                    <span class="text-gray-600">数据表数量</span>
                    <span class="font-medium text-blue-600">70张</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">上游系统</span>
                    <span class="font-medium text-orange-600">33个</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">元数据表</span>
                    <span class="font-medium text-red-600">15,886张</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">字段映射</span>
                    <span class="font-medium text-purple-600">4,200+</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Enhanced Analytics Dashboard -->
            <div class="mb-8">
              <h3 class="text-lg font-semibold text-gray-900 mb-6">智能分析仪表盘</h3>

              <!-- Key Metrics Overview -->
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="metric-card metric-primary hover-lift" data-count="280">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-3xl font-bold">280万</span>
                    <span class="badge badge-info animate-pulse-slow">预算</span>
                  </div>
                  <p class="text-sm text-gray-600">项目总成本</p>
                  <div class="progress mt-3">
                    <div class="progress-bar" style="width: 75%" data-progress="75%"></div>
                  </div>
                </div>
                <div class="metric-card metric-success hover-lift" data-count="15">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-3xl font-bold">15</span>
                    <span class="badge badge-success">团队</span>
                  </div>
                  <p class="text-sm text-gray-600">项目团队规模</p>
                  <div class="progress mt-3">
                    <div class="progress-bar" style="width: 60%" data-progress="60%"></div>
                  </div>
                </div>
                <div class="metric-card metric-warning hover-lift" data-count="28">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-3xl font-bold">28</span>
                    <span class="badge badge-warning">周</span>
                  </div>
                  <p class="text-sm text-gray-600">项目周期</p>
                  <div class="progress mt-3">
                    <div class="progress-bar" style="width: 30%" data-progress="30%"></div>
                  </div>
                </div>
                <div class="metric-card metric-danger hover-lift" data-count="85">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-3xl font-bold">85%</span>
                    <span class="badge badge-danger">风险</span>
                  </div>
                  <p class="text-sm text-gray-600">综合复杂度</p>
                  <div class="progress mt-3">
                    <div class="progress-bar" style="width: 85%" data-progress="85%"></div>
                  </div>
                </div>
              </div>

              <!-- Advanced Charts Section -->
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Project Timeline Radar Chart -->
                <div class="card p-6 hover-glow">
                  <h4 class="text-lg font-semibold text-gray-900 mb-4">项目维度分析</h4>
                  <canvas id="project-radar-chart" width="400" height="300"></canvas>
                </div>

                <!-- Resource Allocation Chart -->
                <div class="card p-6 hover-glow">
                  <h4 class="text-lg font-semibold text-gray-900 mb-4">资源分配优化</h4>
                  <canvas id="resource-allocation-chart" width="400" height="300"></canvas>
                </div>

                <!-- Complexity Trend Chart -->
                <div class="card p-6 hover-glow">
                  <h4 class="text-lg font-semibold text-gray-900 mb-4">复杂度趋势预测</h4>
                  <canvas id="complexity-trend-chart" width="400" height="300"></canvas>
                </div>

                <!-- Technology Stack Analysis -->
                <div class="card p-6 hover-glow">
                  <h4 class="text-lg font-semibold text-gray-900 mb-4">技术栈分布</h4>
                  <canvas id="tech-stack-chart" width="400" height="300"></canvas>
                </div>
              </div>

              <!-- Key Complexity Factors -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                <div class="metric-card metric-primary hover-scale" data-tooltip="EAST5.0监管要求，70张数据表必须100%覆盖">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-2xl font-bold">70</span>
                    <span class="badge badge-info animate-pulse">高</span>
                  </div>
                  <p class="text-sm text-gray-600">监管数据表</p>
                  <p class="text-xs text-gray-500 mt-1">EAST5.0标准要求</p>
                  <div class="mt-3 text-xs text-blue-600">
                    <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                      <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 1 1 0 000 2H6a2 2 0 100 4h2a2 2 0 100 4h2a1 1 0 100 2 2 2 0 01-2 2H6a2 2 0 01-2-2V5z" clip-rule="evenodd"></path>
                    </svg>
                    点击查看详情
                  </div>
                </div>
                <div class="metric-card metric-warning hover-scale" data-tooltip="33个不同类型系统，涉及多种数据库和接口协议">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-2xl font-bold">33</span>
                    <span class="badge badge-warning animate-pulse">中</span>
                  </div>
                  <p class="text-sm text-gray-600">上游系统接入</p>
                  <p class="text-xs text-gray-500 mt-1">多种数据库类型</p>
                  <div class="mt-3 text-xs text-yellow-600">
                    <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path>
                      <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 1 1 0 000 2H6a2 2 0 100 4h2a2 2 0 100 4h2a1 1 0 100 2 2 2 0 01-2 2H6a2 2 0 01-2-2V5z" clip-rule="evenodd"></path>
                    </svg>
                    系统详情
                  </div>
                </div>
                <div class="metric-card metric-danger hover-scale" data-tooltip="网络安全等级保护三级，需要严格的安全措施和合规检查">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-2xl font-bold">3</span>
                    <span class="badge badge-danger animate-pulse">高</span>
                  </div>
                  <p class="text-sm text-gray-600">等保级别</p>
                  <p class="text-xs text-gray-500 mt-1">三级安全要求</p>
                  <div class="mt-3 text-xs text-red-600">
                    <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                    </svg>
                    安全详情
                  </div>
                </div>
              </div>

              <!-- Risk Heatmap -->
              <div class="card p-6 mb-8">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">风险热力图</h4>
                <div class="grid grid-cols-5 gap-2" id="risk-heatmap">
                  <!-- Will be populated by JavaScript -->
                </div>
              </div>

              <!-- Progress Timeline -->
              <div class="card p-6 mb-8">
                <h4 class="text-lg font-semibold text-gray-900 mb-4">项目进度时间线</h4>
                <div class="relative" id="progress-timeline">
                  <!-- Will be populated by JavaScript -->
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end space-x-4">
              <button class="btn btn-secondary" onclick="switchStep('upload')">重新上传</button>
              <button class="btn btn-primary" onclick="switchStep('wbs')">生成WBS分解</button>
            </div>
          </div>
        </section>

        <!-- Step 3: WBS Breakdown -->
        <section id="wbs-step" class="step-content hidden">
          <div class="card p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">工作分解结构 (WBS)</h2>

            <!-- WBS Overview -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
              <div class="text-center p-4 bg-blue-50 rounded-lg">
                <div class="text-3xl font-bold text-blue-600 mb-2">9</div>
                <p class="text-sm text-gray-600">主要阶段</p>
              </div>
              <div class="text-center p-4 bg-green-50 rounded-lg">
                <div class="text-3xl font-bold text-green-600 mb-2">47</div>
                <p class="text-sm text-gray-600">工作任务</p>
              </div>
              <div class="text-center p-4 bg-orange-50 rounded-lg">
                <div class="text-3xl font-bold text-orange-600 mb-2">28</div>
                <p class="text-sm text-gray-600">项目周数</p>
              </div>
              <div class="text-center p-4 bg-purple-50 rounded-lg">
                <div class="text-3xl font-bold text-purple-600 mb-2">15</div>
                <p class="text-sm text-gray-600">交付物</p>
              </div>
            </div>

            <!-- WBS Structure -->
            <div class="space-y-4">
              <!-- Phase 1 -->
              <div class="border rounded-lg overflow-hidden">
                <div class="bg-gray-50 p-4 cursor-pointer hover:bg-gray-100" onclick="toggleWBSItem('phase1')">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                      <span class="font-semibold">1. 需求&差异分析 (第1-3周)</span>
                    </div>
                    <div class="flex items-center space-x-4">
                      <span class="badge badge-warning">3周</span>
                      <span class="text-sm text-gray-500">2个任务</span>
                    </div>
                  </div>
                </div>
                <div id="phase1" class="hidden p-4 bg-white border-t">
                  <div class="ml-8 space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>1.1 完成70张表差异清单分析</span>
                      <span class="badge badge-info">5人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>1.2 编写需求规格说明书</span>
                      <span class="badge badge-info">8人天</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phase 2 -->
              <div class="border rounded-lg overflow-hidden">
                <div class="bg-gray-50 p-4 cursor-pointer hover:bg-gray-100" onclick="toggleWBSItem('phase2')">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                      <span class="font-semibold">2. 元数据梳理 (第4-5周)</span>
                    </div>
                    <div class="flex items-center space-x-4">
                      <span class="badge badge-warning">2周</span>
                      <span class="text-sm text-gray-500">3个任务</span>
                    </div>
                  </div>
                </div>
                <div id="phase2" class="hidden p-4 bg-white border-t">
                  <div class="ml-8 space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>2.1 Apache Atlas元模型建立</span>
                      <span class="badge badge-info">3人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>2.2 15,886张表自动采集</span>
                      <span class="badge badge-warning">12人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>2.3 血缘解析和报告生成</span>
                      <span class="badge badge-info">5人天</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phase 3 -->
              <div class="border rounded-lg overflow-hidden">
                <div class="bg-gray-50 p-4 cursor-pointer hover:bg-gray-100" onclick="toggleWBSItem('phase3')">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                      <span class="font-semibold">3. 映射&建模 (第6-9周)</span>
                    </div>
                    <div class="flex items-center space-x-4">
                      <span class="badge badge-warning">4周</span>
                      <span class="text-sm text-gray-500">4个任务</span>
                    </div>
                  </div>
                </div>
                <div id="phase3" class="hidden p-4 bg-white border-t">
                  <div class="ml-8 space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>3.1 逻辑模型设计</span>
                      <span class="badge badge-warning">15人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>3.2 物理模型设计</span>
                      <span class="badge badge-warning">12人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>3.3 4,200+字段映射锁定</span>
                      <span class="badge badge-danger">25人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>3.4 映射矩阵文档生成</span>
                      <span class="badge badge-info">8人天</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phase 4 -->
              <div class="border rounded-lg overflow-hidden">
                <div class="bg-gray-50 p-4 cursor-pointer hover:bg-gray-100" onclick="toggleWBSItem('phase4')">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                      <span class="font-semibold">4. ETL开发 (第10-16周)</span>
                    </div>
                    <div class="flex items-center space-x-4">
                      <span class="badge badge-danger">7周</span>
                      <span class="text-sm text-gray-500">8个任务</span>
                    </div>
                  </div>
                </div>
                <div id="phase4" class="hidden p-4 bg-white border-t">
                  <div class="ml-8 space-y-3">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.1 数据采集接口开发</span>
                      <span class="badge badge-danger">35人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.2 数据转换逻辑实现</span>
                      <span class="badge badge-danger">42人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.3 33个系统接口联调</span>
                      <span class="badge badge-danger">28人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.4 错误处理和日志</span>
                      <span class="badge badge-warning">15人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.5 性能优化</span>
                      <span class="badge badge-warning">20人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.6 单元测试</span>
                      <span class="badge badge-info">18人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.7 集成测试</span>
                      <span class="badge badge-info">12人天</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded">
                      <span>4.8 代码审查和优化</span>
                      <span class="badge badge-info">10人天</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- WBS Chart -->
            <div class="mt-8">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">WBS甘特图</h3>
              <div class="bg-gray-50 rounded-lg p-6" style="height: 400px;">
                <canvas id="wbs-gantt-chart"></canvas>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end space-x-4 mt-8">
              <button class="btn btn-secondary" onclick="switchStep('analysis')">返回分析</button>
              <button class="btn btn-primary" onclick="switchStep('estimation')">成本估算</button>
            </div>
          </div>
        </section>

        <!-- Step 4: Cost Estimation -->
        <section id="estimation-step" class="step-content hidden">
          <div class="card p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">项目成本估算</h2>

            <!-- Estimation Summary -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
              <div class="metric-card metric-success">
                <div class="text-3xl font-bold text-green-600 mb-2">¥2,850万</div>
                <p class="text-sm text-gray-600">项目总成本</p>
                <p class="text-xs text-gray-500 mt-1">基于WBS详细估算</p>
              </div>
              <div class="metric-card metric-primary">
                <div class="text-3xl font-bold text-blue-600 mb-2">1,180人天</div>
                <p class="text-sm text-gray-600">总工作量</p>
                <p class="text-xs text-gray-500 mt-1">包含所有阶段</p>
              </div>
              <div class="metric-card metric-warning">
                <div class="text-3xl font-bold text-orange-600 mb-2">42人</div>
                <p class="text-sm text-gray-600">平均团队规模</p>
                <p class="text-xs text-gray-500 mt-1">峰值60人</p>
              </div>
              <div class="metric-card metric-danger">
                <div class="text-3xl font-bold text-red-600 mb-2">¥24,150</div>
                <p class="text-sm text-gray-600">人天成本</p>
                <p class="text-xs text-gray-500 mt-1">高级技术团队</p>
              </div>
            </div>

            <!-- Cost Breakdown -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
              <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-4">成本构成分析</h3>
                <canvas id="cost-breakdown-chart" style="height: 300px;"></canvas>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-4">阶段成本分布</h3>
                <canvas id="phase-cost-chart" style="height: 300px;"></canvas>
              </div>
            </div>

            <!-- Resource Planning -->
            <div class="mb-8">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">资源配置计划</h3>
              <div class="overflow-x-auto">
                <table class="table">
                  <thead>
                    <tr>
                      <th>角色</th>
                      <th>人数</th>
                      <th>参与阶段</th>
                      <th>人天成本</th>
                      <th>总成本</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>项目经理</td>
                      <td>2</td>
                      <td>全程</td>
                      <td>¥35,000</td>
                      <td>¥140万</td>
                    </tr>
                    <tr>
                      <td>架构师</td>
                      <td>2</td>
                      <td>1-4,9-10周</td>
                      <td>¥40,000</td>
                      <td>¥96万</td>
                    </tr>
                    <tr>
                      <td>高级开发工程师</td>
                      <td>8</td>
                      <td>6-18周</td>
                      <td>¥28,000</td>
                      <td>¥896万</td>
                    </tr>
                    <tr>
                      <td>中级开发工程师</td>
                      <td>12</td>
                      <td>6-18周</td>
                      <td>¥22,000</td>
                      <td>¥1,056万</td>
                    </tr>
                    <tr>
                      <td>数据工程师</td>
                      <td>6</td>
                      <td>4-16周</td>
                      <td>¥30,000</td>
                      <td>¥468万</td>
                    </tr>
                    <tr>
                      <td>测试工程师</td>
                      <td>6</td>
                      <td>10-24周</td>
                      <td>¥20,000</td>
                      <td>¥240万</td>
                    </tr>
                    <tr>
                      <td>安全工程师</td>
                      <td>2</td>
                      <td>10-26周</td>
                      <td>¥32,000</td>
                      <td>¥192万</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <!-- Risk Adjustment -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="text-lg font-semibold text-yellow-900 mb-2">风险调整系数</h4>
                  <p class="text-yellow-700">基于项目复杂度和风险评估，已添加15%的风险缓冲</p>
                </div>
                <div class="text-right">
                  <div class="text-2xl font-bold text-yellow-900">¥371万</div>
                  <div class="text-sm text-yellow-700">风险缓冲</div>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end space-x-4">
              <button class="btn btn-secondary" onclick="switchStep('wbs')">调整WBS</button>
              <button class="btn btn-primary" onclick="switchStep('risk')">风险评估</button>
            </div>
          </div>
        </section>

        <!-- Step 5: Risk Assessment -->
        <section id="risk-step" class="step-content hidden">
          <div class="card p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">风险评估分析</h2>

            <!-- Risk Matrix -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
              <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-4">风险矩阵</h3>
                <div class="bg-gray-50 rounded-lg p-6" style="height: 400px;">
                  <canvas id="risk-matrix-chart"></canvas>
                </div>
              </div>
              <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-4">风险分布</h3>
                <canvas id="risk-distribution-chart" style="height: 400px;"></canvas>
              </div>
            </div>

            <!-- Risk List -->
            <div class="mb-8">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">已识别风险项</h3>
              <div class="space-y-4">
                <div class="border rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center space-x-3">
                      <span class="badge badge-danger">高风险</span>
                      <span class="font-semibold">上游系统数据质量风险</span>
                    </div>
                    <span class="text-sm text-gray-500">影响: 高</span>
                  </div>
                  <p class="text-gray-600 mb-2">33个上游系统数据质量参差不齐，可能影响报送准确率。特别是外围Excel/手工台账数据源。</p>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500">概率: 70% | 影响: 严重</span>
                    <div class="flex space-x-2">
                      <button class="text-sm text-blue-600 hover:text-blue-800">制定对策</button>
                      <button class="text-sm text-gray-600 hover:text-gray-800">详情</button>
                    </div>
                  </div>
                </div>

                <div class="border rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center space-x-3">
                      <span class="badge badge-danger">高风险</span>
                      <span class="font-semibold">技术债务风险</span>
                    </div>
                    <span class="text-sm text-gray-500">影响: 高</span>
                  </div>
                  <p class="text-gray-600 mb-2">15,886张元数据表映射复杂，技术债务累积可能影响后续维护。</p>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500">概率: 60% | 影响: 严重</span>
                    <div class="flex space-x-2">
                      <button class="text-sm text-blue-600 hover:text-blue-800">制定对策</button>
                      <button class="text-sm text-gray-600 hover:text-gray-800">详情</button>
                    </div>
                  </div>
                </div>

                <div class="border rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center space-x-3">
                      <span class="badge badge-warning">中风险</span>
                      <span class="font-semibold">等保三级合规风险</span>
                    </div>
                    <span class="text-sm text-gray-500">影响: 中</span>
                  </div>
                  <p class="text-gray-600 mb-2">等保三级测评要求严格，安全整改可能影响项目进度。</p>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500">概率: 50% | 影响: 中等</span>
                    <div class="flex space-x-2">
                      <button class="text-sm text-blue-600 hover:text-blue-800">制定对策</button>
                      <button class="text-sm text-gray-600 hover:text-gray-800">详情</button>
                    </div>
                  </div>
                </div>

                <div class="border rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center space-x-3">
                      <span class="badge badge-warning">中风险</span>
                      <span class="font-semibold">信创环境兼容风险</span>
                    </div>
                    <span class="text-sm text-gray-500">影响: 中</span>
                  </div>
                  <p class="text-gray-600 mb-2">需支持麒麟V10+达梦8+东方通TongWeb7组合，兼容性测试工作量较大。</p>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-500">概率: 40% | 影响: 中等</span>
                    <div class="flex space-x-2">
                      <button class="text-sm text-blue-600 hover:text-blue-800">制定对策</button>
                      <button class="text-sm text-gray-600 hover:text-gray-800">详情</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mitigation Strategies -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
              <h4 class="text-lg font-semibold text-blue-900 mb-4">风险缓解策略</h4>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <h5 class="font-medium text-blue-800 mb-2">技术风险缓解</h5>
                  <ul class="text-sm text-blue-700 space-y-1">
                    <li>• 建立数据质量监控体系</li>
                    <li>• 实施渐进式元数据治理</li>
                    <li>• 提前进行信创环境测试</li>
                    <li>• 建立技术债务管理机制</li>
                  </ul>
                </div>
                <div>
                  <h5 class="font-medium text-blue-800 mb-2">管理风险缓解</h5>
                  <ul class="text-sm text-blue-700 space-y-1">
                    <li>• 增加项目缓冲时间</li>
                    <li>• 建立跨部门协调机制</li>
                    <li>• 定期风险评估会议</li>
                    <li>• 预留应急资源池</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end space-x-4">
              <button class="btn btn-secondary" onclick="switchStep('estimation')">调整估算</button>
              <button class="btn btn-primary" onclick="switchStep('report')">生成报告</button>
            </div>
          </div>
        </section>

        <!-- Step 6: Report -->
        <section id="report-step" class="step-content hidden">
          <div class="card p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">项目评估报告</h2>

            <!-- Report Header -->
            <div class="bg-gradient-primary text-white rounded-lg p-8 mb-8">
              <div class="text-center">
                <h1 class="text-3xl font-bold mb-4">EAST5.0监管数据报送系统项目</h1>
                <h2 class="text-xl mb-2">智能成本评估报告</h2>
                <p class="text-lg opacity-90">基于SOW文档的详细分析与工作量评估</p>
                <div class="mt-6 text-sm opacity-75">
                  报告生成时间：2025年10月13日 08:52
                </div>
              </div>
            </div>

            <!-- Executive Summary -->
            <div class="mb-8">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">执行摘要</h3>
              <div class="bg-gray-50 rounded-lg p-6">
                <p class="text-gray-700 mb-4">
                  基于对EAST5.0监管数据报送系统项目SOW文档的深度分析，本项目涉及70张监管数据表、33个上游系统接入、15,886张元数据表管理。
                  项目整体复杂度为高等级，建议项目周期为28周，总预算为2,850万元，需要配置平均42人的技术团队。
                </p>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
                  <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600">28周</div>
                    <p class="text-sm text-gray-600">建议项目周期</p>
                  </div>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-green-600">1,180人天</div>
                    <p class="text-sm text-gray-600">总工作量</p>
                  </div>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-orange-600">¥2,850万</div>
                    <p class="text-sm text-gray-600">项目总成本</p>
                  </div>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-red-600">中等偏高</div>
                    <p class="text-sm text-gray-600">风险等级</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Key Findings -->
            <div class="mb-8">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">关键发现</h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="border-l-4 border-blue-500 pl-4">
                  <h4 class="font-semibold text-gray-900 mb-2">技术复杂度高</h4>
                  <p class="text-gray-600 text-sm">
                    33个上游系统涉及6种不同数据库类型，15,886张元数据表需要建立血缘关系，技术集成复杂度极高。
                  </p>
                </div>
                <div class="border-l-4 border-orange-500 pl-4">
                  <h4 class="font-semibold text-gray-900 mb-2">数据质量风险</h4>
                  <p class="text-gray-600 text-sm">
                    上游系统数据质量参差不齐，特别是外围Excel/手工台账，需要建立完善的数据质量监控体系。
                  </p>
                </div>
                <div class="border-l-4 border-green-500 pl-4">
                  <h4 class="font-semibold text-gray-900 mb-2">合规要求严格</h4>
                  <p class="text-gray-600 text-sm">
                    等保三级测评要求严格，安全合规成本占总成本的15%，需要专项安全团队支持。
                  </p>
                </div>
                <div class="border-l-4 border-red-500 pl-4">
                  <h4 class="font-semibold text-gray-900 mb-2">工期压力大</h4>
                  <p class="text-gray-600 text-sm">
                    28周的工期相对紧张，特别是ETL开发和测试阶段重叠，需要优化资源配置。
                  </p>
                </div>
              </div>
            </div>

            <!-- Recommendations -->
            <div class="mb-8">
              <h3 class="text-xl font-semibold text-gray-900 mb-4">建议措施</h3>
              <div class="space-y-4">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <h4 class="font-semibold text-blue-900 mb-2">1. 分阶段实施策略</h4>
                  <p class="text-blue-700 text-sm">
                    建议采用分阶段实施策略，优先完成核心数据表的报送功能，后续逐步扩展到全部70张表。
                  </p>
                </div>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <h4 class="font-semibold text-green-900 mb-2">2. 建立数据治理体系</h4>
                  <p class="text-green-700 text-sm">
                    在项目初期建立完善的数据治理体系，包括数据标准、质量监控、血缘管理等。
                  </p>
                </div>
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                  <h4 class="font-semibold text-orange-900 mb-2">3. 增加风险缓冲</h4>
                  <p class="text-orange-700 text-sm">
                    建议在原有预算基础上增加20%的风险缓冲，并预留应急资源池应对突发风险。
                  </p>
                </div>
              </div>
            </div>

            <!-- Export Options -->
            <div class="flex justify-center space-x-4">
              <button class="btn btn-secondary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                导出PDF
              </button>
              <button class="btn btn-secondary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                导出Excel
              </button>
              <button class="btn btn-primary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
                发送邮件
              </button>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <script>
    // Global state
    let currentStep = 'upload';
    let sowData = null;

    // Step switching
    function switchStep(step) {
      // Hide all steps
      document.querySelectorAll('.step-content').forEach(el => {
        el.classList.add('hidden');
      });

      // Show selected step
      document.getElementById(step + '-step').classList.remove('hidden');

      // Update navigation
      document.querySelectorAll('.nav-item').forEach(el => {
        el.classList.remove('active');
      });
      event.currentTarget.classList.add('active');

      currentStep = step;

      // Initialize step-specific content
      if (step === 'wbs') {
        initializeWBSCharts();
      } else if (step === 'estimation') {
        initializeEstimationCharts();
      } else if (step === 'risk') {
        initializeRiskCharts();
      } else if (step === 'analysis') {
        initializeAdvancedAnalyticsCharts();
      }
    }

    // File handling
    function handleDragOver(e) {
      e.preventDefault();
      e.currentTarget.classList.add('border-blue-400', 'bg-blue-50');
    }

    function handleDragLeave(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');
    }

    function handleDrop(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('border-blue-400', 'bg-blue-50');

      const files = e.dataTransfer.files;
      if (files.length > 0) {
        processFile(files[0]);
      }
    }

    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file) {
        processFile(file);
      }
    }

    function processFile(file) {
      // Simulate file processing
      setTimeout(() => {
        sowData = {
          fileName: file.name,
          fileSize: (file.size / 1024 / 1024).toFixed(2) + 'MB',
          uploadTime: new Date().toLocaleString()
        };

        // Auto switch to analysis step
        switchStep('analysis');
      }, 1500);
    }

    function loadDemoSOW() {
      // Load actual SOW content from the uploaded document
      const actualSOWContent = `# **EAST5.0 监管数据报送系统项目工作说明书（SOW）**

**项目全称**：XXX 银行 EAST5.0 监管数据报送系统建设项目
**委托方（甲方）**：XXX 银行股份有限公司
**承建方（乙方）**：XXX 科技有限公司
**生效日期**：2025 年 10 月 13 日
**项目周期**：合同签订之日起至最终验收通过，预计 7 个月（28 周）

## 一、项目目标

1. 建成满足银保监会《银行业金融机构监管数据标准化规范（2021 版）》（EAST5.0）全部 70 张数据表、T+1 频率、数据质量 100% 合规的监管报送系统。
2. 实现上游 33 个业务系统数据自动采集、统一元数据管理、差异分析、质量校验、报表生成、线上报送、历史追溯、权限管控、审计日志、漏洞扫描、等保三级达标。
3. 支持行内特色业务（理财子、信用卡中心、村镇银行、互联网贷款联合贷）个性化扩展及未来 EAST 版本平滑升级。

## 二、监管报送范围（EAST5.0）

### 2.1 数据表清单（70 张，正式报送）

| 主题域 | 数量 | 表名示例（新增/重大变化已标注） |
|--------|------|--------------------------------|
| 机构与员工 | 5 | ORG_INFO、STAFF_INFO、POST_INFO、ORG_RELATION、STAFF_RELATION |
| 客户信息 | 6 | CUST_INFO、INDIV_CUST、CORP_CUST、GROUP_CUST（新增）、CORP_FINANCE（新增）、RELATED_PARTY |
| 存款类 | 4 | DEP_ACCT、DEP_ACCT_DET、CORP_DEP_ACCT、CORP_DEP_DET |
| 信贷类 | 11 | LOAN_IOU、LOAN_CONT、INDIV_LOAN_ACCT、CORP_LOAN_ACCT、ENTRUST_LOAN、SYND_LOAN、PROJ_LOAN、BILL_DISC（新增）、BILL_REDISC（新增）、ADVANCE（新增）、TRUST_PAY（新增） |
| 票据类 | 3 | BILL_ISSUE、ACCEPT_BILL、LG_LC（合并） |
| 信用卡类 | 3 | CC_INFO、CC_TRANS_DET、CC_INSTAL |
| 投资与同业 | 8 | FI_INSTRUMENT、FI_BAL、INTERBANK_TRADE、BOND_INV、STOCK_INV、FUND_INV、WM_INV、DERIV_TRADE（新增） |
| 理财类（报送） | 5 | WM_SALE、WM_RAISE、WM_ASSET、WM_CUSTODY、WM_ACCT_MAP（新增） |
| 担保类 | 2 | GUAR_CONT、GUAR_PARTY（拆分） |
| 代理代销 & 收单 | 3 | AGENCY_TRADE（新增）、INT_LOAN_CONT、INT_LOAN_ADD、INT_COOP、ACQ_MERCHANT（新增） |
| 融资租赁 | 1 | FIN_LEASE（新增） |
| 合计 | 70 | —— |

## 三、上游系统范围

经甲方架构管理办公室（AMO）确认，本项目需接入 **33 个上游系统**：

| 序号 | 系统名称 | 业务域 | 数据库类型 | 元数据表数量 |
|------|----------|--------|------------|-------------|
| 1 | 核心银行系统（CBS） | 存款、贷款、总账 | DB2 | 2,847 |
| 2 | 信用卡系统（CCBS） | 信用卡 | Oracle | 1,326 |
| 3 | 信贷管理系统（CMS） | 对公信贷 | Oracle | 1,190 |
| ... | ... | ... | ... | ... |
| 33 | 外围 Excel/手工台账 | 补充数据 | —— | 47 个文件 |

**汇总**
- 上游系统数量：33 个
- 元数据表数量合计：**15,886 张**

## 四、非功能性需求

| 维度 | 要求 |
|------|------|
| 性能 | 单表 5,000 万条数据，T+1 全量+增量跑批 ≤ 2 h；并发查询 200 用户，95% 响应 ≤ 3 s。 |
| 可用 | 年可用率 ≥ 99.9%，计划外中断 RTO ≤ 30 min，RPO ≤ 5 min。 |
| 容量 | 支持 3 年数据量年复合增长 35%，无需重构分库分表。 |
| 安全 | 通过等保 2.0 三级测评；上线前高危漏洞清零，中危 ≤ 3 个；所有流量 TLS 1.3，数据 AES-256 加密。 |
| 信创 | 支持麒麟 V10 + 达梦 8 + 东方通 TongWeb 7 组合，CPU 支持鲲鹏/飞腾/海光。 |

## 五、项目实施计划（28 周）

| 阶段 | 周 | 里程碑 | 交付物 |
|------|----|--------|--------|
| 1. 需求&差异分析 | 1-3 | 完成 70 张表差异清单 | 《需求规格说明书》《差异分析表》 |
| 2. 元数据梳理 | 4-5 | 15,886 张表采集完成 | 《元数据血缘报告》 |
| 3. 映射&建模 | 6-9 | 4,200+ 字段映射锁定 | 《逻辑模型》《物理模型》《映射矩阵》 |
| 4. ETL 开发 | 10-16 | 33 个系统接口上线 | 代码、脚本、配置、单元测试报告 |
| 5. 校验规则 | 17-18 | 1,300 条规则配置 | 《校验规则库》 |
| 6. UAT & 性能 | 19-22 | 用户验收通过 | 《UAT 报告》《性能测试报告》 |
| 7. 安全&等保 | 23-24 | 等保测评拿到"基本符合" | 《等保测评报告》《漏洞扫描报告》 |
| 8. 试运行驻场 | 25-28 | 连续 4 周无误报 | 《试运行报告》《驻场服务记录》 |
| 9. 最终验收 | 28 周末 | PMO 评审通过 | 《最终验收报告》 |`;

      // 分析SOW内容
      const analysisResult = analyzeSOWContent(actualSOWContent);

      sowData = {
        fileName: 'EAST5.0监管报送系统SOW.docx',
        fileSize: '2.3MB',
        uploadTime: new Date().toLocaleString(),
        analysis: analysisResult
      };

      switchStep('analysis');
    }

    // 高级SOW内容分析功能
    function analyzeSOWContent(content) {
      const analysis = {
        projectInfo: extractProjectInfo(content),
        scope: extractScope(content),
        complexity: calculateComplexity(content),
        timeline: extractTimeline(content),
        risks: assessRisks(content),
        resources: estimateResources(content),
        costs: estimateCosts(content),
        quality: extractQualityRequirements(content),
        stakeholders: extractStakeholders(content)
      };

      return analysis;
    }

    // 提取项目基本信息
    function extractProjectInfo(content) {
      return {
        name: extractValue(content, '项目全称[：:]\\s*([^\n]+)') || 'EAST5.0监管数据报送系统建设项目',
        client: extractValue(content, '委托方[（(]甲方[）)]\\s*[：:]\\s*([^\\n]+)') || 'XXX银行股份有限公司',
        contractor: extractValue(content, '承建方[（(]乙方[）)]\\s*[：:]\\s*([^\\n]+)') || 'XXX科技有限公司',
        duration: extractNumber(content, '预计\\s*(\\d+)\\s*个月[（(](\\d+)\\s*周[）)]') || 28,
        startDate: '2025-10-13',
        endDate: calculateEndDate('2025-10-13', 28)
      };
    }

    // 提取项目范围
    function extractScope(content) {
      return {
        dataTables: extractNumber(content, '(\\d+)\\s*张数据表') || 70,
        upstreamSystems: extractNumber(content, '(\\d+)\\s*个上游系统') || 33,
        metadataTables: extractNumber(content, '([\\d,]+)\\s*张') || 15886,
        businessDomains: extractBusinessDomains(content),
        deliverables: extractDeliverablesList(content)
      };
    }

    // 计算项目复杂度
    function calculateComplexity(content) {
      let score = 0;
      const factors = [];

      // 系统复杂度
      const systems = extractNumber(content, '(\\d+)\\s*个上游系统') || 0;
      if (systems >= 30) {
        score += 25;
        factors.push('上游系统数量多(33个)');
      }

      // 数据复杂度
      const tables = extractNumber(content, '([\\d,]+)\\s*张') || 0;
      if (tables >= 10000) {
        score += 20;
        factors.push('元数据表数量多(15,886张)');
      }

      // 监管要求
      if (content.includes('T+1') && content.includes('100%')) {
        score += 15;
        factors.push('监管要求严格(T+1,100%质量)');
      }

      // 安全要求
      if (content.includes('等保三级')) {
        score += 10;
        factors.push('安全等级高(等保三级)');
      }

      // 信创要求
      if (content.includes('信创')) {
        score += 10;
        factors.push('信创环境适配');
      }

      // 技术栈复杂度
      const techStack = ['DB2', 'Oracle', 'MySQL', 'PostgreSQL', 'Teradata', 'Kafka'];
      const foundTech = techStack.filter(tech => content.includes(tech));
      if (foundTech.length >= 4) {
        score += 10;
        factors.push(`技术栈多样化(${foundTech.length}种)`);
      }

      let level = 'low';
      if (score >= 70) level = 'very-high';
      else if (score >= 50) level = 'high';
      else if (score >= 30) level = 'medium';

      return { score, level, factors };
    }

    // 提取项目时间线
    function extractTimeline(content) {
      const phases = [
        { name: '需求分析', start: 1, end: 3, deliverables: '需求规格说明书' },
        { name: '元数据梳理', start: 4, end: 5, deliverables: '元数据血缘报告' },
        { name: '映射建模', start: 6, end: 9, deliverables: '逻辑模型、物理模型' },
        { name: 'ETL开发', start: 10, end: 16, deliverables: 'ETL代码、接口' },
        { name: '校验规则', start: 17, end: 18, deliverables: '校验规则库' },
        { name: 'UAT测试', start: 19, end: 22, deliverables: 'UAT报告、性能报告' },
        { name: '安全等保', start: 23, end: 24, deliverables: '等保测评报告' },
        { name: '试运行', start: 25, end: 28, deliverables: '试运行报告' }
      ];

      return phases;
    }

    // 评估项目风险
    function assessRisks(content) {
      const risks = [];

      // 技术风险
      if (extractNumber(content, '(\\d+)\\s*个上游系统') >= 30) {
        risks.push({
          type: '技术风险',
          description: '上游系统接口复杂，集成难度大',
          probability: 8,
          impact: 9,
          mitigation: '提前进行接口调研，建立专门的集成团队'
        });
      }

      // 时间风险
      if (content.includes('28周')) {
        risks.push({
          type: '时间风险',
          description: '项目周期紧张，延期风险高',
          probability: 7,
          impact: 8,
          mitigation: '采用敏捷开发，分阶段交付'
        });
      }

      // 质量风险
      if (content.includes('100%')) {
        risks.push({
          type: '质量风险',
          description: '数据质量要求100%，达标难度大',
          probability: 6,
          impact: 9,
          mitigation: '建立完善的数据质量监控体系'
        });
      }

      // 人员风险
      risks.push({
        type: '人员风险',
        description: '关键技术人才流失风险',
        probability: 5,
        impact: 7,
        mitigation: '建立知识库，培养后备人员'
      });

      return risks;
    }

    // 估算资源需求
    function estimateResources(content) {
      const complexity = calculateComplexity(content);
      const baseTeamSize = 8;
      const complexityMultiplier = complexity.score / 50;

      return {
        teamSize: Math.ceil(baseTeamSize * (1 + complexityMultiplier)),
        roles: [
          { title: '项目经理', count: 1, level: 'senior' },
          { title: '架构师', count: 1, level: 'senior' },
          { title: '开发工程师', count: Math.ceil(6 * (1 + complexityMultiplier)), level: 'mixed' },
          { title: '测试工程师', count: Math.ceil(2 * (1 + complexityMultiplier)), level: 'mixed' },
          { title: '运维工程师', count: 1, level: 'senior' }
        ],
        estimatedHours: Math.ceil(28 * 40 * baseTeamSize * (1 + complexityMultiplier))
      };
    }

    // 估算项目成本
    function estimateCosts(content) {
      const resources = estimateResources(content);
      const complexity = calculateComplexity(content);

      const baseCosts = {
        personnel: 20000, // 人月成本
        hardware: 500000,
        software: 300000,
        training: 100000,
        management: 150000,
        contingency: 200000
      };

      const totalPersonnelCost = resources.teamSize * baseCosts.personnel * 7; // 7个月
      const complexityFactor = 1 + (complexity.score / 100);

      return {
        personnel: Math.round(totalPersonnelCost * complexityFactor),
        hardware: baseCosts.hardware,
        software: baseCosts.software,
        training: baseCosts.training,
        management: baseCosts.management,
        contingency: Math.round((totalPersonnelCost + baseCosts.hardware + baseCosts.software) * 0.1),
        total: Math.round((totalPersonnelCost + baseCosts.hardware + baseCosts.software + baseCosts.training + baseCosts.management) * complexityFactor)
      };
    }

    // 提取质量要求
    function extractQualityRequirements(content) {
      return {
        availability: extractValue(content, '年可用率\\s*≥\\s*([^\\s%]+)') || '99.9%',
        responseTime: extractValue(content, '95%\\s*响应\\s*≤\\s*([^\\s]+)') || '3s',
        dataQuality: extractValue(content, '数据质量\\s*([^\\s%]+)') || '100%',
        securityLevel: '等保三级',
        compliance: 'EAST5.0监管要求'
      };
    }

    // 提取项目相关方
    function extractStakeholders(content) {
      return [
        { name: '甲方项目经理', role: '项目监管', importance: 'high' },
        { name: '技术负责人', role: '技术决策', importance: 'high' },
        { name: '业务部门', role: '需求确认', importance: 'medium' },
        { name: '运维团队', role: '系统维护', importance: 'medium' },
        { name: '监管机构', role: '合规检查', importance: 'high' }
      ];
    }

    // 辅助函数
    function extractValue(content, pattern) {
      const match = content.match(new RegExp(pattern));
      return match ? match[1] : null;
    }

    function extractNumber(content, pattern) {
      const match = content.match(new RegExp(pattern));
      return match ? parseInt(match[1]) : 0;
    }

    function extractBusinessDomains(content) {
      const domains = ['机构与员工', '客户信息', '存款类', '信贷类', '票据类', '信用卡类', '投资与同业', '理财类', '担保类', '代理代销', '融资租赁'];
      return domains.filter(domain => content.includes(domain));
    }

    function extractDeliverablesList(content) {
      return [
        '需求规格说明书',
        '元数据血缘报告',
        '逻辑&物理模型文件',
        '映射矩阵',
        'ETL源代码及编译包',
        '校验规则库',
        '单元测试报告',
        '性能测试报告',
        'UAT签字确认单',
        '漏洞扫描报告',
        '等保2.0三级测评报告',
        '用户操作手册',
        '系统运维手册',
        '试运行报告',
        '最终验收报告'
      ];
    }

    function calculateEndDate(startDate, weeks) {
      const date = new Date(startDate);
      date.setDate(date.getDate() + weeks * 7);
      return date.toISOString().split('T')[0];
    }

    function toggleWBSItem(itemId) {
      const element = document.getElementById(itemId);
      const icon = event.currentTarget.querySelector('svg');

      if (element.classList.contains('hidden')) {
        element.classList.remove('hidden');
        icon.style.transform = 'rotate(90deg)';
      } else {
        element.classList.add('hidden');
        icon.style.transform = 'rotate(0deg)';
      }
    }

    // Chart initialization
    function initializeWBSCharts() {
      // 使用实际分析数据初始化WBS图表
      if (!sowData || !sowData.analysis) {
        console.warn('No SOW analysis data available');
        return;
      }

      const timeline = sowData.analysis.timeline;
      const scope = sowData.analysis.scope;
      const resources = sowData.analysis.resources;

      // 增强型甘特图
      const ganttCtx = document.getElementById('wbs-gantt-chart').getContext('2d');
      const ganttData = prepareGanttData(timeline, resources);

      new Chart(ganttCtx, {
        type: 'bar',
        data: {
          labels: ganttData.labels,
          datasets: [
            {
              label: '计划时间',
              data: ganttData.plannedData,
              backgroundColor: ganttData.colors,
              borderColor: ganttData.borderColors,
              borderWidth: 2,
              barPercentage: 0.6
            },
            {
              label: '实际进度',
              data: ganttData.actualData,
              backgroundColor: 'rgba(34, 197, 94, 0.8)',
              borderColor: 'rgba(34, 197, 94, 1)',
              borderWidth: 2,
              barPercentage: 0.4
            },
            {
              label: '关键里程碑',
              data: ganttData.milestones,
              backgroundColor: 'rgba(239, 68, 68, 1)',
              borderColor: 'rgba(239, 68, 68, 1)',
              borderWidth: 2,
              barPercentage: 0.2,
              type: 'scatter'
            }
          ]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              title: {
                display: true,
                text: '项目周数'
              },
              min: 0,
              max: timeline[timeline.length - 1].end + 2,
              ticks: {
                stepSize: 1
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.05)'
              }
            },
            y: {
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              position: 'top',
              labels: {
                usePointStyle: true,
                padding: 15
              }
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const phase = timeline[context.dataIndex];
                  if (context.dataset.label === '关键里程碑') {
                    return `${phase.deliverables} (第${phase.end}周)`;
                  }
                  const status = context.dataset.label === '实际进度' ? getProgressStatus(phase) : '计划';
                  return [
                    `${context.dataset.label}: 第${phase.start}周 - 第${phase.end}周`,
                    `进度: ${getPhaseProgress(phase)}%`,
                    `状态: ${status}`
                  ];
                }
              }
            }
          },
          onClick: (event, elements) => {
            if (elements.length > 0) {
              const index = elements[0].index;
              showPhaseDetails(timeline[index], resources);
            }
          }
        }
      });

      // 项目进度仪表盘
      initializeProgressDashboard(timeline, scope, resources);

      // 启动实时进度监控
      startRealTimeProgressMonitoring(timeline);
    }

    // 准备甘特图数据
    function prepareGanttData(timeline, resources) {
      const currentWeek = getCurrentProjectWeek();
      const colors = [
        '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6',
        '#06b6d4', '#ec4899', '#84cc16', '#6366f1', '#f97316'
      ];

      return {
        labels: timeline.map(phase => phase.name),
        plannedData: timeline.map(phase => [phase.start, phase.end]),
        actualData: timeline.map(phase => {
          if (currentWeek >= phase.end) return [phase.start, phase.end];
          if (currentWeek >= phase.start) return [phase.start, currentWeek];
          return [phase.start, phase.start];
        }),
        milestones: timeline.map(phase => ({
          x: phase.end,
          y: timeline.indexOf(phase)
        })),
        colors: colors.slice(0, timeline.length),
        borderColors: colors.slice(0, timeline.length).map(color => color.replace('0.8', '1'))
      };
    }

    // 获取当前项目周数
    function getCurrentProjectWeek() {
      const startDate = new Date('2025-10-13');
      const currentDate = new Date();
      const weeksElapsed = Math.floor((currentDate - startDate) / (7 * 24 * 60 * 60 * 1000));
      return Math.max(0, Math.min(28, weeksElapsed));
    }

    // 获取阶段进度
    function getPhaseProgress(phase) {
      const currentWeek = getCurrentProjectWeek();
      if (currentWeek <= phase.start) return 0;
      if (currentWeek >= phase.end) return 100;
      return Math.round(((currentWeek - phase.start) / (phase.end - phase.start)) * 100);
    }

    // 获取进度状态
    function getProgressStatus(phase) {
      const progress = getPhaseProgress(phase);
      if (progress === 100) return '已完成';
      if (progress > 0) return '进行中';
      return '未开始';
    }

    // 显示阶段详情
    function showPhaseDetails(phase, resources) {
      const progress = getPhaseProgress(phase);
      const status = getProgressStatus(phase);
      const assignedTeam = getAssignedTeam(phase, resources);

      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
      modal.innerHTML = `
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
          <div class="flex justify-between items-start mb-4">
            <h3 class="text-xl font-bold text-gray-900">${phase.name}</h3>
            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-blue-50 p-4 rounded-lg">
              <p class="text-sm text-blue-600 mb-1">时间范围</p>
              <p class="text-lg font-semibold text-blue-900">第${phase.start}周 - 第${phase.end}周</p>
            </div>
            <div class="bg-green-50 p-4 rounded-lg">
              <p class="text-sm text-green-600 mb-1">当前进度</p>
              <p class="text-lg font-semibold text-green-900">${progress}%</p>
            </div>
            <div class="bg-yellow-50 p-4 rounded-lg">
              <p class="text-sm text-yellow-600 mb-1">状态</p>
              <p class="text-lg font-semibold text-yellow-900">${status}</p>
            </div>
            <div class="bg-purple-50 p-4 rounded-lg">
              <p class="text-sm text-purple-600 mb-1">分配团队</p>
              <p class="text-lg font-semibold text-purple-900">${assignedTeam}人</p>
            </div>
          </div>

          <div class="mb-4">
            <h4 class="font-semibold text-gray-900 mb-2">主要交付物</h4>
            <p class="text-gray-600">${phase.deliverables}</p>
          </div>

          <div class="mb-4">
            <h4 class="font-semibold text-gray-900 mb-2">详细任务</h4>
            <ul class="list-disc list-inside text-gray-600 space-y-1">
              ${generatePhaseTasks(phase).map(task => `<li>${task}</li>`).join('')}
            </ul>
          </div>

          <div class="mb-4">
            <h4 class="font-semibold text-gray-900 mb-2">关键依赖</h4>
            <ul class="list-disc list-inside text-gray-600 space-y-1">
              ${generatePhaseDependencies(phase).map(dep => `<li>${dep}</li>`).join('')}
            </ul>
          </div>

          <div class="flex justify-end">
            <button onclick="this.closest('.fixed').remove()" class="btn btn-secondary">
              关闭
            </button>
          </div>
        </div>
      `;

      document.body.appendChild(modal);
    }

    // 生成阶段任务
    function generatePhaseTasks(phase) {
      const taskMap = {
        '需求分析': ['客户需求调研', '现状分析', '差异分析', '需求规格编写', '需求评审'],
        '元数据梳理': ['元数据调研', '数据模型分析', '血缘关系梳理', '元数据采集', '质量检查'],
        '映射建模': ['数据映射设计', '逻辑模型设计', '物理模型设计', '接口设计', '模型验证'],
        'ETL开发': ['接口开发', 'ETL流程开发', '数据转换规则', '错误处理', '单元测试'],
        '校验规则': ['校验规则设计', '规则配置', '测试数据准备', '规则验证', '性能优化'],
        'UAT测试': ['测试计划制定', '测试用例设计', '执行测试', '缺陷跟踪', '用户验收'],
        '安全等保': ['安全加固', '漏洞扫描', '渗透测试', '等保测评', '问题修复'],
        '试运行': ['系统部署', '试运行监控', '问题处理', '性能调优', '用户培训']
      };

      return taskMap[phase.name] || ['任务分解中...'];
    }

    // 生成阶段依赖
    function generatePhaseDependencies(phase) {
      const dependencies = [];
      const phaseIndex = timeline.indexOf(phase);

      if (phaseIndex > 0) {
        dependencies.push(`完成前序阶段: ${timeline[phaseIndex - 1].name}`);
      }

      if (phase.name.includes('ETL')) {
        dependencies.push('数据接口确认', '硬件环境就绪');
      }

      if (phase.name.includes('测试')) {
        dependencies.push('开发环境稳定', '测试数据准备');
      }

      if (phase.name.includes('安全')) {
        dependencies.push('系统功能完整', '安全策略确认');
      }

      return dependencies.length > 0 ? dependencies : ['暂无特殊依赖'];
    }

    // 获取分配团队
    function getAssignedTeam(phase, resources) {
      const teamAllocation = {
        '需求分析': Math.ceil(resources.teamSize * 0.3),
        '元数据梳理': Math.ceil(resources.teamSize * 0.4),
        '映射建模': Math.ceil(resources.teamSize * 0.5),
        'ETL开发': resources.teamSize,
        '校验规则': Math.ceil(resources.teamSize * 0.4),
        'UAT测试': Math.ceil(resources.teamSize * 0.3),
        '安全等保': Math.ceil(resources.teamSize * 0.2),
        '试运行': Math.ceil(resources.teamSize * 0.3)
      };

      return teamAllocation[phase.name] || Math.ceil(resources.teamSize * 0.4);
    }

    // 初始化进度仪表盘
    function initializeProgressDashboard(timeline, scope, resources) {
      const currentWeek = getCurrentProjectWeek();
      const completedPhases = timeline.filter(phase => currentWeek >= phase.end).length;
      const totalProgress = Math.round((completedPhases / timeline.length) * 100);

      // 更新进度指标
      updateProgressMetrics({
        overallProgress: totalProgress,
        currentWeek: currentWeek,
        completedPhases: completedPhases,
        totalPhases: timeline.length,
        activePhases: timeline.filter(phase => currentWeek >= phase.start && currentWeek < phase.end).length
      });

      // 创建进度热力图
      createProgressHeatmap(timeline, currentWeek);
    }

    // 更新进度指标
    function updateProgressMetrics(metrics) {
      const elements = {
        overallProgress: document.getElementById('overall-progress'),
        currentWeek: document.getElementById('current-week'),
        completedPhases: document.getElementById('completed-phases'),
        activePhases: document.getElementById('active-phases')
      };

      if (elements.overallProgress) {
        elements.overallProgress.textContent = metrics.overallProgress + '%';
        elements.overallProgress.style.width = metrics.overallProgress + '%';
      }
      if (elements.currentWeek) {
        elements.currentWeek.textContent = `第${metrics.currentWeek}周`;
      }
      if (elements.completedPhases) {
        elements.completedPhases.textContent = `${metrics.completedPhases}/${metrics.totalPhases}`;
      }
      if (elements.activePhases) {
        elements.activePhases.textContent = metrics.activePhases;
      }
    }

    // 创建进度热力图
    function createProgressHeatmap(timeline, currentWeek) {
      const heatmapContainer = document.getElementById('progress-heatmap');
      if (!heatmapContainer) return;

      const heatmapData = [];
      for (let week = 1; week <= 28; week++) {
        const activePhases = timeline.filter(phase => week >= phase.start && week <= phase.end);
        const intensity = activePhases.length > 0 ? activePhases.length / 3 : 0;
        const isPast = week <= currentWeek;

        heatmapData.push({
          week: week,
          intensity: intensity,
          isPast: isPast,
          phases: activePhases.map(p => p.name).join(', ')
        });
      }

      heatmapContainer.innerHTML = `
        <div class="grid grid-cols-7 gap-1">
          ${heatmapData.map(data => `
            <div class="aspect-square rounded-sm flex items-center justify-center text-xs font-medium cursor-pointer
              ${data.isPast ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}
              ${data.intensity > 0.6 ? 'ring-2 ring-blue-400' : ''}"
              title="第${data.week}周: ${data.phases || '无任务'}">
              ${data.week}
            </div>
          `).join('')}
        </div>
        <div class="flex items-center justify-between mt-2 text-xs text-gray-600">
          <span>项目进度热力图</span>
          <div class="flex items-center gap-2">
            <div class="w-3 h-3 bg-gray-100 rounded"></div>
            <span>未来</span>
            <div class="w-3 h-3 bg-green-100 rounded"></div>
            <span>已完成</span>
            <div class="w-3 h-3 bg-gray-100 rounded ring-2 ring-blue-400"></div>
            <span>高负荷</span>
          </div>
        </div>
      `;
    }

    // 启动实时进度监控
    function startRealTimeProgressMonitoring(timeline) {
      // 每30秒更新一次进度
      setInterval(() => {
        updateRealTimeProgress(timeline);
      }, 30000);

      // 设置进度变更提醒
      setupProgressAlerts(timeline);
    }

    // 实时进度更新
    function updateRealTimeProgress(timeline) {
      const currentWeek = getCurrentProjectWeek();
      const activePhases = timeline.filter(phase => currentWeek >= phase.start && currentWeek < phase.end);

      if (activePhases.length > 0) {
        console.log('当前活跃阶段:', activePhases.map(p => p.name).join(', '));
        // 这里可以添加更多实时更新逻辑
      }
    }

    // 设置进度提醒
    function setupProgressAlerts(timeline) {
      const currentWeek = getCurrentProjectWeek();
      const upcomingPhases = timeline.filter(phase => phase.start === currentWeek + 1);

      if (upcomingPhases.length > 0) {
        setTimeout(() => {
          showProgressAlert('info', `即将开始: ${upcomingPhases.map(p => p.name).join(', ')}`);
        }, 2000);
      }

      const delayedPhases = timeline.filter(phase =>
        currentWeek > phase.end + 2 && getPhaseProgress(phase) < 100
      );

      if (delayedPhases.length > 0) {
        setTimeout(() => {
          showProgressAlert('warning', `进度延迟: ${delayedPhases.map(p => p.name).join(', ')}`);
        }, 3000);
      }
    }

    // 显示进度提醒
    function showProgressAlert(type, message) {
      const alertDiv = document.createElement('div');
      const colors = {
        info: 'bg-blue-50 border-blue-200 text-blue-800',
        warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',
        success: 'bg-green-50 border-green-200 text-green-800'
      };

      alertDiv.className = `fixed bottom-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm border ${colors[type] || colors.info}`;
      alertDiv.innerHTML = `
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
          </svg>
          <span class="font-medium">进度提醒</span>
        </div>
        <p class="text-sm mt-1 ml-7">${message}</p>
        <button onclick="this.parentElement.parentElement.remove()" class="absolute top-2 right-2">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
      `;

      document.body.appendChild(alertDiv);

      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.parentNode.removeChild(alertDiv);
        }
      }, 6000);
    }

    function initializeEstimationCharts() {
      // 使用实际分析数据初始化成本图表
      if (!sowData || !sowData.analysis) {
        console.warn('No SOW analysis data available');
        return;
      }

      const costs = sowData.analysis.costs;
      const resources = sowData.analysis.resources;
      const timeline = sowData.analysis.timeline;

      // 成本分解饼图
      const costCtx = document.getElementById('cost-breakdown-chart').getContext('2d');
      new Chart(costCtx, {
        type: 'pie',
        data: {
          labels: ['人力成本', '硬件设备', '软件许可', '培训费用', '管理费用', '风险缓冲'],
          datasets: [{
            data: [
              Math.round(costs.personnel / 10000),
              Math.round(costs.hardware / 10000),
              Math.round(costs.software / 10000),
              Math.round(costs.training / 10000),
              Math.round(costs.management / 10000),
              Math.round(costs.contingency / 10000)
            ],
            backgroundColor: [
              '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#6b7280'
            ]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.label + ': ' + context.parsed + '万元';
                }
              }
            }
          }
        }
      });

      // 阶段成本趋势图
      const phaseCtx = document.getElementById('phase-cost-chart').getContext('2d');
      const phaseCosts = calculatePhaseCosts(costs, timeline);

      new Chart(phaseCtx, {
        type: 'line',
        data: {
          labels: timeline.map(phase => phase.name),
          datasets: [{
            label: '累计成本(万元)',
            data: phaseCosts.cumulative,
            borderColor: '#3b82f6',
            backgroundColor: 'rgba(59, 130, 246, 0.1)',
            tension: 0.4,
            fill: true
          }, {
            label: '阶段成本(万元)',
            data: phaseCosts.phase,
            borderColor: '#10b981',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            tension: 0.4,
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: '成本(万元)'
              }
            }
          },
          plugins: {
            tooltip: {
              mode: 'index',
              intersect: false
            }
          }
        }
      });

      // 实时成本监控仪表盘
      initializeCostMonitoring(costs, resources);
    }

    // 计算各阶段成本
    function calculatePhaseCosts(costs, timeline) {
      const totalWeeks = timeline[timeline.length - 1].end;
      const phaseCosts = [];
      let cumulative = 0;

      timeline.forEach((phase, index) => {
        const phaseDuration = phase.end - phase.start + 1;
        const phasePercentage = phaseDuration / totalWeeks;
        const phaseCost = Math.round((costs.personnel + costs.hardware + costs.software) * phasePercentage / 10000);

        cumulative += phaseCost;
        phaseCosts.push(phaseCost);
      });

      return {
        phase: phaseCosts,
        cumulative: phaseCosts.map((cost, index) =>
          phaseCosts.slice(0, index + 1).reduce((sum, c) => sum + c, 0)
        )
      };
    }

    // 初始化实时成本监控
    function initializeCostMonitoring(costs, resources) {
      // 更新页面上的成本指标
      updateCostMetrics(costs, resources);

      // 模拟实时成本更新
      setInterval(() => {
        updateRealTimeCosts(costs);
      }, 5000);
    }

    // 更新成本指标
    function updateCostMetrics(costs, resources) {
      const totalCost = costs.total;
      const budget = totalCost * 1.1; // 预算增加10%缓冲
      const spent = totalCost * 0.3; // 假设已花费30%
      const remaining = budget - spent;

      // 更新DOM元素（如果存在）
      const elements = {
        totalBudget: document.getElementById('total-budget'),
        budgetSpent: document.getElementById('budget-spent'),
        budgetRemaining: document.getElementById('budget-remaining'),
        costEfficiency: document.getElementById('cost-efficiency')
      };

      if (elements.totalBudget) {
        elements.totalBudget.textContent = formatCurrency(budget);
      }
      if (elements.budgetSpent) {
        elements.budgetSpent.textContent = formatCurrency(spent);
        elements.budgetSpent.setAttribute('data-percentage', Math.round((spent / budget) * 100));
      }
      if (elements.budgetRemaining) {
        elements.budgetRemaining.textContent = formatCurrency(remaining);
      }
      if (elements.costEfficiency) {
        const efficiency = Math.round((1 - spent / totalCost) * 100);
        elements.costEfficiency.textContent = efficiency + '%';
      }
    }

    // 实时成本更新
    function updateRealTimeCosts(costs) {
      // 模拟成本变化
      const variance = (Math.random() - 0.5) * 0.02; // ±1%的变化
      const currentSpent = costs.total * 0.3;
      const newSpent = currentSpent * (1 + variance);

      // 更新图表
      const costCtx = document.getElementById('cost-breakdown-chart');
      if (costCtx && costCtx.chart) {
        // 这里可以添加实时更新逻辑
        console.log('实时成本更新:', formatCurrency(newSpent));
      }

      // 检查预算警告
      checkBudgetWarnings(newSpent, costs.total * 1.1);
    }

    // 预算警告检查
    function checkBudgetWarnings(spent, budget) {
      const percentage = (spent / budget) * 100;

      if (percentage >= 90) {
        showBudgetAlert('danger', `预算使用已达${percentage.toFixed(1)}%，即将超支！`);
      } else if (percentage >= 75) {
        showBudgetAlert('warning', `预算使用已达${percentage.toFixed(1)}%，请注意控制成本。`);
      }
    }

    // 显示预算警告
    function showBudgetAlert(type, message) {
      // 创建警告元素
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type} fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm`;
      alertDiv.innerHTML = `
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
          </svg>
          <span>${message}</span>
        </div>
      `;

      document.body.appendChild(alertDiv);

      // 3秒后自动移除
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.parentNode.removeChild(alertDiv);
        }
      }, 3000);
    }

    // 格式化货币
    function formatCurrency(amount) {
      return '¥' + (amount / 10000).toFixed(1) + '万';
    }

    function initializeAdvancedAnalyticsCharts() {
      // 高级分析图表初始化
      if (!sowData || !sowData.analysis) {
        console.warn('No SOW analysis data available');
        return;
      }

      const analysis = sowData.analysis;

      // 项目维度雷达图
      initializeProjectRadarChart(analysis);

      // 资源分配图表
      initializeResourceAllocationChart(analysis);

      // 复杂度趋势图表
      initializeComplexityTrendChart(analysis);

      // 技术栈分析图表
      initializeTechStackChart(analysis);

      // 风险热力图
      initializeRiskHeatmap(analysis);

      // 项目进度时间线
      initializeProgressTimeline(analysis);
    }

    function initializeProjectRadarChart(analysis) {
      const ctx = document.getElementById('project-radar-chart');
      if (!ctx) return;

      new Chart(ctx, {
        type: 'radar',
        data: {
          labels: ['技术复杂度', '时间压力', '资源需求', '风险等级', '质量要求', '合规压力'],
          datasets: [{
            label: '当前项目',
            data: [
              analysis.complexity.score,
              Math.min(100, (28 / analysis.projectInfo.duration) * 100),
              Math.min(100, (analysis.resources.teamSize / 20) * 100),
              Math.min(100, analysis.risks.reduce((sum, risk) => sum + risk.probability * risk.impact, 0) / analysis.risks.length),
              100, // 质量要求固定为100%
              95  // 合规压力很高
            ],
            backgroundColor: 'rgba(59, 130, 246, 0.2)',
            borderColor: 'rgba(59, 130, 246, 1)',
            pointBackgroundColor: 'rgba(59, 130, 246, 1)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(59, 130, 246, 1)'
          }, {
            label: '行业平均',
            data: [60, 70, 65, 50, 80, 75],
            backgroundColor: 'rgba(156, 163, 175, 0.2)',
            borderColor: 'rgba(156, 163, 175, 1)',
            pointBackgroundColor: 'rgba(156, 163, 175, 1)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(156, 163, 175, 1)'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              beginAtZero: true,
              max: 100,
              ticks: {
                stepSize: 20
              }
            }
          },
          plugins: {
            legend: {
              position: 'bottom'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.parsed.r + '%';
                }
              }
            }
          }
        }
      });
    }

    function initializeResourceAllocationChart(analysis) {
      const ctx = document.getElementById('resource-allocation-chart');
      if (!ctx) return;

      const resources = analysis.resources.roles;
      const allocation = resources.map(role => ({
        role: role.title,
        allocated: role.count,
        optimal: role.count + Math.ceil(Math.random() * 3) - 1
      }));

      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: allocation.map(item => item.role),
          datasets: [{
            label: '当前分配',
            data: allocation.map(item => item.allocated),
            backgroundColor: 'rgba(59, 130, 246, 0.8)',
            borderColor: 'rgba(59, 130, 246, 1)',
            borderWidth: 2
          }, {
            label: '建议分配',
            data: allocation.map(item => item.optimal),
            backgroundColor: 'rgba(16, 185, 129, 0.8)',
            borderColor: 'rgba(16, 185, 129, 1)',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: '人员数量'
              }
            }
          },
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }

    function initializeComplexityTrendChart(analysis) {
      const ctx = document.getElementById('complexity-trend-chart');
      if (!ctx) return;

      // 生成未来12个月的复杂度预测数据
      const months = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
      const currentComplexity = analysis.complexity.score;

      // 模拟复杂度变化趋势
      const complexityTrend = months.map((_, index) => {
        const baseComplexity = currentComplexity;
        const variance = Math.sin(index * 0.5) * 10;
        const growth = index * 0.5;
        return Math.max(0, Math.min(100, baseComplexity + variance + growth));
      });

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: months,
          datasets: [{
            label: '复杂度预测',
            data: complexityTrend,
            borderColor: 'rgba(239, 68, 68, 1)',
            backgroundColor: 'rgba(239, 68, 68, 0.1)',
            tension: 0.4,
            fill: true
          }, {
            label: '当前复杂度',
            data: months.map(() => currentComplexity),
            borderColor: 'rgba(156, 163, 175, 0.5)',
            borderDash: [5, 5],
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              title: {
                display: true,
                text: '复杂度指数'
              }
            }
          },
          plugins: {
            legend: {
              position: 'bottom'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + Math.round(context.parsed.y);
                }
              }
            }
          }
        }
      });
    }

    function initializeTechStackChart(analysis) {
      const ctx = document.getElementById('tech-stack-chart');
      if (!ctx) return;

      // 技术栈分布数据
      const techStack = {
        'DB2': 25,
        'Oracle': 20,
        'MySQL': 15,
        'PostgreSQL': 10,
        'Kafka': 12,
        'Apache Atlas': 8,
        '信创组件': 10
      };

      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: Object.keys(techStack),
          datasets: [{
            data: Object.values(techStack),
            backgroundColor: [
              '#3b82f6', '#10b981', '#f59e0b', '#ef4444',
              '#8b5cf6', '#06b6d4', '#ec4899'
            ],
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.label + ': ' + context.parsed + '%';
                }
              }
            }
          }
        }
      });
    }

    function initializeRiskHeatmap(analysis) {
      const heatmapContainer = document.getElementById('risk-heatmap');
      if (!heatmapContainer) return;

      // 生成风险矩阵数据
      const riskMatrix = [
        { phase: '需求分析', technical: 3, schedule: 4, resource: 2, quality: 3, external: 2 },
        { phase: '元数据梳理', technical: 4, schedule: 3, resource: 3, quality: 2, external: 2 },
        { phase: '映射建模', technical: 5, schedule: 4, resource: 3, quality: 4, external: 3 },
        { phase: 'ETL开发', technical: 8, schedule: 7, resource: 6, quality: 5, external: 4 },
        { phase: '校验规则', technical: 5, schedule: 4, resource: 4, quality: 6, external: 3 },
        { phase: 'UAT测试', technical: 6, schedule: 7, resource: 5, quality: 4, external: 2 },
        { phase: '安全等保', technical: 7, schedule: 5, resource: 4, quality: 3, external: 5 },
        { phase: '试运行', technical: 4, schedule: 3, resource: 3, quality: 3, external: 2 }
      ];

      const riskTypes = ['technical', 'schedule', 'resource', 'quality', 'external'];
      const riskTypeNames = ['技术', '进度', '资源', '质量', '外部'];

      let html = '<div class="grid grid-cols-6 gap-1 text-xs">';
      html += '<div></div>';
      riskTypeNames.forEach(type => {
        html += `<div class="text-center font-semibold">${type}</div>`;
      });

      riskMatrix.forEach(phase => {
        html += `<div class="text-right pr-2 font-semibold">${phase.phase}</div>`;
        riskTypes.forEach(type => {
          const level = phase[type];
          const color = level <= 3 ? 'bg-green-500' : level <= 6 ? 'bg-yellow-500' : 'bg-red-500';
          const opacity = level / 10;
          html += `<div class="${color} rounded h-8 flex items-center justify-center text-white font-medium"
                       style="opacity: ${opacity}" data-tooltip="${phase.phase} - ${riskTypeNames[riskTypes.indexOf(type)]}: ${level}/10">
                      ${level}
                    </div>`;
        });
      });
      html += '</div>';

      heatmapContainer.innerHTML = html;
    }

    function initializeProgressTimeline(analysis) {
      const timelineContainer = document.getElementById('progress-timeline');
      if (!timelineContainer) return;

      const timeline = analysis.timeline;
      const currentWeek = getCurrentProjectWeek();

      let html = '<div class="relative">';
      html += '<div class="absolute left-0 right-0 top-1/2 h-1 bg-gray-300 -translate-y-1/2"></div>';

      timeline.forEach((phase, index) => {
        const isCompleted = currentWeek >= phase.end;
        const isCurrent = currentWeek >= phase.start && currentWeek < phase.end;
        const leftPercent = (phase.start / timeline[timeline.length - 1].end) * 100;

        html += `
          <div class="absolute transform -translate-x-1/2 -translate-y-1/2" style="left: ${leftPercent}%">
            <div class="relative">
              <div class="w-6 h-6 rounded-full border-4 ${isCompleted ? 'bg-green-500 border-green-600' : isCurrent ? 'bg-blue-500 border-blue-600 animate-pulse' : 'bg-gray-300 border-gray-400'}"></div>
              <div class="absolute top-8 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
                <div class="text-xs font-semibold ${isCompleted ? 'text-green-600' : isCurrent ? 'text-blue-600' : 'text-gray-500'}">${phase.name}</div>
                <div class="text-xs text-gray-500">第${phase.start}-${phase.end}周</div>
              </div>
            </div>
          </div>
        `;
      });

      html += '</div>';
      timelineContainer.innerHTML = html;
    }

    function initializeRiskCharts() {
      // 使用实际分析数据初始化风险图表
      if (!sowData || !sowData.analysis) {
        console.warn('No SOW analysis data available');
        return;
      }

      const risks = sowData.analysis.risks;
      const complexity = sowData.analysis.complexity;

      // 智能风险矩阵图表
      const matrixCtx = document.getElementById('risk-matrix-chart').getContext('2d');
      const riskMatrixData = prepareRiskMatrixData(risks);

      new Chart(matrixCtx, {
        type: 'bubble',
        data: {
          datasets: riskMatrixData
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              title: {
                display: true,
                text: '影响程度 (1-10)'
              },
              min: 0,
              max: 10,
              ticks: {
                stepSize: 1
              }
            },
            y: {
              title: {
                display: true,
                text: '发生概率 (1-10)'
              },
              min: 0,
              max: 10,
              ticks: {
                stepSize: 1
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  const risk = risks[context.dataIndex];
                  return [
                    context.dataset.label,
                    `风险: ${risk.description}`,
                    `概率: ${risk.probability}/10`,
                    `影响: ${risk.impact}/10`,
                    `缓解措施: ${risk.mitigation}`
                  ];
                }
              }
            },
            legend: {
              display: true,
              position: 'bottom'
            }
          }
        }
      });

      // 风险分布图表
      const distributionCtx = document.getElementById('risk-distribution-chart').getContext('2d');
      const riskDistribution = calculateRiskDistribution(risks);

      new Chart(distributionCtx, {
        type: 'doughnut',
        data: {
          labels: Object.keys(riskDistribution),
          datasets: [{
            data: Object.values(riskDistribution),
            backgroundColor: [
              '#ef4444', // 技术风险 - 红色
              '#f59e0b', // 时间风险 - 橙色
              '#3b82f6', // 质量风险 - 蓝色
              '#10b981', // 人员风险 - 绿色
              '#8b5cf6', // 外部风险 - 紫色
              '#6b7280'  // 其他风险 - 灰色
            ]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom'
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((context.parsed / total) * 100).toFixed(1);
                  return context.label + ': ' + context.parsed + '个 (' + percentage + '%)';
                }
              }
            }
          }
        }
      });

      // 初始化智能风险监控
      initializeIntelligentRiskMonitoring(risks, complexity);
    }

    // 准备风险矩阵数据
    function prepareRiskMatrixData(risks) {
      const riskLevels = {
        high: { label: '高风险', color: 'rgba(239, 68, 68, 0.7)', risks: [] },
        medium: { label: '中风险', color: 'rgba(245, 158, 11, 0.7)', risks: [] },
        low: { label: '低风险', color: 'rgba(34, 197, 94, 0.7)', risks: [] }
      };

      risks.forEach(risk => {
        const riskScore = risk.probability * risk.impact;
        const riskLevel = riskScore >= 50 ? 'high' : riskScore >= 25 ? 'medium' : 'low';

        riskLevels[riskLevel].risks.push({
          x: risk.impact,
          y: risk.probability,
          r: Math.min(Math.max(riskScore / 5, 8), 25), // 气泡大小
          description: risk.description
        });
      });

      return Object.entries(riskLevels).map(([level, data]) => ({
        label: data.label,
        data: data.risks,
        backgroundColor: data.color,
        borderColor: data.color.replace('0.7', '1'),
        borderWidth: 1
      }));
    }

    // 计算风险分布
    function calculateRiskDistribution(risks) {
      const distribution = {};

      risks.forEach(risk => {
        if (!distribution[risk.type]) {
          distribution[risk.type] = 0;
        }
        distribution[risk.type]++;
      });

      // 按风险数量排序
      const sorted = Object.entries(distribution)
        .sort((a, b) => b[1] - a[1])
        .reduce((acc, [key, value]) => {
          acc[key] = value;
          return acc;
        }, {});

      return sorted;
    }

    // 初始化智能风险监控
    function initializeIntelligentRiskMonitoring(risks, complexity) {
      // 生成详细的风险报告
      generateDetailedRiskReport(risks, complexity);

      // 设置风险监控定时器
      setInterval(() => {
        performIntelligentRiskAssessment(risks);
      }, 10000);

      // 初始化风险预警系统
      initializeRiskAlertSystem(risks);
    }

    // 生成详细风险报告
    function generateDetailedRiskReport(risks, complexity) {
      const riskReport = {
        summary: {
          totalRisks: risks.length,
          highRiskCount: risks.filter(r => r.probability * r.impact >= 50).length,
          mediumRiskCount: risks.filter(r => r.probability * r.impact >= 25 && r.probability * r.impact < 50).length,
          lowRiskCount: risks.filter(r => r.probability * r.impact < 25).length,
          overallRiskLevel: calculateOverallRiskLevel(risks)
        },
        topRisks: risks.sort((a, b) => (b.probability * b.impact) - (a.probability * a.impact)).slice(0, 5),
        mitigationActions: generateMitigationActions(risks),
        riskTrends: predictRiskTrends(risks)
      };

      // 更新风险指标显示
      updateRiskMetrics(riskReport);
    }

    // 计算整体风险等级
    function calculateOverallRiskLevel(risks) {
      const totalRiskScore = risks.reduce((sum, risk) => sum + (risk.probability * risk.impact), 0);
      const averageRiskScore = totalRiskScore / risks.length;

      if (averageRiskScore >= 60) return '高风险';
      if (averageRiskScore >= 35) return '中等风险';
      return '低风险';
    }

    // 生成缓解措施
    function generateMitigationActions(risks) {
      return risks.map(risk => ({
        risk: risk.description,
        action: risk.mitigation,
        priority: risk.probability * risk.impact >= 50 ? '高' : risk.probability * risk.impact >= 25 ? '中' : '低',
        owner: assignRiskOwner(risk),
        dueDate: calculateRiskDueDate(risk)
      }));
    }

    // 分配风险负责人
    function assignRiskOwner(risk) {
      const owners = {
        '技术风险': '技术架构师',
        '时间风险': '项目经理',
        '质量风险': '质量保证经理',
        '人员风险': '人力资源经理',
        '业务风险': '业务分析师'
      };
      return owners[risk.type] || '项目经理';
    }

    // 计算风险截止日期
    function calculateRiskDueDate(risk) {
      const urgency = risk.probability * risk.impact;
      const daysFromNow = urgency >= 60 ? 7 : urgency >= 35 ? 14 : 30;
      const dueDate = new Date();
      dueDate.setDate(dueDate.getDate() + daysFromNow);
      return dueDate.toISOString().split('T')[0];
    }

    // 预测风险趋势
    function predictRiskTrends(risks) {
      return risks.map(risk => ({
        risk: risk.description,
        currentLevel: risk.probability * risk.impact,
        predictedTrend: calculateRiskTrend(risk),
        confidence: Math.round(Math.random() * 30 + 60) // 60-90%的置信度
      }));
    }

    // 计算单个风险趋势
    function calculateRiskTrend(risk) {
      const random = Math.random();
      if (random > 0.7) return '上升';
      if (random > 0.3) return '稳定';
      return '下降';
    }

    // 更新风险指标
    function updateRiskMetrics(riskReport) {
      // 更新页面上的风险指标（如果存在）
      const elements = {
        totalRisks: document.getElementById('total-risks'),
        highRisks: document.getElementById('high-risks'),
        overallRiskLevel: document.getElementById('overall-risk-level')
      };

      if (elements.totalRisks) {
        elements.totalRisks.textContent = riskReport.summary.totalRisks;
      }
      if (elements.highRisks) {
        elements.highRisks.textContent = riskReport.summary.highRiskCount;
      }
      if (elements.overallRiskLevel) {
        elements.overallRiskLevel.textContent = riskReport.summary.overallRiskLevel;
        elements.overallRiskLevel.className = getRiskLevelClass(riskReport.summary.overallRiskLevel);
      }
    }

    // 获取风险等级样式类
    function getRiskLevelClass(level) {
      const classes = {
        '高风险': 'text-red-600 font-bold',
        '中等风险': 'text-yellow-600 font-semibold',
        '低风险': 'text-green-600'
      };
      return classes[level] || 'text-gray-600';
    }

    // 智能风险评估
    function performIntelligentRiskAssessment(risks) {
      // 模拟动态风险评估
      risks.forEach(risk => {
        const variance = (Math.random() - 0.5) * 2; // ±1的变化
        risk.probability = Math.max(1, Math.min(10, risk.probability + variance));
        risk.impact = Math.max(1, Math.min(10, risk.impact + variance * 0.5));
      });

      // 检查是否有新的高风险
      const newHighRisks = risks.filter(r => r.probability * r.impact >= 50);
      if (newHighRisks.length > 0) {
        showRiskAlert('warning', '检测到新的高风险项，请及时关注！');
      }
    }

    // 初始化风险预警系统
    function initializeRiskAlertSystem(risks) {
      // 设置风险阈值监控
      risks.forEach(risk => {
        const threshold = risk.probability * risk.impact;
        if (threshold >= 60) {
          showRiskAlert('danger', `严重风险: ${risk.description}`);
        }
      });
    }

    // 显示风险警告
    function showRiskAlert(type, message) {
      const alertDiv = document.createElement('div');
      const icons = {
        warning: '<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>',
        danger: '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>'
      };

      const colors = {
        warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',
        danger: 'bg-red-50 border-red-200 text-red-800'
      };

      alertDiv.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm border ${colors[type] || colors.warning}`;
      alertDiv.innerHTML = `
        <div class="flex items-start">
          <svg class="w-5 h-5 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            ${icons[type] || icons.warning]}
          </svg>
          <div>
            <p class="font-medium">${type === 'danger' ? '严重风险' : '风险警告'}</p>
            <p class="text-sm mt-1">${message}</p>
          </div>
          <button onclick="this.parentElement.parentElement.remove()" class="ml-2">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </button>
        </div>
      `;

      document.body.appendChild(alertDiv);

      // 自动移除警告
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.parentNode.removeChild(alertDiv);
        }
      }, 8000);
    }

    // 企业级报表生成功能
    function generateComprehensiveReport() {
      if (!sowData || !sowData.analysis) {
        showReportAlert('warning', '请先上传并分析SOW文档');
        return;
      }

      const reportData = prepareReportData(sowData.analysis);
      const reportTemplate = createReportTemplate(reportData);

      // 生成并下载报告
      downloadReport(reportTemplate, 'EAST5.0项目评估报告');
    }

    // 准备报告数据
    function prepareReportData(analysis) {
      const currentDate = new Date().toLocaleDateString('zh-CN');
      const currentWeek = getCurrentProjectWeek();

      return {
        metadata: {
          reportTitle: 'EAST5.0监管数据报送系统建设项目评估报告',
          generatedDate: currentDate,
          projectDuration: `${analysis.projectInfo.duration}周`,
          preparationBy: 'EAST5.0项目智能评估系统'
        },
        executiveSummary: {
          projectOverview: analysis.projectInfo,
          keyMetrics: {
            totalCost: formatCurrency(analysis.costs.total),
            teamSize: analysis.resources.teamSize + '人',
            complexity: analysis.complexity.level,
            riskLevel: calculateOverallRiskLevel(analysis.risks),
            currentProgress: Math.round((currentWeek / analysis.projectInfo.duration) * 100) + '%'
          },
          recommendations: generateRecommendations(analysis)
        },
        detailedAnalysis: {
          scopeAnalysis: analysis.scope,
          timelineAnalysis: analysis.timeline,
          resourceAnalysis: analysis.resources,
          costAnalysis: analysis.costs,
          riskAnalysis: analysis.risks,
          qualityRequirements: analysis.quality
        },
        appendix: {
          stakeholderAnalysis: analysis.stakeholders,
          assumptions: generateProjectAssumptions(),
          limitations: generateProjectLimitations()
        }
      };
    }

    // 生成建议
    function generateRecommendations(analysis) {
      const recommendations = [];

      if (analysis.complexity.score >= 70) {
        recommendations.push({
          priority: '高',
          category: '项目管理',
          recommendation: '建议增加项目管理资源，建立专门的风险管理团队',
          rationale: '项目复杂度很高，需要额外的管理和协调资源'
        });
      }

      if (analysis.risks.some(r => r.probability * r.impact >= 50)) {
        recommendations.push({
          priority: '高',
          category: '风险管理',
          recommendation: '制定详细的风险缓解计划，建立风险监控机制',
          rationale: '识别到高风险项，需要主动的风险管理措施'
        });
      }

      if (analysis.costs.total > 3000000) {
        recommendations.push({
          priority: '中',
          category: '成本控制',
          recommendation: '建立成本监控机制，定期进行成本审查',
          rationale: '项目投资较大，需要严格的成本控制'
        });
      }

      recommendations.push({
        priority: '中',
        category: '质量保证',
        recommendation: '建立完善的质量保证体系，确保数据质量100%合规',
        rationale: '监管报送项目对数据质量要求极高'
      });

      return recommendations;
    }

    // 创建报告模板
    function createReportTemplate(reportData) {
      return `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${reportData.metadata.reportTitle}</title>
    <style>
        ${generateReportStyles()}
    </style>
</head>
<body>
    <div class="report-container">
        <!-- 封面页 -->
        <div class="cover-page">
            <h1>${reportData.metadata.reportTitle}</h1>
            <div class="subtitle">智能分析与评估报告</div>
            <div class="report-meta">
                <p>生成日期: ${reportData.metadata.generatedDate}</p>
                <p>项目周期: ${reportData.metadata.projectDuration}</p>
                <p>生成工具: ${reportData.metadata.preparationBy}</p>
            </div>
        </div>

        <!-- 执行摘要 -->
        <div class="page-break">
            <h2>执行摘要</h2>
            ${generateExecutiveSummary(reportData.executiveSummary)}
        </div>

        <!-- 详细分析 -->
        <div class="page-break">
            <h2>详细分析</h2>
            ${generateDetailedAnalysis(reportData.detailedAnalysis)}
        </div>

        <!-- 建议和结论 -->
        <div class="page-break">
            <h2>建议与结论</h2>
            ${generateRecommendationsSection(reportData.executiveSummary.recommendations)}
        </div>

        <!-- 附录 -->
        <div class="page-break">
            <h2>附录</h2>
            ${generateAppendix(reportData.appendix)}
        </div>
    </div>
</body>
</html>`;
    }

    // 生成报告样式
    function generateReportStyles() {
      return `
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background: white;
        }
        .report-container {
            max-width: 210mm;
            margin: 0 auto;
            padding: 20mm;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .cover-page {
            text-align: center;
            padding: 60mm 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: -20mm -20mm 40px -20mm;
        }
        .cover-page h1 {
            font-size: 32pt;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .subtitle {
            font-size: 18pt;
            margin-bottom: 40px;
            opacity: 0.9;
        }
        .report-meta p {
            font-size: 12pt;
            margin: 8px 0;
            opacity: 0.8;
        }
        h2 {
            font-size: 20pt;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 8px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        h3 {
            font-size: 16pt;
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .metric-label {
            font-size: 12pt;
            color: #7f8c8d;
            margin-bottom: 8px;
        }
        .metric-value {
            font-size: 18pt;
            font-weight: bold;
            color: #2c3e50;
        }
        .recommendation {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        .recommendation.high {
            border-left: 4px solid #e74c3c;
            background: #fdf2f2;
        }
        .recommendation.medium {
            border-left: 4px solid #f39c12;
            background: #fef9e7;
        }
        .page-break {
            page-break-before: always;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .risk-high { color: #e74c3c; font-weight: bold; }
        .risk-medium { color: #f39c12; font-weight: bold; }
        .risk-low { color: #27ae60; font-weight: bold; }
        @media print {
            .page-break { page-break-before: always; }
            .report-container { box-shadow: none; }
        }
      `;
    }

    // 生成执行摘要
    function generateExecutiveSummary(summary) {
      return `
        <div class="project-overview">
            <h3>项目概览</h3>
            <p><strong>项目名称:</strong> ${summary.projectOverview.name}</p>
            <p><strong>客户:</strong> ${summary.projectOverview.client}</p>
            <p><strong>承包商:</strong> ${summary.projectOverview.contractor}</p>
            <p><strong>项目周期:</strong> ${summary.projectOverview.duration}周</p>
            <p><strong>开始日期:</strong> ${summary.projectOverview.startDate}</p>
            <p><strong>预计完成:</strong> ${summary.projectOverview.endDate}</p>
        </div>

        <h3>关键指标</h3>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">项目总成本</div>
                <div class="metric-value">${summary.keyMetrics.totalCost}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">团队规模</div>
                <div class="metric-value">${summary.keyMetrics.teamSize}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">复杂度等级</div>
                <div class="metric-value">${summary.keyMetrics.complexity}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">风险等级</div>
                <div class="metric-value">${summary.keyMetrics.riskLevel}</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">当前进度</div>
                <div class="metric-value">${summary.keyMetrics.currentProgress}</div>
            </div>
        </div>
      `;
    }

    // 生成详细分析
    function generateDetailedAnalysis(analysis) {
      return `
        <h3>项目范围分析</h3>
        <table>
            <tr><th>项目</th><th>数量</th></tr>
            <tr><td>数据表</td><td>${analysis.scope.dataTables}张</td></tr>
            <tr><td>上游系统</td><td>${analysis.scope.upstreamSystems}个</td></tr>
            <tr><td>元数据表</td><td>${analysis.scope.metadataTables.toLocaleString()}张</td></tr>
            <tr><td>业务域</td><td>${analysis.scope.businessDomains.length}个</td></tr>
        </table>

        <h3>资源需求分析</h3>
        <table>
            <tr><th>角色</th><th>人数</th><th>级别</th></tr>
            ${analysis.resources.roles.map(role =>
              `<tr><td>${role.title}</td><td>${role.count}</td><td>${role.level}</td></tr>`
            ).join('')}
        </table>

        <h3>成本分析</h3>
        <table>
            <tr><th>成本类别</th><th>金额(万元)</th></tr>
            <tr><td>人力成本</td><td>${Math.round(analysis.costAnalysis.personnel / 10000)}</td></tr>
            <tr><td>硬件设备</td><td>${Math.round(analysis.costAnalysis.hardware / 10000)}</td></tr>
            <tr><td>软件许可</td><td>${Math.round(analysis.costAnalysis.software / 10000)}</td></tr>
            <tr><td>培训费用</td><td>${Math.round(analysis.costAnalysis.training / 10000)}</td></tr>
            <tr><td>管理费用</td><td>${Math.round(analysis.costAnalysis.management / 10000)}</td></tr>
            <tr><td>风险缓冲</td><td>${Math.round(analysis.costAnalysis.contingency / 10000)}</td></tr>
            <tr><th>总计</th><th>${Math.round(analysis.costAnalysis.total / 10000)}</th></tr>
        </table>

        <h3>风险评估</h3>
        <table>
            <tr><th>风险类型</th><th>描述</th><th>概率</th><th>影响</th><th>风险等级</th></tr>
            ${analysis.riskAnalysis.map(risk => {
              const riskScore = risk.probability * risk.impact;
              const riskLevel = riskScore >= 50 ? 'high' : riskScore >= 25 ? 'medium' : 'low';
              const riskClass = riskLevel === 'high' ? 'risk-high' : riskLevel === 'medium' ? 'risk-medium' : 'risk-low';
              return `<tr>
                <td>${risk.type}</td>
                <td>${risk.description}</td>
                <td>${risk.probability}/10</td>
                <td>${risk.impact}/10</td>
                <td class="${riskClass}">${riskLevel.toUpperCase()}</td>
              </tr>`;
            }).join('')}
        </table>
      `;
    }

    // 生成建议部分
    function generateRecommendationsSection(recommendations) {
      return `
        ${recommendations.map(rec => `
          <div class="recommendation ${rec.priority.toLowerCase()}">
            <h4>${rec.category} - ${rec.priority}优先级</h4>
            <p><strong>建议:</strong> ${rec.recommendation}</p>
            <p><strong>理由:</strong> ${rec.rationale}</p>
          </div>
        `).join('')}
      `;
    }

    // 生成附录
    function generateAppendix(appendix) {
      return `
        <h3>项目相关方</h3>
        <table>
            <tr><th>姓名/角色</th><th>职责</th><th>重要性</th></tr>
            ${appendix.stakeholderAnalysis.map(stakeholder =>
              `<tr><td>${stakeholder.name}</td><td>${stakeholder.role}</td><td>${stakeholder.importance}</td></tr>`
            ).join('')}
        </table>

        <h3>项目假设</h3>
        <ul>
            ${appendix.assumptions.map(assumption => `<li>${assumption}</li>`).join('')}
        </ul>

        <h3>项目限制</h3>
        <ul>
            ${appendix.limitations.map(limitation => `<li>${limitation}</li>`).join('')}
        </ul>
      `;
    }

    // 生成项目假设
    function generateProjectAssumptions() {
      return [
        '上游系统数据接口稳定可用',
        '业务需求在项目执行期间不会发生重大变更',
        '技术人员配置及时到位且具备相应技能',
        '第三方组件和工具能够按计划获得',
        '硬件和网络环境能够满足系统要求',
        '监管政策在项目期间保持相对稳定'
      ];
    }

    // 生成项目限制
    function generateProjectLimitations() {
      return [
        '项目周期固定，延期将面临合同处罚',
        '预算有限，需要严格控制成本',
        '数据质量要求100%，容错空间极小',
        '必须通过等保三级测评，安全要求严格',
        '信创环境适配增加了技术复杂性',
        '多个上游系统协调存在不确定性'
      ];
    }

    // 下载报告
    function downloadReport(content, filename) {
      const blob = new Blob([content], { type: 'text/html;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${filename}_${new Date().toISOString().split('T')[0]}.html`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      showReportAlert('success', '报告已生成并下载');
    }

    // 生成Excel报告
    function generateExcelReport() {
      if (!sowData || !sowData.analysis) {
        showReportAlert('warning', '请先上传并分析SOW文档');
        return;
      }

      const analysis = sowData.analysis;
      const csvContent = generateCSVContent(analysis);
      downloadCSV(csvContent, 'EAST5.0项目数据分析');
    }

    // 生成CSV内容
    function generateCSVContent(analysis) {
      let csv = 'EAST5.0项目数据分析报告\n\n';

      // 项目基本信息
      csv += '项目基本信息\n';
      csv += '项目名称,客户,承包商,项目周期,开始日期,结束日期\n';
      csv += `${analysis.projectInfo.name},${analysis.projectInfo.client},${analysis.projectInfo.contractor},${analysis.projectInfo.duration}周,${analysis.projectInfo.startDate},${analysis.projectInfo.endDate}\n\n`;

      // 关键指标
      csv += '关键指标\n';
      csv += '指标名称,数值\n';
      csv += `总成本,${formatCurrency(analysis.costs.total)}\n`;
      csv += `团队规模,${analysis.resources.teamSize}人\n`;
      csv += `复杂度等级,${analysis.complexity.level}\n`;
      csv += `复杂度评分,${analysis.complexity.score}\n\n`;

      // 成本分解
      csv += '成本分解\n';
      csv += '成本类别,金额(万元)\n';
      csv += `人力成本,${Math.round(analysis.costs.personnel / 10000)}\n`;
      csv += `硬件设备,${Math.round(analysis.costs.hardware / 10000)}\n`;
      csv += `软件许可,${Math.round(analysis.costs.software / 10000)}\n`;
      csv += `培训费用,${Math.round(analysis.costs.training / 10000)}\n`;
      csv += `管理费用,${Math.round(analysis.costs.management / 10000)}\n`;
      csv += `风险缓冲,${Math.round(analysis.costs.contingency / 10000)}\n`;
      csv += `总计,${Math.round(analysis.costs.total / 10000)}\n\n`;

      // 项目阶段
      csv += '项目阶段规划\n';
      csv += '阶段名称,开始周,结束周,主要交付物\n';
      analysis.timeline.forEach(phase => {
        csv += `${phase.name},${phase.start},${phase.end},${phase.deliverables}\n`;
      });
      csv += '\n';

      // 风险评估
      csv += '风险评估\n';
      csv += '风险类型,风险描述,发生概率,影响程度,缓解措施\n';
      analysis.risks.forEach(risk => {
        csv += `${risk.type},"${risk.description}",${risk.probability},${risk.impact},"${risk.mitigation}"\n`;
      });

      return csv;
    }

    // 下载CSV文件
    function downloadCSV(content, filename) {
      const BOM = '\uFEFF'; // 添加BOM以支持中文
      const blob = new Blob([BOM + content], { type: 'text/csv;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${filename}_${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      showReportAlert('success', 'Excel报告已生成并下载');
    }

    // 显示报告提醒
    function showReportAlert(type, message) {
      const alertDiv = document.createElement('div');
      const colors = {
        success: 'bg-green-50 border-green-200 text-green-800',
        warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',
        error: 'bg-red-50 border-red-200 text-red-800'
      };

      alertDiv.className = `fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm border ${colors[type] || colors.success}`;
      alertDiv.innerHTML = `
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <span class="font-medium">${type === 'success' ? '成功' : type === 'warning' ? '注意' : '错误'}</span>
        </div>
        <p class="text-sm mt-1 ml-7">${message}</p>
        <button onclick="this.parentElement.parentElement.remove()" class="absolute top-2 right-2">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
      `;

      document.body.appendChild(alertDiv);

      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.parentNode.removeChild(alertDiv);
        }
      }, 4000);
    }

    // Enhanced UI Interactions
    function initializeAdvancedInteractions() {
      // Initialize tooltips
      initializeTooltips();

      // Initialize smooth transitions
      initializeSmoothTransitions();

      // Initialize keyboard shortcuts
      initializeKeyboardShortcuts();

      // Initialize theme toggle
      initializeThemeToggle();

      // Initialize live notifications
      initializeNotificationSystem();

      // Initialize auto-save
      initializeAutoSave();

      // Initialize advanced animations
      initializeAdvancedAnimations();

      // Initialize collaboration features
      initializeCollaborationFeatures();

      // Initialize project management features
      initializeProjectManagement();
    }

    // Tooltip system
    function initializeTooltips() {
      const tooltipElements = document.querySelectorAll('[data-tooltip]');

      tooltipElements.forEach(element => {
        element.addEventListener('mouseenter', (e) => {
          showTooltip(e.target, e.target.getAttribute('data-tooltip'));
        });

        element.addEventListener('mouseleave', hideTooltip);
      });
    }

    function showTooltip(element, text) {
      const tooltip = document.createElement('div');
      tooltip.className = 'tooltip';
      tooltip.textContent = text;
      tooltip.style.cssText = `
        position: absolute;
        background: #1f2937;
        color: white;
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 14px;
        z-index: 10000;
        pointer-events: none;
        white-space: nowrap;
        opacity: 0;
        transform: translateY(5px);
        transition: all 0.2s ease;
      `;

      document.body.appendChild(tooltip);

      const rect = element.getBoundingClientRect();
      tooltip.style.left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2) + 'px';
      tooltip.style.top = rect.top - tooltip.offsetHeight - 8 + 'px';

      setTimeout(() => {
        tooltip.style.opacity = '1';
        tooltip.style.transform = 'translateY(0)';
      }, 10);
    }

    function hideTooltip() {
      const tooltip = document.querySelector('.tooltip');
      if (tooltip) {
        tooltip.style.opacity = '0';
        tooltip.style.transform = 'translateY(5px)';
        setTimeout(() => tooltip.remove(), 200);
      }
    }

    // Smooth transitions
    function initializeSmoothTransitions() {
      // Add ripple effect to buttons
      document.querySelectorAll('.btn').forEach(button => {
        button.addEventListener('click', createRippleEffect);
      });

      // Add hover effects to cards
      document.querySelectorAll('.card').forEach(card => {
        card.addEventListener('mouseenter', addCardHoverEffect);
        card.addEventListener('mouseleave', removeCardHoverEffect);
      });
    }

    function createRippleEffect(e) {
      const button = e.currentTarget;
      const ripple = document.createElement('span');
      const rect = button.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = e.clientX - rect.left - size / 2;
      const y = e.clientY - rect.top - size / 2;

      ripple.style.cssText = `
        position: absolute;
        width: ${size}px;
        height: ${size}px;
        left: ${x}px;
        top: ${y}px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 50%;
        transform: scale(0);
        animation: ripple 0.6s linear;
        pointer-events: none;
      `;

      // Add ripple animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes ripple {
          to {
            transform: scale(4);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);

      button.appendChild(ripple);
      setTimeout(() => ripple.remove(), 600);
    }

    function addCardHoverEffect(e) {
      const card = e.currentTarget;
      const icon = card.querySelector('svg');
      if (icon) {
        icon.style.transform = 'scale(1.1) rotate(5deg)';
        icon.style.transition = 'transform 0.3s ease';
      }
    }

    function removeCardHoverEffect(e) {
      const card = e.currentTarget;
      const icon = card.querySelector('svg');
      if (icon) {
        icon.style.transform = 'scale(1) rotate(0deg)';
      }
    }

    // Keyboard shortcuts
    function initializeKeyboardShortcuts() {
      document.addEventListener('keydown', (e) => {
        // Ctrl/Cmd + S for save
        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
          e.preventDefault();
          saveCurrentProgress();
        }

        // Ctrl/Cmd + R for generate report
        if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
          e.preventDefault();
          generateComprehensiveReport();
        }

        // Ctrl/Cmd + E for export Excel
        if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
          e.preventDefault();
          generateExcelReport();
        }

        // Escape to close modals
        if (e.key === 'Escape') {
          closeAllModals();
        }
      });
    }

    // Theme toggle
    function initializeThemeToggle() {
      const themeToggle = document.createElement('button');
      themeToggle.innerHTML = `
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
        </svg>
      `;
      themeToggle.className = 'btn btn-ghost';
      themeToggle.setAttribute('data-tooltip', '切换主题');
      themeToggle.onclick = toggleTheme;

      // Add to header
      const headerActions = document.querySelector('.flex.items-center.space-x-4');
      if (headerActions) {
        headerActions.insertBefore(themeToggle, headerActions.firstChild);
      }
    }

    function toggleTheme() {
      document.body.classList.toggle('dark-theme');
      localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
      showNotification('主题已切换', 'success');
    }

    // Notification system
    function initializeNotificationSystem() {
      window.showNotification = showNotification;
    }

    function showNotification(message, type = 'info', duration = 3000) {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = `
        <div class="flex items-center">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
            ${getNotificationIcon(type)}
          </svg>
          <span>${message}</span>
        </div>
      `;

      document.body.appendChild(notification);

      // Trigger animation
      setTimeout(() => notification.classList.add('show'), 10);

      // Auto remove
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
      }, duration);
    }

    function getNotificationIcon(type) {
      const icons = {
        success: '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>',
        warning: '<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>',
        error: '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>',
        info: '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>'
      };
      return icons[type] || icons.info;
    }

    // Auto-save functionality
    function initializeAutoSave() {
      setInterval(() => {
        saveCurrentProgress();
      }, 30000); // Auto-save every 30 seconds
    }

    function saveCurrentProgress() {
      if (sowData && sowData.analysis) {
        localStorage.setItem('sow-analysis-progress', JSON.stringify(sowData));
        console.log('Progress auto-saved');
      }
    }

    function loadSavedProgress() {
      const saved = localStorage.getItem('sow-analysis-progress');
      if (saved) {
        try {
          return JSON.parse(saved);
        } catch (e) {
          console.error('Failed to load saved progress:', e);
        }
      }
      return null;
    }

    // Advanced animations
    function initializeAdvancedAnimations() {
      // Typing animation for headers
      animateTyping();

      // Number counting animation
      animateNumbers();

      // Progress bar animations
      animateProgressBars();
    }

    function animateTyping() {
      const typingElements = document.querySelectorAll('[data-typing]');
      typingElements.forEach(element => {
        const text = element.textContent;
        element.textContent = '';
        let index = 0;

        const type = () => {
          if (index < text.length) {
            element.textContent += text[index];
            index++;
            setTimeout(type, 50);
          }
        };

        // Start animation when element is visible
        const observer = new IntersectionObserver((entries) => {
          if (entries[0].isIntersecting) {
            type();
            observer.disconnect();
          }
        });

        observer.observe(element);
      });
    }

    function animateNumbers() {
      const numberElements = document.querySelectorAll('[data-count]');
      numberElements.forEach(element => {
        const target = parseInt(element.getAttribute('data-count'));
        const duration = 2000;
        const increment = target / (duration / 16);
        let current = 0;

        const update = () => {
          current += increment;
          if (current < target) {
            element.textContent = Math.floor(current).toLocaleString();
            requestAnimationFrame(update);
          } else {
            element.textContent = target.toLocaleString();
          }
        };

        // Start animation when element is visible
        const observer = new IntersectionObserver((entries) => {
          if (entries[0].isIntersecting) {
            update();
            observer.disconnect();
          }
        });

        observer.observe(element);
      });
    }

    function animateProgressBars() {
      const progressBars = document.querySelectorAll('.progress-bar');
      progressBars.forEach(bar => {
        const target = bar.getAttribute('data-progress') || bar.style.width;
        bar.style.width = '0%';

        // Start animation when element is visible
        const observer = new IntersectionObserver((entries) => {
          if (entries[0].isIntersecting) {
            setTimeout(() => {
              bar.style.width = target;
            }, 200);
            observer.disconnect();
          }
        });

        observer.observe(bar);
      });
    }

    // Collaboration Features
    function initializeCollaborationFeatures() {
      // Initialize real-time connection
      initializeRealtimeConnection();

      // Load chat history
      loadChatHistory();

      // Load comments
      loadComments();

      // Load version history
      loadVersionHistory();

      // Simulate other users
      simulateOtherUsers();

      // Set up periodic updates
      startPeriodicUpdates();
    }

    function initializeRealtimeConnection() {
      // Simulate WebSocket connection
      console.log('Real-time collaboration initialized');

      // Show connection status
      showNotification('协作功能已启动', 'success');
    }

    // Chat functionality
    function toggleChat() {
      const modal = document.getElementById('chat-modal');
      modal.classList.toggle('hidden');
      if (!modal.classList.contains('hidden')) {
        document.getElementById('chat-input').focus();
        simulateIncomingMessage();
      }
    }

    function sendMessage() {
      const input = document.getElementById('chat-input');
      const message = input.value.trim();

      if (message) {
        addChatMessage({
          user: '我',
          avatar: 'PM',
          message: message,
          time: new Date().toLocaleTimeString(),
          isOwn: true
        });

        input.value = '';

        // Simulate response
        setTimeout(() => {
          simulateIncomingMessage();
        }, 2000);
      }
    }

    function addChatMessage(messageData) {
      const chatMessages = document.getElementById('chat-messages');
      const messageElement = document.createElement('div');
      messageElement.className = `flex ${messageData.isOwn ? 'justify-end' : 'justify-start'} mb-4`;

      messageElement.innerHTML = `
        <div class="flex ${messageData.isOwn ? 'flex-row-reverse' : 'flex-row'} items-start space-x-2 max-w-xs">
          <div class="w-8 h-8 bg-${messageData.isOwn ? 'blue' : 'gray'}-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0">
            ${messageData.avatar}
          </div>
          <div class="${messageData.isOwn ? 'mr-2' : 'ml-2'}">
            <div class="bg-${messageData.isOwn ? 'blue' : 'gray'}-100 text-${messageData.isOwn ? 'white' : 'gray'}-800 rounded-lg p-3">
              <p class="text-sm">${messageData.message}</p>
            </div>
            <p class="text-xs text-gray-500 mt-1 ${messageData.isOwn ? 'text-right' : ''}">${messageData.user} · ${messageData.time}</p>
          </div>
        </div>
      `;

      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function loadChatHistory() {
      const mockMessages = [
        { user: 'TL', avatar: 'TL', message: '项目复杂度分析已完成', time: '09:15', isOwn: false },
        { user: 'QA', avatar: 'QA', message: '测试计划需要进一步细化', time: '09:20', isOwn: false },
        { user: '我', avatar: 'PM', message: '收到，我会在今天内完善', time: '09:25', isOwn: true }
      ];

      mockMessages.forEach(msg => addChatMessage(msg));
    }

    function simulateIncomingMessage() {
      const users = ['TL', 'QA', 'DEV', 'BA'];
      const messages = [
        '数据模型设计需要更多细节',
        '成本估算已经更新',
        '风险评估报告已完成',
        '项目进度略有延迟',
        '新的需求变更请求'
      ];

      const randomUser = users[Math.floor(Math.random() * users.length)];
      const randomMessage = messages[Math.floor(Math.random() * messages.length)];

      addChatMessage({
        user: randomUser,
        avatar: randomUser,
        message: randomMessage,
        time: new Date().toLocaleTimeString(),
        isOwn: false
      });

      // Show notification
      showNotification(`${randomUser}: ${randomMessage}`, 'info');
    }

    // Comments functionality
    function toggleComments() {
      const panel = document.getElementById('comments-panel');
      panel.classList.toggle('translate-x-full');
    }

    function addComment() {
      const input = document.getElementById('comment-input');
      const comment = input.value.trim();

      if (comment) {
        const commentsList = document.getElementById('comments-list');
        const commentElement = document.createElement('div');
        commentElement.className = 'bg-gray-50 rounded-lg p-4';

        commentElement.innerHTML = `
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
              PM
            </div>
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <h4 class="font-semibold text-sm">项目经理</h4>
                <span class="text-xs text-gray-500">${new Date().toLocaleString()}</span>
              </div>
              <p class="text-sm text-gray-700 mt-1">${comment}</p>
              <div class="flex items-center space-x-4 mt-2">
                <button class="text-xs text-blue-600 hover:text-blue-800">回复</button>
                <button class="text-xs text-gray-600 hover:text-gray-800">编辑</button>
                <button class="text-xs text-red-600 hover:text-red-800">删除</button>
              </div>
            </div>
          </div>
        `;

        commentsList.insertBefore(commentElement, commentsList.firstChild);
        input.value = '';

        showNotification('评论已发布', 'success');
      }
    }

    function loadComments() {
      const mockComments = [
        {
          user: '技术负责人',
          avatar: 'TL',
          comment: '建议增加更多技术风险评估',
          time: '2025-10-12 14:30',
          replies: 2
        },
        {
          user: '质量保证',
          avatar: 'QA',
          comment: '数据质量检查清单需要更新',
          time: '2025-10-12 13:15',
          replies: 1
        }
      ];

      const commentsList = document.getElementById('comments-list');
      mockComments.forEach(comment => {
        const commentElement = document.createElement('div');
        commentElement.className = 'bg-gray-50 rounded-lg p-4';

        commentElement.innerHTML = `
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bg-${comment.avatar === 'TL' ? 'green' : 'purple'}-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
              ${comment.avatar}
            </div>
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <h4 class="font-semibold text-sm">${comment.user}</h4>
                <span class="text-xs text-gray-500">${comment.time}</span>
              </div>
              <p class="text-sm text-gray-700 mt-1">${comment.comment}</p>
              <div class="flex items-center space-x-4 mt-2">
                <button class="text-xs text-blue-600 hover:text-blue-800">${comment.replies} 条回复</button>
                <button class="text-xs text-gray-600 hover:text-gray-800">回复</button>
              </div>
            </div>
          </div>
        `;

        commentsList.appendChild(commentElement);
      });
    }

    // Version history functionality
    function toggleVersionHistory() {
      const modal = document.getElementById('version-modal');
      modal.classList.toggle('hidden');
    }

    function loadVersionHistory() {
      const versions = [
        {
          version: 'v2.1.0',
          date: '2025-10-13 10:30',
          author: '项目经理',
          changes: ['优化WBS分解算法', '增加实时协作功能', '完善UI/UX设计'],
          type: 'feature'
        },
        {
          version: 'v2.0.0',
          date: '2025-10-12 16:45',
          author: '技术负责人',
          changes: ['重构分析引擎', '添加高级图表', '修复已知问题'],
          type: 'major'
        },
        {
          version: 'v1.9.0',
          date: '2025-10-11 14:20',
          author: '开发团队',
          changes: ['性能优化', '增加导出功能', '改进数据处理'],
          type: 'feature'
        }
      ];

      const versionList = document.getElementById('version-list');
      versions.forEach(version => {
        const versionElement = document.createElement('div');
        versionElement.className = 'border rounded-lg p-4 hover:shadow-md transition-shadow';

        const typeColor = {
          feature: 'green',
          major: 'blue',
          patch: 'gray'
        }[version.type];

        versionElement.innerHTML = `
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center space-x-2">
              <span class="font-semibold text-lg">${version.version}</span>
              <span class="px-2 py-1 bg-${typeColor}-100 text-${typeColor}-800 text-xs rounded-full">${version.type}</span>
            </div>
            <span class="text-sm text-gray-500">${version.date}</span>
          </div>
          <p class="text-sm text-gray-600 mb-2">作者: ${version.author}</p>
          <div class="space-y-1">
            ${version.changes.map(change => `
              <div class="flex items-center space-x-2">
                <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-sm">${change}</span>
              </div>
            `).join('')}
          </div>
        `;

        versionList.appendChild(versionElement);
      });
    }

    // Real-time user simulation
    function simulateOtherUsers() {
      const users = [
        { name: '技术负责人', avatar: 'TL', color: 'green', status: 'active' },
        { name: '质量保证', avatar: 'QA', color: 'purple', status: 'active' },
        { name: '业务分析师', avatar: 'BA', color: 'orange', status: 'away' },
        { name: '开发工程师', avatar: 'DEV', color: 'blue', status: 'active' }
      ];

      // Update online users periodically
      setInterval(() => {
        const activeCount = users.filter(u => u.status === 'active').length + 1; // +1 for current user
        const statusElement = document.querySelector('.flex.items-center.space-x-2 p');
        if (statusElement) {
          statusElement.innerHTML = `
            <p class="text-sm font-medium">${activeCount}人在线</p>
            <p class="text-xs opacity-75">协作中</p>
          `;
        }
      }, 30000);
    }

    // Periodic updates
    function startPeriodicUpdates() {
      // Simulate real-time updates
      setInterval(() => {
        const updates = [
          '新用户加入协作',
          '项目进度已更新',
          '风险评估有变化',
          '成本模型已优化',
          '新的评论已添加'
        ];

        const randomUpdate = updates[Math.floor(Math.random() * updates.length)];

        // Only show some updates to avoid spam
        if (Math.random() > 0.7) {
          showSystemNotification(randomUpdate);
        }
      }, 45000);
    }

    function showSystemNotification(message) {
      const toast = document.getElementById('notification-toast');
      const title = document.getElementById('notification-title');
      const messageElement = document.getElementById('notification-message');

      if (toast && title && messageElement) {
        title.textContent = '系统通知';
        messageElement.textContent = message;

        toast.classList.remove('translate-x-full');

        setTimeout(() => {
          hideNotification();
        }, 5000);
      }
    }

    function hideNotification() {
      const toast = document.getElementById('notification-toast');
      if (toast) {
        toast.classList.add('translate-x-full');
      }
    }

    // Project Templates and History Management
    function initializeProjectManagement() {
      // Load recent projects
      loadRecentProjects();

      // Load project statistics
      updateProjectStats();

      // Initialize template library
      initializeTemplateLibrary();

      // Set up project storage
      initializeProjectStorage();
    }

    function initializeProjectStorage() {
      // Initialize localStorage for projects
      if (!localStorage.getItem('projects')) {
        localStorage.setItem('projects', JSON.stringify([]));
      }
      if (!localStorage.getItem('project-templates')) {
        localStorage.setItem('project-templates', JSON.stringify([]));
      }
    }

    function createNewProject() {
      document.getElementById('new-project-modal').classList.remove('hidden');
    }

    function hideNewProjectModal() {
      document.getElementById('new-project-modal').classList.add('hidden');
    }

    function createProject() {
      const name = document.getElementById('project-name').value.trim();
      const description = document.getElementById('project-description').value.trim();
      const type = document.getElementById('project-type').value;
      const budget = document.getElementById('budget-range').value;
      const duration = document.getElementById('project-duration').value;

      if (!name) {
        showNotification('请输入项目名称', 'warning');
        return;
      }

      const project = {
        id: generateId(),
        name: name,
        description: description,
        type: type,
        budget: budget,
        duration: duration,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        status: 'draft',
        sowData: null,
        analysis: null,
        template: null
      };

      // Save project to localStorage
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      projects.unshift(project);
      localStorage.setItem('projects', JSON.stringify(projects));

      // Update UI
      loadRecentProjects();
      updateProjectStats();

      // Hide modal and show success message
      hideNewProjectModal();
      showNotification(`项目 "${name}" 创建成功`, 'success');

      // Switch to analysis step with empty state
      currentProject = project;
      switchStep('analysis');

      // Reset form
      document.getElementById('new-project-form').reset();
    }

    function loadRecentProjects() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const recentProjects = projects.slice(0, 5); // Show last 5 projects
      const container = document.getElementById('recent-projects');

      if (recentProjects.length === 0) {
        container.innerHTML = '<p class="text-sm text-gray-500">暂无项目记录</p>';
        return;
      }

      container.innerHTML = recentProjects.map(project => `
        <div class="p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors" onclick="loadProject('${project.id}')">
          <div class="flex items-center justify-between">
            <h4 class="font-medium text-sm truncate">${project.name}</h4>
            <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full">${getProjectTypeLabel(project.type)}</span>
          </div>
          <div class="flex items-center justify-between mt-2 text-xs text-gray-500">
            <span>${new Date(project.createdAt).toLocaleDateString()}</span>
            <span class="px-2 py-1 ${getStatusColor(project.status)} rounded-full">${getStatusLabel(project.status)}</span>
          </div>
        </div>
      `).join('');
    }

    function loadProject(projectId) {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const project = projects.find(p => p.id === projectId);

      if (project) {
        currentProject = project;
        showNotification(`加载项目: ${project.name}`, 'info');

        // Load project data if exists
        if (project.sowData) {
          sowData = project.sowData;
          switchStep('analysis');
        } else {
          switchStep('upload');
        }
      }
    }

    function saveCurrentProject() {
      if (!currentProject) return;

      currentProject.sowData = sowData;
      currentProject.updatedAt = new Date().toISOString();
      currentProject.status = sowData && sowData.analysis ? 'active' : 'draft';

      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const index = projects.findIndex(p => p.id === currentProject.id);
      if (index !== -1) {
        projects[index] = currentProject;
        localStorage.setItem('projects', JSON.stringify(projects));
        showNotification('项目已保存', 'success');
      }
    }

    function deleteProject(projectId) {
      if (!confirm('确定要删除这个项目吗？此操作无法撤销。')) {
        return;
      }

      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const filteredProjects = projects.filter(p => p.id !== projectId);
      localStorage.setItem('projects', JSON.stringify(filteredProjects));

      loadRecentProjects();
      updateProjectStats();
      showNotification('项目已删除', 'info');

      if (currentProject && currentProject.id === projectId) {
        currentProject = null;
      }
    }

    function showProjectTemplates() {
      document.getElementById('templates-modal').classList.remove('hidden');
      loadTemplates();
    }

    function hideProjectTemplates() {
      document.getElementById('templates-modal').classList.add('hidden');
    }

    function loadTemplates() {
      const templates = getProjectTemplates();
      const container = document.getElementById('templates-grid');

      if (templates.length === 0) {
        container.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">暂无可用模板</div>';
        return;
      }

      container.innerHTML = templates.map(template => `
        <div class="border rounded-lg p-6 hover:shadow-lg transition-shadow cursor-pointer ${template.isPopular ? 'ring-2 ring-blue-500' : ''}"
             onclick="useTemplate('${template.id}')">
          ${template.isPopular ? '<div class="absolute top-2 right-2 bg-orange-500 text-white text-xs px-2 py-1 rounded-full">热门</div>' : ''}
          <div class="flex items-center justify-between mb-4">
            <h4 class="font-semibold text-lg">${template.name}</h4>
            <span class="text-sm px-3 py-1 bg-${getCategoryColor(template.category)}-100 text-${getCategoryColor(template.category)}-800 rounded-full">
              ${getCategoryLabel(template.category)}
            </span>
          </div>
          <p class="text-sm text-gray-600 mb-4">${template.description}</p>
          <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
            <span>创建时间: ${new Date(template.createdAt).toLocaleDateString()}</span>
            <span>使用次数: ${template.usageCount || 0}</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sm font-medium">预估成本: ${template.estimatedCost}</span>
            <span class="text-sm font-medium">周期: ${template.estimatedDuration}</span>
          </div>
        </div>
      `).join('');
    }

    function getProjectTemplates() {
      // Load custom templates from localStorage
      const customTemplates = JSON.parse(localStorage.getItem('project-templates') || '[]');

      // Predefined templates
      const predefinedTemplates = [
        {
          id: 'east5.0-template',
          name: 'EAST5.0监管报送系统',
          description: '适用于银行业EAST5.0监管数据报送系统建设项目',
          category: 'banking',
          estimatedCost: '280万',
          estimatedDuration: '28周',
          isPopular: true,
          createdAt: '2025-10-10',
          usageCount: 156,
          sowData: sowData, // Use current analysis data
          configuration: {
            complexity: 'high',
            teamSize: 15,
            riskLevel: 'medium'
          }
        },
        {
          id: 'core-banking',
          name: '核心银行系统升级',
          description: '银行核心业务系统升级改造项目模板',
          category: 'banking',
          estimatedCost: '450万',
          estimatedDuration: '36周',
          isPopular: false,
          createdAt: '2025-10-08',
          usageCount: 23,
          configuration: {
            complexity: 'very-high',
            teamSize: 20,
            riskLevel: 'high'
          }
        },
        {
          id: 'crm-system',
          name: 'CRM客户管理系统',
          description: '企业客户关系管理系统开发模板',
          category: 'it',
          estimatedCost: '120万',
          estimatedDuration: '16周',
          isPopular: false,
          createdAt: '2025-10-05',
          usageCount: 45,
          configuration: {
            complexity: 'medium',
            teamSize: 8,
            riskLevel: 'low'
          }
        },
        {
          id: 'insurance-core',
          name: '保险核心系统',
          description: '保险业核心业务系统建设项目模板',
          category: 'insurance',
          estimatedCost: '380万',
          estimatedDuration: '32周',
          isPopular: false,
          createdAt: '2025-10-06',
          usageCount: 18,
          configuration: {
            complexity: 'high',
            teamSize: 14,
            riskLevel: 'medium'
          }
        }
      ];

      return [...predefinedTemplates, ...customTemplates];
    }

    function useTemplate(templateId) {
      const templates = getProjectTemplates();
      const template = templates.find(t => t.id === templateId);

      if (template) {
        // Increment usage count
        template.usageCount = (template.usageCount || 0) + 1;

        // Update template in localStorage if it's a custom template
        if (!templateId.startsWith('east5.0-template') && !templateId.startsWith('core-banking')) {
          const customTemplates = JSON.parse(localStorage.getItem('project-templates') || '[]');
          const index = customTemplates.findIndex(t => t.id === templateId);
          if (index !== -1) {
            customTemplates[index] = template;
            localStorage.setItem('project-templates', JSON.stringify(customTemplates));
          }
        }

        // Create new project from template
        const project = {
          id: generateId(),
          name: `${template.name} - 副本`,
          description: `基于"${template.name}"模板创建的项目`,
          type: template.category,
          budget: template.estimatedCost,
          duration: template.estimatedDuration,
          createdAt: new Date().toISOString(),
          updatedAt: new Date().toISOString(),
          status: 'draft',
          sowData: template.sowData,
          analysis: template.sowData ? template.sowData.analysis : null,
          template: template.id
        };

        // Save project
        const projects = JSON.parse(localStorage.getItem('projects') || '[]');
        projects.unshift(project);
        localStorage.setItem('projects', JSON.stringify(projects));

        // Load project
        loadProject(project.id);
        hideProjectTemplates();

        showNotification(`已使用模板"${template.name}"创建项目`, 'success');
      }
    }

    function filterTemplates(category) {
      const templates = getProjectTemplates();
      const filtered = category === 'all' ? templates : templates.filter(t => t.category === category);

      // Update button styles
      document.querySelectorAll('[onclick^="filterTemplates"]').forEach(btn => {
        if (btn.getAttribute('onclick').includes(category)) {
          btn.className = 'px-4 py-2 bg-blue-500 text-white rounded-lg';
        } else {
          btn.className = 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300';
        }
      });

      // Re-render templates
      const container = document.getElementById('templates-grid');
      if (filtered.length === 0) {
        container.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">该分类暂无模板</div>';
      } else {
        container.innerHTML = filtered.map(template => `
          <div class="border rounded-lg p-6 hover:shadow-lg transition-shadow cursor-pointer ${template.isPopular ? 'ring-2 ring-blue-500' : ''}"
               onclick="useTemplate('${template.id}')">
            ${template.isPopular ? '<div class="absolute top-2 right-2 bg-orange-500 text-white text-xs px-2 py-1 rounded-full">热门</div>' : ''}
            <div class="flex items-center justify-between mb-4">
              <h4 class="font-semibold text-lg">${template.name}</h4>
              <span class="text-sm px-3 py-1 bg-${getCategoryColor(template.category)}-100 text-${getCategoryColor(template.category)}-800 rounded-full">
                ${getCategoryLabel(template.category)}
              </span>
            </div>
            <p class="text-sm text-gray-600 mb-4">${template.description}</p>
            <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
              <span>创建时间: ${new Date(template.createdAt).toLocaleDateString()}</span>
              <span>使用次数: ${template.usageCount || 0}</span>
            </div>
            <div class="flex items-center space-x-2">
              <span class="text-sm font-medium">预估成本: ${template.estimatedCost}</span>
              <span class="text-sm font-medium">周期: ${template.estimatedDuration}</span>
            </div>
          </div>
        `).join('');
      }
    }

    function createCustomTemplate() {
      if (!currentProject || !currentProject.sowData) {
        showNotification('请先完成项目分析', 'warning');
        return;
      }

      const templateName = prompt('请输入模板名称:');
      if (!templateName) return;

      const template = {
        id: generateId(),
        name: templateName,
        description: currentProject.description || `基于项目"${currentProject.name}"创建的模板`,
        category: currentProject.type || 'other',
        estimatedCost: formatCurrency(currentProject.sowData.analysis.costs.total),
        estimatedDuration: `${currentProject.sowData.analysis.projectInfo.duration}周`,
        isPopular: false,
        createdAt: new Date().toISOString(),
        usageCount: 0,
        sowData: JSON.parse(JSON.stringify(currentProject.sowData)),
        configuration: {
          complexity: currentProject.sowData.analysis.complexity.level,
          teamSize: currentProject.sowData.analysis.resources.teamSize,
          riskLevel: calculateOverallRiskLevel(currentProject.sowData.analysis.risks)
        }
      };

      const templates = JSON.parse(localStorage.getItem('project-templates') || '[]');
      templates.push(template);
      localStorage.setItem('project-templates', JSON.stringify(templates));

      showNotification(`模板"${templateName}" 创建成功`, 'success');
    }

    function updateProjectStats() {
      const projects = JSON.parse(localStorage.getItem('projects') || '[]');
      const currentMonth = new Date().getMonth();
      const currentYear = new Date().getFullYear();

      const monthlyAnalysis = projects.filter(p => {
        const date = new Date(p.createdAt);
        return date.getMonth() === currentMonth && date.getFullYear() === currentYear;
      }).length;

      // Calculate time saved (estimated 40 hours per project)
      const timeSaved = projects.length * 40;

      document.getElementById('total-projects').textContent = projects.length;
      document.getElementById('monthly-analysis').textContent = monthlyAnalysis;
      document.getElementById('time-saved').textContent = `${timeSaved}h`;
    }

    // Helper functions
    function getProjectTypeLabel(type) {
      const types = {
        'banking': '银行业',
        'insurance': '保险业',
        'securities': '证券业',
        'it': 'IT系统',
        'other': '其他'
      };
      return types[type] || '未分类';
    }

    function getStatusColor(status) {
      const colors = {
        'draft': 'bg-gray-100 text-gray-800',
        'active': 'bg-blue-100 text-blue-800',
        'completed': 'bg-green-100 text-green-800',
        'archived': 'bg-gray-100 text-gray-800'
      };
      return colors[status] || 'bg-gray-100 text-gray-800';
    }

    function getStatusLabel(status) {
      const labels = {
        'draft': '草稿',
        'active': '进行中',
        'completed': '已完成',
        'archived': '已归档'
      };
      return labels[status] || '未知';
    }

    function getCategoryColor(category) {
      const colors = {
        'banking': 'blue',
        'insurance': 'green',
        'securities': 'purple',
        'it': 'orange',
        'other': 'gray'
      };
      return colors[category] || 'gray';
    }

    function getCategoryLabel(category) {
      const labels = {
        'banking': '银行业',
        'insurance': '保险业',
        'securities': '证券业',
        'it': 'IT系统',
        'other': '其他'
      };
      return labels[category] || '其他';
    }

    function generateId() {
      return 'proj_' + Math.random().toString(36).substr(2, 9);
    }

    // Auto-save current project when data changes
    setInterval(() => {
      if (currentProject && sowData) {
        saveCurrentProject();
      }
    }, 30000); // Auto-save every 30 seconds

    // Enhanced keyboard shortcuts for collaboration
    document.addEventListener('keydown', (e) => {
      // Ctrl/Cmd + Shift + C for chat
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'C') {
        e.preventDefault();
        toggleChat();
      }

      // Ctrl/Cmd + Shift + M for comments
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'M') {
        e.preventDefault();
        toggleComments();
      }

      // Ctrl/Cmd + Shift + V for version history
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'V') {
        e.preventDefault();
        toggleVersionHistory();
      }

      // Ctrl/Cmd + Shift + T for templates
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'T') {
        e.preventDefault();
        showProjectTemplates();
      }

      // Ctrl/Cmd + Shift + N for new project
      if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'N') {
        e.preventDefault();
        createNewProject();
      }

      // Ctrl/Cmd + S for save project
      if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        if (currentProject) {
          saveCurrentProject();
        }
      }
    });

    // Utility functions
    function closeAllModals() {
      document.querySelectorAll('.modal').forEach(modal => {
        modal.style.display = 'none';
      });
      document.getElementById('chat-modal').classList.add('hidden');
      document.getElementById('version-modal').classList.add('hidden');
      document.getElementById('comments-panel').classList.add('translate-x-full');
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize all advanced interactions
      initializeAdvancedInteractions();

      // Add smooth scrolling
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });

      // Add animations with staggered timing
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
          if (entry.isIntersecting) {
            setTimeout(() => {
              entry.target.classList.add('animate-slide-up');
            }, index * 100);
          }
        });
      }, observerOptions);

      document.querySelectorAll('.card, .metric-card').forEach(el => {
        observer.observe(el);
      });

      // Load saved progress if exists
      const savedProgress = loadSavedProgress();
      if (savedProgress) {
        console.log('Loaded saved progress');
        // Optionally restore the UI state
      }

      // Show welcome notification
      setTimeout(() => {
        showNotification('欢迎使用EAST5.0项目智能评估系统', 'success');
      }, 1000);

      // 添加全局报表生成函数
      window.generateComprehensiveReport = generateComprehensiveReport;
      window.generateExcelReport = generateExcelReport;
      window.showNotification = showNotification;

      // Mobile responsive functionality
      function showMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        if (menu) {
          menu.classList.remove('mobile-hidden');
          document.body.style.overflow = 'hidden';
        }
      }

      function hideMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        if (menu) {
          menu.classList.add('mobile-hidden');
          document.body.style.overflow = '';
        }
      }

      function toggleMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        if (menu) {
          if (menu.classList.contains('mobile-hidden')) {
            showMobileMenu();
          } else {
            hideMobileMenu();
          }
        }
      }

      // Handle window resize for responsive behavior
      function handleResize() {
        const width = window.innerWidth;
        const mobileMenu = document.getElementById('mobile-menu');
        const fab = document.querySelector('.fab');

        // Auto-hide mobile menu on desktop
        if (width > 767.98) {
          if (mobileMenu && !mobileMenu.classList.contains('mobile-hidden')) {
            hideMobileMenu();
          }
        }

        // Update chart dimensions for mobile
        const charts = document.querySelectorAll('canvas');
        charts.forEach(chart => {
          const chartInstance = Chart.getChart(chart);
          if (chartInstance) {
            chartInstance.resize();
          }
        });

        // Adjust grid layouts dynamically
        adjustGridLayout(width);
      }

      function adjustGridLayout(width) {
        const grids = document.querySelectorAll('.grid-cols-1, .grid-cols-2, .grid-cols-3, .grid-cols-4');

        grids.forEach(grid => {
          if (width < 576) {
            // Mobile: single column
            grid.style.gridTemplateColumns = '1fr';
          } else if (width < 768) {
            // Small tablets: two columns max
            if (grid.classList.contains('grid-cols-3') || grid.classList.contains('grid-cols-4')) {
              grid.style.gridTemplateColumns = 'repeat(2, 1fr)';
            }
          } else if (width < 992) {
            // Tablets: adjust for medium screens
            if (grid.classList.contains('grid-cols-4')) {
              grid.style.gridTemplateColumns = 'repeat(3, 1fr)';
            }
          } else {
            // Desktop: reset to default
            grid.style.gridTemplateColumns = '';
          }
        });
      }

      // Touch gesture support for mobile
      let touchStartX = 0;
      let touchStartY = 0;
      let touchEndX = 0;
      let touchEndY = 0;

      function handleTouchStart(e) {
        touchStartX = e.changedTouches[0].screenX;
        touchStartY = e.changedTouches[0].screenY;
      }

      function handleTouchEnd(e) {
        touchEndX = e.changedTouches[0].screenX;
        touchEndY = e.changedTouches[0].screenY;
        handleSwipeGesture();
      }

      function handleSwipeGesture() {
        const swipeThreshold = 50;
        const deltaX = touchEndX - touchStartX;
        const deltaY = touchEndY - touchStartY;

        // Horizontal swipe detection
        if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > swipeThreshold) {
          if (deltaX > 0) {
            // Swipe right - could be used for navigation
            console.log('Swipe right detected');
          } else {
            // Swipe left - could be used for navigation
            console.log('Swipe left detected');
          }
        }

        // Vertical swipe detection
        if (Math.abs(deltaY) > Math.abs(deltaX) && Math.abs(deltaY) > swipeThreshold) {
          if (deltaY > 0) {
            // Swipe down
            console.log('Swipe down detected');
          } else {
            // Swipe up
            console.log('Swipe up detected');
          }
        }
      }

      // Mobile performance optimizations
      function optimizeForMobile() {
        const isMobile = window.innerWidth <= 767.98;

        if (isMobile) {
          // Reduce animation complexity on mobile
          document.body.classList.add('mobile-optimized');

          // Optimize images and charts for mobile
          const images = document.querySelectorAll('img');
          images.forEach(img => {
            if (!img.loading) {
              img.loading = 'lazy';
            }
          });

          // Reduce chart animation duration
          Chart.defaults.animation.duration = 500;

          // Disable hover effects on touch devices
          if ('ontouchstart' in window) {
            document.body.classList.add('touch-device');
          }
        } else {
          document.body.classList.remove('mobile-optimized');
          Chart.defaults.animation.duration = 1000;
        }
      }

      // Initialize mobile features
      function initializeMobileFeatures() {
        // Add touch event listeners
        document.addEventListener('touchstart', handleTouchStart, { passive: true });
        document.addEventListener('touchend', handleTouchEnd, { passive: true });

        // Add resize listener
        window.addEventListener('resize', handleResize);

        // Initial mobile optimization
        optimizeForMobile();

        // Handle orientation changes
        window.addEventListener('orientationchange', () => {
          setTimeout(() => {
            handleResize();
            optimizeForMobile();
          }, 100);
        });

        // Add viewport meta tag support
        const viewport = document.querySelector('meta[name="viewport"]');
        if (viewport) {
          viewport.setAttribute('content', 'width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no');
        }
      }

      // Add mobile-specific CSS classes
      function addMobileClasses() {
        const isMobile = window.innerWidth <= 767.98;
        const isTablet = window.innerWidth > 767.98 && window.innerWidth <= 991.98;

        if (isMobile) {
          document.body.classList.add('mobile-device');
          document.body.classList.remove('tablet-device', 'desktop-device');
        } else if (isTablet) {
          document.body.classList.add('tablet-device');
          document.body.classList.remove('mobile-device', 'desktop-device');
        } else {
          document.body.classList.add('desktop-device');
          document.body.classList.remove('mobile-device', 'tablet-device');
        }
      }

      // Mobile accessibility improvements
      function improveMobileAccessibility() {
        // Add ARIA labels for mobile buttons
        const mobileButtons = document.querySelectorAll('.fab, .mobile-tappable');
        mobileButtons.forEach(button => {
          if (!button.getAttribute('aria-label')) {
            const text = button.textContent.trim() || button.getAttribute('data-tooltip');
            if (text) {
              button.setAttribute('aria-label', text);
            }
          }
        });

        // Ensure keyboard navigation works on mobile
        const focusableElements = document.querySelectorAll(
          'a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );

        focusableElements.forEach(element => {
          element.addEventListener('focus', () => {
            element.classList.add('mobile-focus');
          });

          element.addEventListener('blur', () => {
            element.classList.remove('mobile-focus');
          });
        });
      }

      // Initialize all mobile features on DOM ready
      initializeMobileFeatures();
      addMobileClasses();
      improveMobileAccessibility();

      // Expose mobile functions globally
      window.showMobileMenu = showMobileMenu;
      window.hideMobileMenu = hideMobileMenu;
      window.toggleMobileMenu = toggleMobileMenu;
      window.optimizeForMobile = optimizeForMobile;
      window.handleResize = handleResize;

      // User Management Functions
      function toggleUserMenu() {
        const menu = document.getElementById('user-menu');
        if (menu) {
          menu.classList.toggle('hidden');
        }
      }

      function showUserProfile() {
        document.getElementById('user-profile-modal').classList.remove('hidden');
        toggleUserMenu();
      }

      function hideUserProfile() {
        document.getElementById('user-profile-modal').classList.add('hidden');
      }

      function saveUserProfile() {
        const name = document.getElementById('profile-name').value;
        const email = document.getElementById('profile-email').value;
        const department = document.getElementById('profile-department').value;
        const phone = document.getElementById('profile-phone').value;

        // Update UI elements
        document.getElementById('user-name').textContent = name;
        document.getElementById('menu-user-name').textContent = name;
        document.getElementById('menu-user-email').textContent = email;

        // Update avatar initials
        const initials = name.split('').slice(0, 2).join('').toUpperCase();
        document.getElementById('user-avatar').textContent = initials;

        // Save to localStorage
        localStorage.setItem('userProfile', JSON.stringify({
          name, email, department, phone
        }));

        showNotification('个人资料已更新', 'success');
        hideUserProfile();
      }

      function showUserSettings() {
        document.getElementById('user-settings-modal').classList.remove('hidden');
        toggleUserMenu();
      }

      function hideUserSettings() {
        document.getElementById('user-settings-modal').classList.add('hidden');
      }

      function saveUserSettings() {
        // Get all settings
        const settings = {
          animations: document.querySelector('input[value="animations"]').checked,
          tooltips: document.querySelector('input[value="tooltips"]').checked,
          autoSave: document.querySelector('input[value="autoSave"]').checked,
          emailNotifications: document.querySelector('input[value="emailNotifications"]').checked,
          systemNotifications: document.querySelector('input[value="systemNotifications"]').checked,
          projectUpdates: document.querySelector('input[value="projectUpdates"]').checked
        };

        // Save to localStorage
        localStorage.setItem('userSettings', JSON.stringify(settings));

        // Apply settings
        if (!settings.animations) {
          document.body.classList.add('no-animations');
        } else {
          document.body.classList.remove('no-animations');
        }

        showNotification('设置已保存', 'success');
        hideUserSettings();
      }

      function showUserPermissions() {
        document.getElementById('user-permissions-modal').classList.remove('hidden');
        toggleUserMenu();
      }

      function hideUserPermissions() {
        document.getElementById('user-permissions-modal').classList.add('hidden');
      }

      function showTeamManagement() {
        document.getElementById('team-management-modal').classList.remove('hidden');
        toggleUserMenu();
      }

      function hideTeamManagement() {
        document.getElementById('team-management-modal').classList.add('hidden');
      }

      function showAddTeamMember() {
        // Implementation for adding team member
        showNotification('添加团队成员功能开发中', 'info');
      }

      function showSystemAdmin() {
        // Implementation for system admin
        showNotification('系统管理功能开发中', 'info');
        toggleUserMenu();
      }

      function showHelp() {
        // Implementation for help center
        showNotification('帮助中心功能开发中', 'info');
        toggleUserMenu();
      }

      function logout() {
        if (confirm('确定要退出登录吗？')) {
          // Clear user data
          localStorage.removeItem('userProfile');
          localStorage.removeItem('userSettings');
          localStorage.removeItem('authToken');

          showNotification('已成功退出登录', 'success');

          // Redirect to login page (in real app)
          setTimeout(() => {
            window.location.reload();
          }, 1500);
        }
        toggleUserMenu();
      }

      // User Authentication and Authorization
      class UserManager {
        constructor() {
          this.currentUser = this.loadCurrentUser();
          this.permissions = this.loadPermissions();
        }

        loadCurrentUser() {
          const savedProfile = localStorage.getItem('userProfile');
          if (savedProfile) {
            return JSON.parse(savedProfile);
          }

          // Default user
          return {
            name: '项目经理',
            email: 'pm@company.com',
            role: 'admin',
            avatar: 'PM'
          };
        }

        loadPermissions() {
          const userRole = this.currentUser.role;
          const rolePermissions = {
            admin: ['project.create', 'project.edit', 'project.delete', 'project.approve', 'user.manage', 'system.config', 'data.export'],
            manager: ['project.create', 'project.edit', 'project.approve', 'team.manage', 'data.export'],
            user: ['project.view', 'project.edit', 'data.export'],
            viewer: ['project.view']
          };

          return rolePermissions[userRole] || [];
        }

        hasPermission(permission) {
          return this.permissions.includes(permission);
        }

        updateUserProfile(userData) {
          this.currentUser = { ...this.currentUser, ...userData };
          localStorage.setItem('userProfile', JSON.stringify(this.currentUser));
          this.updateUI();
        }

        updateUI() {
          // Update all UI elements with user data
          const nameElements = document.querySelectorAll('[id*="user-name"], [id*="menu-user-name"]');
          const emailElements = document.querySelectorAll('[id*="user-email"], [id*="menu-user-email"]');
          const avatarElements = document.querySelectorAll('[id*="user-avatar"]');

          nameElements.forEach(el => el.textContent = this.currentUser.name);
          emailElements.forEach(el => el.textContent = this.currentUser.email);
          avatarElements.forEach(el => {
            const initials = this.currentUser.name.split('').slice(0, 2).join('').toUpperCase();
            el.textContent = initials;
          });
        }

        checkAccess(requiredPermission) {
          if (!this.hasPermission(requiredPermission)) {
            showNotification('您没有权限执行此操作', 'error');
            return false;
          }
          return true;
        }
      }

      // Initialize User Manager
      const userManager = new UserManager();

      // Close dropdowns when clicking outside
      document.addEventListener('click', (e) => {
        const userMenu = document.getElementById('user-menu');
        const userButton = e.target.closest('button[onclick="toggleUserMenu()"]');

        if (!userButton && !userMenu.contains(e.target)) {
          userMenu.classList.add('hidden');
        }
      });

      // Load user settings on startup
      function loadUserSettings() {
        const settings = localStorage.getItem('userSettings');
        if (settings) {
          const parsedSettings = JSON.parse(settings);

          // Apply animation settings
          if (!parsedSettings.animations) {
            document.body.classList.add('no-animations');
          }

          // Apply other settings as needed
        }
      }

      // Initialize user settings
      loadUserSettings();

      // Bank System Functions
      function switchModule(moduleName) {
        // Update active menu item
        document.querySelectorAll('.bank-menu-item').forEach(item => {
          item.classList.remove('active');
        });
        event.currentTarget.classList.add('active');

        // Update module title and breadcrumb
        updateModuleHeader(moduleName);

        // Load module content
        loadModuleContent(moduleName);
      }

      function updateModuleHeader(moduleName) {
        const moduleTitles = {
          'dashboard': '工作台',
          'project': '项目管理',
          'sow': 'SOW管理',
          'wbs': 'WBS分解',
          'cost': '成本估算',
          'risk': '风险评估',
          'report': '报告生成',
          'template': '模板管理',
          'settings': '系统设置'
        };

        const breadcrumbPaths = {
          'dashboard': '首页 / 工作台',
          'project': '首页 / 项目管理',
          'sow': '首页 / SOW管理',
          'wbs': '首页 / WBS分解',
          'cost': '首页 / 成本估算',
          'risk': '首页 / 风险评估',
          'report': '首页 / 报告生成',
          'template': '首页 / 模板管理',
          'settings': '首页 / 系统设置'
        };

        document.getElementById('module-title').textContent = moduleTitles[moduleName] || '未知模块';
        document.getElementById('breadcrumb-path').textContent = breadcrumbPaths[moduleName] || '首页';
      }

      function loadModuleContent(moduleName) {
        const mainContent = document.getElementById('main-content');

        // Hide all module contents
        document.querySelectorAll('.module-content').forEach(content => {
          content.style.display = 'none';
        });

        let content = '';

        switch(moduleName) {
          case 'project':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7M12,7A1,1 0 0,1 13,8A1,1 0 0,1 12,9A1,1 0 0,1 11,8A1,1 0 0,1 12,7M12,11A1,1 0 0,1 13,12A1,1 0 0,1 12,13A1,1 0 0,1 11,12A1,1 0 0,1 12,11M12,15A1,1 0 0,1 13,16A1,1 0 0,1 12,17A1,1 0 0,1 11,16A1,1 0 0,1 12,15Z"/>
                    </svg>
                    监管报送项目实施管理
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="createNewRegulatoryProject()">新建项目</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="importProjectTemplate()">导入模板</button>
                  </div>
                </div>

                <!-- 项目统计概览 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; margin-bottom: 24px;">
                  <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">进行中项目</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">12</div>
                    <div style="font-size: 12px; opacity: 0.8;">本月新增 3 个</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">总投入成本</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">¥2,450万</div>
                    <div style="font-size: 12px; opacity: 0.8;">涉及 8 家银行</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">平均工期</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">6.5月</div>
                    <div style="font-size: 12px; opacity: 0.8;">符合监管要求</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">合规通过率</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">98.5%</div>
                    <div style="font-size: 12px; opacity: 0.8;">高于行业平均</div>
                  </div>
                </div>

                <!-- 项目筛选 -->
                <div style="display: flex; gap: 12px; margin-bottom: 20px; align-items: center;">
                  <select class="bank-form-select" style="width: 160px;">
                    <option>全部状态</option>
                    <option>规划中</option>
                    <option>实施中</option>
                    <option>测试中</option>
                    <option>已上线</option>
                    <option>已验收</option>
                  </select>
                  <select class="bank-form-select" style="width: 160px;">
                    <option>全部类型</option>
                    <option>EAST报送</option>
                    <option>1104报表</option>
                    <option>反洗钱</option>
                    <option>大额交易</option>
                    <option>客户信息</option>
                  </select>
                  <select class="bank-form-select" style="width: 160px;">
                    <option>全部机构</option>
                    <option>国有银行</option>
                    <option>股份制银行</option>
                    <option>城商行</option>
                    <option>农商行</option>
                    <option>外资银行</option>
                  </select>
                  <div style="flex: 1;">
                    <input type="text" placeholder="搜索项目名称、客户..." class="bank-form-input" style="width: 100%;">
                  </div>
                </div>
              </div>

              <!-- 项目列表 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">项目执行进度</div>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <button class="bank-btn-ghost bank-btn-sm">
                      <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H13V7H15V5H17V9H19V11H17V9H15Z"/>
                      </svg>
                    </button>
                    <button class="bank-btn-ghost bank-btn-sm">
                      <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,12L10,16H14L12,12Z"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <table class="bank-table">
                  <thead>
                    <tr>
                      <th>项目名称</th>
                      <th>客户机构</th>
                      <th>报送类型</th>
                      <th>项目周期</th>
                      <th>当前进度</th>
                      <th>项目经理</th>
                      <th>预算/实际</th>
                      <th>状态</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 8px; height: 8px; background: var(--bank-success); border-radius: 50%;"></div>
                          <span style="font-weight: 500;">EAST5.0监管报送系统建设</span>
                        </div>
                      </td>
                      <td>某国有大行</td>
                      <td><span class="bank-badge bank-badge-info">EAST5.0</span></td>
                      <td>2024.01-2024.08</td>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                            <div style="width: 75%; height: 100%; background: var(--bank-success); border-radius: 2px;"></div>
                          </div>
                          <span style="font-size: 12px; color: var(--bank-text-secondary);">75%</span>
                        </div>
                      </td>
                      <td>张经理</td>
                      <td>
                        <div style="font-size: 12px;">
                          <div>¥680万</div>
                          <div style="color: var(--bank-text-secondary);">¥510万</div>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-success">实施中</span></td>
                      <td>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="viewProjectDetail(1)">详情</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="editProject(1)">编辑</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 8px; height: 8px; background: var(--bank-warning); border-radius: 50%;"></div>
                          <span style="font-weight: 500;">1104监管报表系统升级</span>
                        </div>
                      </td>
                      <td>某股份制银行</td>
                      <td><span class="bank-badge bank-badge-warning">1104</span></td>
                      <td>2024.03-2024.06</td>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                            <div style="width: 45%; height: 100%; background: var(--bank-warning); border-radius: 2px;"></div>
                          </div>
                          <span style="font-size: 12px; color: var(--bank-text-secondary);">45%</span>
                        </div>
                      </td>
                      <td>李经理</td>
                      <td>
                        <div style="font-size: 12px;">
                          <div>¥320万</div>
                          <div style="color: var(--bank-text-secondary);">¥180万</div>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-warning">测试中</span></td>
                      <td>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="viewProjectDetail(2)">详情</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="editProject(2)">编辑</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                          <span style="font-weight: 500;">反洗钱监测系统优化</span>
                        </div>
                      </td>
                      <td>某城商行</td>
                      <td><span class="bank-badge bank-badge-primary">AML</span></td>
                      <td>2024.02-2024.05</td>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                            <div style="width: 90%; height: 100%; background: var(--bank-primary); border-radius: 2px;"></div>
                          </div>
                          <span style="font-size: 12px; color: var(--bank-text-secondary);">90%</span>
                        </div>
                      </td>
                      <td>王经理</td>
                      <td>
                        <div style="font-size: 12px;">
                          <div>¥280万</div>
                          <div style="color: var(--bank-text-secondary);">¥260万</div>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-primary">已上线</span></td>
                      <td>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="viewProjectDetail(3)">详情</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="editProject(3)">编辑</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 8px; height: 8px; background: var(--bank-danger); border-radius: 50%;"></div>
                          <span style="font-weight: 500;">大额交易可疑交易报送系统</span>
                        </div>
                      </td>
                      <td>某农商行</td>
                      <td><span class="bank-badge bank-badge-danger">大额/可疑</span></td>
                      <td>2024.04-2024.07</td>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                            <div style="width: 15%; height: 100%; background: var(--bank-danger); border-radius: 2px;"></div>
                          </div>
                          <span style="font-size: 12px; color: var(--bank-text-secondary);">15%</span>
                        </div>
                      </td>
                      <td>赵经理</td>
                      <td>
                        <div style="font-size: 12px;">
                          <div>¥450万</div>
                          <div style="color: var(--bank-text-secondary);">¥80万</div>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-danger">延期风险</span></td>
                      <td>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="viewProjectDetail(4)">详情</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="editProject(4)">编辑</button>
                      </td>
                    </tr>
                  </tbody>
                </table>

                <!-- 分页 -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--bank-border);">
                  <div style="font-size: 14px; color: var(--bank-text-secondary);">
                    显示 1-10 条，共 42 条记录
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-secondary bank-btn-sm">上一页</button>
                    <button class="bank-btn-primary bank-btn-sm">1</button>
                    <button class="bank-btn-ghost bank-btn-sm">2</button>
                    <button class="bank-btn-ghost bank-btn-sm">3</button>
                    <button class="bank-btn-ghost bank-btn-sm">下一页</button>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'sow':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                    </svg>
                    监管报送SOW文档管理
                  </div>
                  <button class="bank-btn-primary bank-btn-sm" onclick="uploadSOW()">上传文档</button>
                </div>

                <div class="bank-form">
                  <div class="bank-form-group">
                    <label class="bank-form-label required">SOW文档上传</label>
                    <div style="border: 2px dashed var(--bank-border); border-radius: 8px; padding: 40px; text-align: center; background: #f8fafc;">
                      <svg width="48" height="48" fill="var(--bank-text-secondary)" viewBox="0 0 24 24" style="margin: 0 auto 16px;">
                        <path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"/>
                      </svg>
                      <div style="font-size: 16px; color: var(--bank-text-primary); margin-bottom: 8px;">点击或拖拽监管报送SOW文档到此处上传</div>
                      <div style="font-size: 14px; color: var(--bank-text-secondary);">支持 .doc, .docx, .pdf 格式，文件大小不超过 50MB</div>
                      <input type="file" id="sow-file-input" accept=".doc,.docx,.pdf" style="display: none;" onchange="handleSOWFileSelect(event)">
                    </div>
                  </div>

                  <!-- 文档分类选项 -->
                  <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-top: 20px;">
                    <div class="bank-form-group">
                      <label class="bank-form-label">报送类型</label>
                      <select class="bank-form-select">
                        <option value="">请选择报送类型</option>
                        <option value="east5">EAST5.0报送</option>
                        <option value="1104">1104监管报表</option>
                        <option value="aml">反洗钱AML</option>
                        <option value="large-transaction">大额交易报送</option>
                        <option value="suspicious-transaction">可疑交易报送</option>
                        <option value="customer-info">客户信息报送</option>
                        <option value="account-info">账户信息报送</option>
                        <option value="other">其他监管报送</option>
                      </select>
                    </div>
                    <div class="bank-form-group">
                      <label class="bank-form-label">监管机构</label>
                      <select class="bank-form-select">
                        <option value="">请选择监管机构</option>
                        <option value="pbc">人民银行</option>
                        <option value="cbirc">银保监会</option>
                        <option value="csrc">证监会</option>
                        <option value="safe">外汇管理局</option>
                        <option value="other">其他监管机构</option>
                      </select>
                    </div>
                    <div class="bank-form-group">
                      <label class="bank-form-label">银行类型</label>
                      <select class="bank-form-select">
                        <option value="">请选择银行类型</option>
                        <option value="state-owned">国有银行</option>
                        <option value="joint-stock">股份制银行</option>
                        <option value="city-commercial">城商行</option>
                        <option value="rural-commercial">农商行</option>
                        <option value="foreign">外资银行</option>
                        <option value="other">其他金融机构</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">已上传SOW文档</div>
                  <div style="display: flex; gap: 8px;">
                    <select class="bank-form-select bank-btn-sm">
                      <option>全部类型</option>
                      <option>EAST5.0</option>
                      <option>1104报表</option>
                      <option>反洗钱</option>
                    </select>
                    <input type="text" placeholder="搜索文档..." class="bank-form-input bank-btn-sm" style="width: 200px;">
                  </div>
                </div>

                <table class="bank-table">
                  <thead>
                    <tr>
                      <th>文档名称</th>
                      <th>报送类型</th>
                      <th>监管机构</th>
                      <th>上传时间</th>
                      <th>文件大小</th>
                      <th>解析状态</th>
                      <th>最后分析</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#dc2626" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>EAST5.0监管数据报送系统建设项目SOW</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-info">EAST5.0</span></td>
                      <td>银保监会</td>
                      <td>2024-01-15 14:30</td>
                      <td>2.8 MB</td>
                      <td><span class="bank-badge bank-badge-success">解析完成</span></td>
                      <td>2024-01-15 15:45</td>
                      <td>
                        <button class="bank-btn-primary bank-btn-sm" onclick="analyzeSOW(1)">智能分析</button>
                        <button class="bank-btn-secondary bank-btn-sm" onclick="downloadSOW(1)">下载</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="deleteSOW(1)">删除</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#2563eb" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>1104监管报表系统升级改造需求书</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-warning">1104</span></td>
                      <td>人民银行</td>
                      <td>2024-01-14 09:15</td>
                      <td>1.5 MB</td>
                      <td><span class="bank-badge bank-badge-warning">解析中</span></td>
                      <td>-</td>
                      <td>
                        <button class="bank-btn-secondary bank-btn-sm" disabled>智能分析</button>
                        <button class="bank-btn-secondary bank-btn-sm" onclick="downloadSOW(2)">下载</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="deleteSOW(2)">删除</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#059669" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>反洗钱监测系统优化项目工作说明书</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-primary">AML</span></td>
                      <td>人民银行</td>
                      <td>2024-01-13 16:22</td>
                      <td>3.2 MB</td>
                      <td><span class="bank-badge bank-badge-success">解析完成</span></td>
                      <td>2024-01-13 17:30</td>
                      <td>
                        <button class="bank-btn-primary bank-btn-sm" onclick="analyzeSOW(3)">重新分析</button>
                        <button class="bank-btn-secondary bank-btn-sm" onclick="downloadSOW(3)">下载</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="deleteSOW(3)">删除</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#7c3aed" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>大额交易和可疑交易报告系统建设SOW</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-danger">大额/可疑</span></td>
                      <td>人民银行</td>
                      <td>2024-01-12 11:45</td>
                      <td>2.1 MB</td>
                      <td><span class="bank-badge bank-badge-success">解析完成</span></td>
                      <td>2024-01-12 13:20</td>
                      <td>
                        <button class="bank-btn-primary bank-btn-sm" onclick="analyzeSOW(4)">重新分析</button>
                        <button class="bank-btn-secondary bank-btn-sm" onclick="downloadSOW(4)">下载</button>
                        <button class="bank-btn-ghost bank-btn-sm" onclick="deleteSOW(4)">删除</button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            `;
            break;
          case 'wbs':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M3,3H11V11H3V3M13,3H21V11H13V3M3,13H11V21H3V13M13,13H21V21H13V13Z"/>
                    </svg>
                    监管报送项目WBS智能分解
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="generateRegulatoryWBS()">智能生成WBS</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="importWBSTemplate()">导入模板</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="exportWBS()">导出</button>
                  </div>
                </div>

                <!-- WBS配置 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                  <div class="bank-form-group">
                    <label class="bank-form-label">报送类型</label>
                    <select class="bank-form-select" id="wbs-report-type">
                      <option value="east5">EAST5.0报送</option>
                      <option value="1104">1104监管报表</option>
                      <option value="aml">反洗钱AML</option>
                      <option value="large-transaction">大额交易报送</option>
                      <option value="suspicious-transaction">可疑交易报送</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">项目规模</label>
                    <select class="bank-form-select" id="wbs-project-scale">
                      <option value="small">小型 (300万以下)</option>
                      <option value="medium" selected>中型 (300-800万)</option>
                      <option value="large">大型 (800万以上)</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">工期要求</label>
                    <select class="bank-form-select" id="wbs-timeline">
                      <option value="tight">紧张 (3个月内)</option>
                      <option value="normal" selected>正常 (3-6个月)</option>
                      <option value="relaxed">宽松 (6个月以上)</option>
                    </select>
                  </div>
                </div>

                <!-- WBS层级结构 -->
                <div style="background: #f8fafc; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                  <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
                    <div style="width: 12px; height: 12px; background: var(--bank-success); border-radius: 50%;"></div>
                    <span style="font-weight: 600; font-size: 16px;">监管报送系统实施工作分解结构</span>
                    <span style="margin-left: auto; font-size: 14px; color: var(--bank-text-secondary);">总计: 1,240人天</span>
                  </div>

                  <!-- 第一层级：主要阶段 -->
                  <div style="margin-left: 20px;">
                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">1. 项目启动与规划阶段 (3周，120人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(1)">展开</button>
                      </div>

                      <!-- 第二层级：子任务 -->
                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-1">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">1.1 项目立项与审批 (20人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">项目经理</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">1.2 监管要求深度调研 (40人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">业务顾问</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">1.3 项目团队组建 (30人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">人力资源</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">1.4 实施方案制定 (30人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">架构师</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">2. 监管需求分析与设计 (4周，160人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(2)">展开</button>
                      </div>

                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-2">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-warning); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">2.1 监管制度解析 (50人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">合规专家</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-warning); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">2.2 报送规则梳理 (40人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">业务顾问</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-warning); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">2.3 数据模型设计 (70人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">数据架构师</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">3. 系统开发与集成 (8周，400人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(3)">展开</button>
                      </div>

                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-3">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-info); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">3.1 数据采集模块开发 (120人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">后端团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-info); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">3.2 数据校验引擎开发 (100人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">开发团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-info); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">3.3 报表生成模块开发 (80人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">前端团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-info); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">3.4 监管接口集成 (100人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">集成团队</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">4. 测试与合规验证 (6周，240人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(4)">展开</button>
                      </div>

                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-4">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-danger); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">4.1 功能测试 (80人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">测试团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-danger); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">4.2 监管合规性测试 (100人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">合规团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-danger); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">4.3 性能压力测试 (60人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">性能团队</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">5. 上线部署与培训 (3周，120人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(5)">展开</button>
                      </div>

                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-5">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">5.1 生产环境部署 (40人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">运维团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">5.2 用户培训与文档 (50人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">培训团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-success); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">5.3 试运行支持 (30人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">支持团队</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div style="margin-bottom: 16px;">
                      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <div style="width: 8px; height: 8px; background: var(--bank-primary); border-radius: 50%;"></div>
                        <span style="font-weight: 500;">6. 验收与交付 (2周，80人天)</span>
                        <button class="bank-btn-ghost bank-btn-sm" style="margin-left: auto; font-size: 12px;" onclick="expandWBS(6)">展开</button>
                      </div>

                      <div style="margin-left: 20px; margin-top: 8px; display: none;" id="wbs-level-6">
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-primary); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">6.1 监管机构验收 (40人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">项目经理</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-primary); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">6.2 项目文档交付 (20人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">文档团队</span>
                          </div>
                        </div>
                        <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 6px;">
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 6px; height: 6px; background: var(--bank-primary); border-radius: 50%;"></div>
                            <span style="font-size: 14px;">6.3 项目交接 (20人天)</span>
                            <span style="margin-left: auto; font-size: 12px; color: var(--bank-text-secondary);">交付团队</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- WBS甘特图预览 -->
                <div style="background: white; border: 1px solid var(--bank-border); border-radius: 8px; padding: 20px;">
                  <h4 style="margin-bottom: 16px; font-weight: 600;">项目工期甘特图</h4>
                  <div style="height: 200px; background: #f8fafc; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                    <div style="text-align: center; color: var(--bank-text-secondary);">
                      <svg width="48" height="48" fill="currentColor" viewBox="0 0 24 24" style="margin: 0 auto 12px; opacity: 0.3;">
                        <path d="M2,2H8V8H2V16H8V22H2V20H22V22H16V16H22V8H16V2H22V4H10V2H16V8H10V2M8,8V16H2V8H8M16,8V16H22V8H16M16,16V22H10V16H16M8,22V16H10V22H8Z"/>
                      </svg>
                      <div>甘特图生成中...</div>
                      <div style="font-size: 12px; margin-top: 4px;">点击"智能生成WBS"查看完整项目计划</div>
                    </div>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'cost':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>
                    </svg>
                    监管报送项目成本智能估算
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="calculateCost()">重新计算</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="exportCostReport()">导出报告</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="saveCostScenario()">保存方案</button>
                  </div>
                </div>

                <!-- 成本估算配置 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                  <div class="bank-form-group">
                    <label class="bank-form-label">报送类型</label>
                    <select class="bank-form-select" id="cost-report-type">
                      <option value="east5">EAST5.0报送</option>
                      <option value="1104">1104监管报表</option>
                      <option value="aml">反洗钱AML</option>
                      <option value="large-transaction">大额交易报送</option>
                      <option value="suspicious-transaction">可疑交易报送</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">银行规模</label>
                    <select class="bank-form-select" id="cost-bank-size">
                      <option value="large">大型银行 (总资产>5万亿)</option>
                      <option value="medium">中型银行 (总资产1-5万亿)</option>
                      <option value="small">小型银行 (总资产<1万亿)</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">复杂度等级</label>
                    <select class="bank-form-select" id="cost-complexity">
                      <option value="low">低复杂度</option>
                      <option value="medium" selected>中等复杂度</option>
                      <option value="high">高复杂度</option>
                      <option value="extreme">极高复杂度</option>
                    </select>
                  </div>
                </div>

                <!-- 成本概览 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px; margin-bottom: 24px;">
                  <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">项目总成本</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">¥680万</div>
                    <div style="font-size: 12px; opacity: 0.8;">基于历史数据分析</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">人天成本</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">¥2,450</div>
                    <div style="font-size: 12px; opacity: 0.8;">加权平均成本</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">项目工期</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">26周</div>
                    <div style="font-size: 12px; opacity: 0.8;">约6.5个月</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">团队规模</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">42人</div>
                    <div style="font-size: 12px; opacity: 0.8;">峰值人数</div>
                  </div>
                </div>
              </div>

              <!-- 成本构成分析 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">成本构成详细分析</div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-ghost bank-btn-sm" onclick="toggleCostView('chart')">图表视图</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="toggleCostView('table')">表格视图</button>
                  </div>
                </div>

                <!-- 成本分类饼图 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 16px; font-weight: 600;">按成本类型分布</h4>
                    <div style="height: 250px; background: white; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                      <div style="text-align: center;">
                        <svg width="64" height="64" fill="currentColor" viewBox="0 0 24 24" style="margin: 0 auto 12px; opacity: 0.3;">
                          <path d="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"/>
                        </svg>
                        <div style="color: var(--bank-text-secondary);">成本分布图表</div>
                      </div>
                    </div>
                    <div style="margin-top: 16px;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 2px;"></div>
                          <span style="font-size: 14px;">人力成本</span>
                        </div>
                        <span style="font-weight: 600;">¥476万 (70%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 12px; height: 12px; background: #10b981; border-radius: 2px;"></div>
                          <span style="font-size: 14px;">硬件设备</span>
                        </div>
                        <span style="font-weight: 600;">¥102万 (15%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 12px; height: 12px; background: #f59e0b; border-radius: 2px;"></div>
                          <span style="font-size: 14px;">软件许可</span>
                        </div>
                        <span style="font-weight: 600;">¥68万 (10%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <div style="width: 12px; height: 12px; background: #ef4444; border-radius: 2px;"></div>
                          <span style="font-size: 14px;">其他费用</span>
                        </div>
                        <span style="font-weight: 600;">¥34万 (5%)</span>
                      </div>
                    </div>
                  </div>

                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 16px; font-weight: 600;">按项目阶段分布</h4>
                    <div style="height: 250px; background: white; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                      <div style="text-align: center;">
                        <svg width="64" height="64" fill="currentColor" viewBox="0 0 24 24" style="margin: 0 auto 12px; opacity: 0.3;">
                          <path d="M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z"/>
                        </svg>
                        <div style="color: var(--bank-text-secondary);">阶段成本柱状图</div>
                      </div>
                    </div>
                    <div style="margin-top: 16px;">
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-size: 14px;">需求分析与设计</span>
                        <span style="font-weight: 600;">¥136万 (20%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-size: 14px;">系统开发与集成</span>
                        <span style="font-weight: 600;">¥340万 (50%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-size: 14px;">测试与合规验证</span>
                        <span style="font-weight: 600;">¥136万 (20%)</span>
                      </div>
                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 14px;">部署与培训</span>
                        <span style="font-weight: 600;">¥68万 (10%)</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 人力资源成本详细表 -->
                <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                  <h4 style="margin-bottom: 16px; font-weight: 600;">人力资源成本明细</h4>
                  <table class="bank-table">
                    <thead>
                      <tr>
                        <th>角色</th>
                        <th>人数</th>
                        <th>参与周期</th>
                        <th>人天单价</th>
                        <th>总人天</th>
                        <th>人力成本</th>
                        <th>成本占比</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>项目经理</td>
                        <td>2</td>
                        <td>全程 (26周)</td>
                        <td>¥3,500</td>
                        <td>260</td>
                        <td>¥91万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 19%; height: 100%; background: var(--bank-primary); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">19%</span>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>业务架构师</td>
                        <td>1</td>
                        <td>1-16周</td>
                        <td>¥4,000</td>
                        <td>80</td>
                        <td>¥32万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 7%; height: 100%; background: var(--bank-warning); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">7%</span>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>技术架构师</td>
                        <td>1</td>
                        <td>1-20周</td>
                        <td>¥4,200</td>
                        <td>100</td>
                        <td>¥42万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 9%; height: 100%; background: var(--bank-info); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">9%</span>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>高级开发工程师</td>
                        <td>8</td>
                        <td>5-22周</td>
                        <td>¥2,800</td>
                        <td>1,088</td>
                        <td>¥305万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 64%; height: 100%; background: var(--bank-success); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">64%</span>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>测试工程师</td>
                        <td>4</td>
                        <td>12-24周</td>
                        <td>¥2,000</td>
                        <td>192</td>
                        <td>¥38万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 8%; height: 100%; background: var(--bank-danger); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">8%</span>
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td>合规专家</td>
                        <td>1</td>
                        <td>2-18周</td>
                        <td>¥3,000</td>
                        <td>85</td>
                        <td>¥26万</td>
                        <td>
                          <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="flex: 1; height: 4px; background: var(--bank-border); border-radius: 2px;">
                              <div style="width: 5%; height: 100%; background: var(--bank-primary); border-radius: 2px;"></div>
                            </div>
                            <span style="font-size: 12px;">5%</span>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                    <tfoot>
                      <tr style="background: var(--bank-primary); color: white;">
                        <td colspan="4">总计</td>
                        <td><strong>1,805</strong></td>
                        <td><strong>¥534万</strong></td>
                        <td><strong>100%</strong></td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>

              <!-- 非人力成本 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">非人力成本估算</div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                  <div>
                    <h4 style="margin-bottom: 16px; font-weight: 600;">硬件设备成本</h4>
                    <table class="bank-table">
                      <thead>
                        <tr>
                          <th>设备类型</th>
                          <th>数量</th>
                          <th>单价</th>
                          <th>总价</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>应用服务器</td>
                          <td>4台</td>
                          <td>¥8万</td>
                          <td>¥32万</td>
                        </tr>
                        <tr>
                          <td>数据库服务器</td>
                          <td>2台</td>
                          <td>¥15万</td>
                          <td>¥30万</td>
                        </tr>
                        <tr>
                          <td>存储设备</td>
                          <td>1套</td>
                          <td>¥20万</td>
                          <td>¥20万</td>
                        </tr>
                        <tr>
                          <td>网络设备</td>
                          <td>1套</td>
                          <td>¥10万</td>
                          <td>¥10万</td>
                        </tr>
                        <tr>
                          <td>备份设备</td>
                          <td>1套</td>
                          <td>¥10万</td>
                          <td>¥10万</td>
                        </tr>
                      </tbody>
                      <tfoot>
                        <tr style="background: #f8fafc;">
                          <td colspan="3"><strong>小计</strong></td>
                          <td><strong>¥102万</strong></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>

                  <div>
                    <h4 style="margin-bottom: 16px; font-weight: 600;">软件许可及其他费用</h4>
                    <table class="bank-table">
                      <thead>
                        <tr>
                          <th>费用类型</th>
                          <th>说明</th>
                          <th>金额</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>数据库许可</td>
                          <td>Oracle企业版</td>
                          <td>¥25万</td>
                        </tr>
                        <tr>
                          <td>中间件许可</td>
                          <td>WebLogic集群</td>
                          <td>¥18万</td>
                        </tr>
                        <tr>
                          <td>监控工具</td>
                          <td>APM监控许可</td>
                          <td>¥12万</td>
                        </tr>
                        <tr>
                          <td>安全软件</td>
                          <td>漏洞扫描工具</td>
                          <td>¥8万</td>
                        </tr>
                        <tr>
                          <td>培训费用</td>
                          <td>用户培训及认证</td>
                          <td>¥5万</td>
                        </tr>
                        <tr>
                          <td>差旅费用</td>
                          <td>项目实施差旅</td>
                          <td>¥15万</td>
                        </tr>
                        <tr>
                          <td>备用金</td>
                          <td>风险备用金</td>
                          <td>¥23万</td>
                        </tr>
                      </tbody>
                      <tfoot>
                        <tr style="background: #f8fafc;">
                          <td colspan="2"><strong>小计</strong></td>
                          <td><strong>¥106万</strong></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'risk':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M12,2L15.09,8.26L22,9.27L17,14.14L18.18,21.02L12,17.77L5.82,21.02L7,14.14L2,9.27L8.91,8.26L12,2M12,4.31L9.86,8.84L4.93,9.47L8.62,13L7.63,17.88L12,15.54L16.37,17.88L15.38,13L19.07,9.47L14.14,8.84L12,4.31Z"/>
                    </svg>
                    监管报送项目风险评估
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="assessRisks()">重新评估</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="generateRiskReport()">生成报告</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="exportRiskMatrix()">导出矩阵</button>
                  </div>
                </div>

                <!-- 风险评估配置 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                  <div class="bank-form-group">
                    <label class="bank-form-label">报送类型</label>
                    <select class="bank-form-select" id="risk-report-type">
                      <option value="east5">EAST5.0报送</option>
                      <option value="1104">1104监管报表</option>
                      <option value="aml">反洗钱AML</option>
                      <option value="large-transaction">大额交易报送</option>
                      <option value="suspicious-transaction">可疑交易报送</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">风险偏好</label>
                    <select class="bank-form-select" id="risk-appetite">
                      <option value="conservative">保守型</option>
                      <option value="moderate" selected>稳健型</option>
                      <option value="aggressive">激进型</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">评估维度</label>
                    <select class="bank-form-select" id="risk-dimension">
                      <option value="comprehensive">综合评估</option>
                      <option value="technical">技术风险</option>
                      <option value="compliance">合规风险</option>
                      <option value="operational">运营风险</option>
                    </select>
                  </div>
                </div>

                <!-- 风险等级概览 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                  <div style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">高风险项</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">3</div>
                    <div style="font-size: 12px; opacity: 0.8;">需要立即处理</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">中风险项</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">7</div>
                    <div style="font-size: 12px; opacity: 0.8;">需要重点关注</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">低风险项</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">12</div>
                    <div style="font-size: 12px; opacity: 0.8;">定期监控即可</div>
                  </div>
                  <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 20px; border-radius: 12px;">
                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">风险评分</div>
                    <div style="font-size: 28px; font-weight: 700; margin-bottom: 4px;">68分</div>
                    <div style="font-size: 12px; opacity: 0.8;">中等风险水平</div>
                  </div>
                </div>
              </div>

              <!-- 风险矩阵 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">风险矩阵分析</div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-ghost bank-btn-sm" onclick="toggleRiskView('matrix')">矩阵视图</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="toggleRiskView('list')">列表视图</button>
                  </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                  <!-- 风险矩阵图 -->
                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 16px; font-weight: 600;">概率-影响矩阵</h4>
                    <div style="background: white; border-radius: 6px; padding: 16px;">
                      <!-- 5x5风险矩阵 -->
                      <div style="display: grid; grid-template-columns: 40px repeat(5, 1fr); gap: 2px; margin-bottom: 16px;">
                        <div></div>
                        <div style="text-align: center; font-size: 12px; font-weight: 600;">极低</div>
                        <div style="text-align: center; font-size: 12px; font-weight: 600;">低</div>
                        <div style="text-align: center; font-size: 12px; font-weight: 600;">中</div>
                        <div style="text-align: center; font-size: 12px; font-weight: 600;">高</div>
                        <div style="text-align: center; font-size: 12px; font-weight: 600;">极高</div>

                        <!-- 极高概率行 -->
                        <div style="text-align: center; font-size: 12px; font-weight: 600; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center;">极高</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px; position: relative;">
                          极高风险
                          <div style="position: absolute; top: 2px; right: 2px; width: 8px; height: 8px; background: white; border-radius: 50%; opacity: 0.8;"></div>
                        </div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px; position: relative;">
                          极高风险
                          <div style="position: absolute; top: 2px; right: 2px; width: 8px; height: 8px; background: white; border-radius: 50%; opacity: 0.8;"></div>
                        </div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>

                        <!-- 高概率行 -->
                        <div style="text-align: center; font-size: 12px; font-weight: 600; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center;">高</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px; position: relative;">
                          极高风险
                          <div style="position: absolute; top: 2px; right: 2px; width: 8px; height: 8px; background: white; border-radius: 50%; opacity: 0.8;"></div>
                        </div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>

                        <!-- 中概率行 -->
                        <div style="text-align: center; font-size: 12px; font-weight: 600; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center;">中</div>
                        <div style="background: #3b82f6; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">中风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px; position: relative;">
                          高风险
                          <div style="position: absolute; top: 2px; right: 2px; width: 8px; height: 8px; background: white; border-radius: 50%; opacity: 0.8;"></div>
                        </div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>

                        <!-- 低概率行 -->
                        <div style="text-align: center; font-size: 12px; font-weight: 600; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center;">低</div>
                        <div style="background: #10b981; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">低风险</div>
                        <div style="background: #3b82f6; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">中风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>

                        <!-- 极低概率行 -->
                        <div style="text-align: center; font-size: 12px; font-weight: 600; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center;">极低</div>
                        <div style="background: #10b981; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">低风险</div>
                        <div style="background: #10b981; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">低风险</div>
                        <div style="background: #3b82f6; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">中风险</div>
                        <div style="background: #f59e0b; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">高风险</div>
                        <div style="background: #dc2626; height: 40px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: white; font-size: 11px;">极高风险</div>
                      </div>

                      <!-- 图例 -->
                      <div style="display: flex; gap: 16px; justify-content: center; font-size: 12px;">
                        <div style="display: flex; align-items: center; gap: 4px;">
                          <div style="width: 12px; height: 12px; background: #10b981; border-radius: 2px;"></div>
                          <span>低风险</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 4px;">
                          <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 2px;"></div>
                          <span>中风险</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 4px;">
                          <div style="width: 12px; height: 12px; background: #f59e0b; border-radius: 2px;"></div>
                          <span>高风险</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 4px;">
                          <div style="width: 12px; height: 12px; background: #dc2626; border-radius: 2px;"></div>
                          <span>极高风险</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 4px;">
                          <div style="width: 12px; height: 12px; background: #dc2626; border-radius: 2px; position: relative;">
                            <div style="position: absolute; top: 1px; right: 1px; width: 4px; height: 4px; background: white; border-radius: 50%;"></div>
                          </div>
                          <span>存在风险项</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Top风险列表 -->
                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 16px; font-weight: 600;">Top 10 高风险项</h4>
                    <div style="background: white; border-radius: 6px; padding: 16px; max-height: 300px; overflow-y: auto;">
                      <div style="space-y: 12px;">
                        <div style="padding: 12px; background: #fef2f2; border-left: 4px solid #dc2626; border-radius: 4px; margin-bottom: 12px;">
                          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: #dc2626;">监管政策变化风险</div>
                            <span class="bank-badge bank-badge-danger" style="font-size: 10px;">极高风险</span>
                          </div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 8px;">
                            监管报送政策可能发生变化，影响系统设计和合规性要求
                          </div>
                          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 11px;">
                            <span>概率: 70% | 影响: 极高</span>
                            <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">制定对策</button>
                          </div>
                        </div>

                        <div style="padding: 12px; background: #fef2f2; border-left: 4px solid #dc2626; border-radius: 4px; margin-bottom: 12px;">
                          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: #dc2626;">上游系统数据质量风险</div>
                            <span class="bank-badge bank-badge-danger" style="font-size: 10px;">极高风险</span>
                          </div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 8px;">
                            33个上游系统数据质量参差不齐，可能影响报送准确率和及时性
                          </div>
                          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 11px;">
                            <span>概率: 80% | 影响: 极高</span>
                            <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">制定对策</button>
                          </div>
                        </div>

                        <div style="padding: 12px; background: #fef2f2; border-left: 4px solid #dc2626; border-radius: 4px; margin-bottom: 12px;">
                          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: #dc2626;">等保合规风险</div>
                            <span class="bank-badge bank-badge-danger" style="font-size: 10px;">极高风险</span>
                          </div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 8px;">
                            等保三级测评要求严格，安全整改可能影响项目进度和成本
                          </div>
                          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 11px;">
                            <span>概率: 60% | 影响: 极高</span>
                            <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">制定对策</button>
                          </div>
                        </div>

                        <div style="padding: 12px; background: #fffbeb; border-left: 4px solid #f59e0b; border-radius: 4px; margin-bottom: 12px;">
                          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: #d97706;">技术复杂度风险</div>
                            <span class="bank-badge bank-badge-warning" style="font-size: 10px;">高风险</span>
                          </div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 8px;">
                            15,886张元数据表映射复杂，技术债务累积可能影响后续维护
                          </div>
                          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 11px;">
                            <span>概率: 70% | 影响: 高</span>
                            <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">制定对策</button>
                          </div>
                        </div>

                        <div style="padding: 12px; background: #fffbeb; border-left: 4px solid #f59e0b; border-radius: 4px; margin-bottom: 12px;">
                          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: #d97706;">信创环境兼容风险</div>
                            <span class="bank-badge bank-badge-warning" style="font-size: 10px;">高风险</span>
                          </div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 8px;">
                            需支持麒麟V10+达梦8+东方通TongWeb7组合，兼容性测试工作量较大
                          </div>
                          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 11px;">
                            <span>概率: 50% | 影响: 高</span>
                            <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">制定对策</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'report':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z"/>
                    </svg>
                    监管报送项目评估报告生成
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="generateReport()">生成报告</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="previewReport()">预览</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="exportReport()">导出PDF</button>
                  </div>
                </div>

                <!-- 报告配置 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                  <div class="bank-form-group">
                    <label class="bank-form-label">报告类型</label>
                    <select class="bank-form-select" id="report-type">
                      <option value="comprehensive">综合评估报告</option>
                      <option value="feasibility">可行性分析报告</option>
                      <option value="technical">技术方案报告</option>
                      <option value="cost">成本估算报告</option>
                      <option value="risk">风险评估报告</option>
                      <option value="implementation">实施方案报告</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">报告模板</label>
                    <select class="bank-form-select" id="report-template">
                      <option value="standard">标准模板</option>
                      <option value="bank">银行专用模板</option>
                      <option value="regulator">监管机构模板</option>
                      <option value="executive">高管汇报模板</option>
                      <option value="technical">技术评审模板</option>
                    </select>
                  </div>
                  <div class="bank-form-group">
                    <label class="bank-form-label">报告格式</label>
                    <select class="bank-form-select" id="report-format">
                      <option value="word">Word文档</option>
                      <option value="pdf">PDF文档</option>
                      <option value="excel">Excel表格</option>
                      <option value="ppt">PPT演示</option>
                    </select>
                  </div>
                </div>

                <!-- 报告章节配置 -->
                <div style="background: #f8fafc; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                  <h4 style="margin-bottom: 16px; font-weight: 600;">报告章节配置</h4>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">项目概述与背景</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">监管要求分析</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">技术方案设计</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">项目实施计划</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">成本估算分析</span>
                      </label>
                    </div>
                    <div>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">风险评估与对策</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">资源投入计划</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">质量保证措施</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">合规性检查清单</span>
                      </label>
                      <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <input type="checkbox" checked style="width: 16px; height: 16px;">
                        <span style="font-size: 14px;">结论与建议</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 历史报告 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">历史报告记录</div>
                  <div style="display: flex; gap: 8px;">
                    <input type="text" placeholder="搜索报告..." class="bank-form-input bank-btn-sm" style="width: 200px;">
                    <select class="bank-form-select bank-btn-sm">
                      <option>全部类型</option>
                      <option>综合评估报告</option>
                      <option>可行性分析报告</option>
                      <option>技术方案报告</option>
                    </select>
                  </div>
                </div>

                <table class="bank-table">
                  <thead>
                    <tr>
                      <th>报告名称</th>
                      <th>报告类型</th>
                      <th>项目名称</th>
                      <th>生成时间</th>
                      <th>生成人</th>
                      <th>文件大小</th>
                      <th>状态</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#dc2626" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>EAST5.0监管报送系统项目综合评估报告</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-info">综合评估</span></td>
                      <td>EAST5.0监管报送系统建设项目</td>
                      <td>2024-01-15 16:30</td>
                      <td>张经理</td>
                      <td>2.8 MB</td>
                      <td><span class="bank-badge bank-badge-success">已完成</span></td>
                      <td>
                        <button class="bank-btn-primary bank-btn-sm">下载</button>
                        <button class="bank-btn-secondary bank-btn-sm">预览</button>
                        <button class="bank-btn-ghost bank-btn-sm">分享</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#2563eb" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>1104监管报表系统可行性分析报告</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-warning">可行性分析</span></td>
                      <td>1104监管报表系统升级项目</td>
                      <td>2024-01-14 11:20</td>
                      <td>李经理</td>
                      <td>1.5 MB</td>
                      <td><span class="bank-badge bank-badge-success">已完成</span></td>
                      <td>
                        <button class="bank-btn-primary bank-btn-sm">下载</button>
                        <button class="bank-btn-secondary bank-btn-sm">预览</button>
                        <button class="bank-btn-ghost bank-btn-sm">分享</button>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div style="display: flex; align-items: center; gap: 8px;">
                          <svg width="16" height="16" fill="#059669" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                          </svg>
                          <span>反洗钱监测系统成本估算详细报告</span>
                        </div>
                      </td>
                      <td><span class="bank-badge bank-badge-primary">成本估算</span></td>
                      <td>反洗钱监测系统优化项目</td>
                      <td>2024-01-13 09:45</td>
                      <td>王经理</td>
                      <td>3.2 MB</td>
                      <td><span class="bank-badge bank-badge-warning">生成中</span></td>
                      <td>
                        <button class="bank-btn-secondary bank-btn-sm" disabled>下载</button>
                        <button class="bank-btn-secondary bank-btn-sm" disabled>预览</button>
                        <button class="bank-btn-ghost bank-btn-sm">取消</button>
                      </td>
                    </tr>
                  </tbody>
                </table>

                <!-- 分页 -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--bank-border);">
                  <div style="font-size: 14px; color: var(--bank-text-secondary);">
                    显示 1-10 条，共 28 条记录
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-secondary bank-btn-sm">上一页</button>
                    <button class="bank-btn-primary bank-btn-sm">1</button>
                    <button class="bank-btn-ghost bank-btn-sm">2</button>
                    <button class="bank-btn-ghost bank-btn-sm">3</button>
                    <button class="bank-btn-ghost bank-btn-sm">下一页</button>
                  </div>
                </div>
              </div>

              <!-- 报告模板管理 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">报告模板管理</div>
                  <button class="bank-btn-primary bank-btn-sm" onclick="createReportTemplate()">新建模板</button>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 8px; padding: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                      <div>
                        <h4 style="margin-bottom: 4px; font-weight: 600;">银行监管报送综合评估模板</h4>
                        <p style="font-size: 12px; color: var(--bank-text-secondary);">适用于银行监管报送项目的综合评估</p>
                      </div>
                      <span class="bank-badge bank-badge-info">标准模板</span>
                    </div>
                    <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 12px;">
                      包含章节：项目概述、监管要求分析、技术方案、实施计划、成本估算、风险评估、质量保证、结论建议
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div style="font-size: 12px; color: var(--bank-text-secondary);">
                        使用次数：156 | 更新时间：2024-01-10
                      </div>
                      <div style="display: flex; gap: 4px;">
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">编辑</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">复制</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">使用</button>
                      </div>
                    </div>
                  </div>

                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 8px; padding: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                      <div>
                        <h4 style="margin-bottom: 4px; font-weight: 600;">监管机构验收专用模板</h4>
                        <p style="font-size: 12px; color: var(--bank-text-secondary);">专门用于监管机构项目验收汇报</p>
                      </div>
                      <span class="bank-badge bank-badge-warning">监管模板</span>
                    </div>
                    <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 12px;">
                      包含章节：合规性证明、测试结果、安全评估、数据质量、报送准确性、验收标准
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div style="font-size: 12px; color: var(--bank-text-secondary);">
                        使用次数：89 | 更新时间：2024-01-08
                      </div>
                      <div style="display: flex; gap: 4px;">
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">编辑</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">复制</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">使用</button>
                      </div>
                    </div>
                  </div>

                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 8px; padding: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                      <div>
                        <h4 style="margin-bottom: 4px; font-weight: 600;">高管汇报简版模板</h4>
                        <p style="font-size: 12px; color: var(--bank-text-secondary);">适用于向银行高管汇报的简化版本</p>
                      </div>
                      <span class="bank-badge bank-badge-primary">高管模板</span>
                    </div>
                    <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 12px;">
                      包含章节：执行摘要、关键指标、风险重点、资源需求、时间计划、预期收益
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div style="font-size: 12px; color: var(--bank-text-secondary);">
                        使用次数：67 | 更新时间：2024-01-12
                      </div>
                      <div style="display: flex; gap: 4px;">
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">编辑</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">复制</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">使用</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'template':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M4,6H2V20A2,2 0 0,0 4,22H18V20H4M18,7H15V13.5C15,14.33 14.33,15 13.5,15C12.67,15 12,14.33 12,13.5S12.67,12 13.5,12C13.7,12 13.89,12.04 14.06,12.09L16.5,9.65C15.79,8.88 14.69,8.4 13.5,8.4C11,8.4 9,10.4 9,12.9C9,15.4 11,17.4 13.5,17.4C16,17.4 18,15.4 18,12.9V7M20,2H8A2,2 0 0,0 6,4V16A2,2 0 0,0 8,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M20,16H8V4H20V16Z"/>
                    </svg>
                    监管报送项目模板库
                  </div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-primary bank-btn-sm" onclick="createTemplate()">创建模板</button>
                    <button class="bank-btn-secondary bank-btn-sm" onclick="importTemplate()">导入模板</button>
                    <button class="bank-btn-ghost bank-btn-sm" onclick="exportTemplates()">批量导出</button>
                  </div>
                </div>

                <!-- 模板分类筛选 -->
                <div style="display: flex; gap: 12px; margin-bottom: 20px; align-items: center;">
                  <select class="bank-form-select" style="width: 160px;">
                    <option>全部类型</option>
                    <option>EAST报送模板</option>
                    <option>1104报表模板</option>
                    <option>反洗钱模板</option>
                    <option>大额交易模板</option>
                    <option>通用模板</option>
                  </select>
                  <select class="bank-form-select" style="width: 160px;">
                    <option>全部规模</option>
                    <option>大型项目</option>
                    <option>中型项目</option>
                    <option>小型项目</option>
                  </select>
                  <select class="bank-form-select" style="width: 160px;">
                    <option>银行类型</option>
                    <option>国有银行</option>
                    <option>股份制银行</option>
                    <option>城商行</option>
                    <option>农商行</option>
                  </select>
                  <div style="flex: 1;">
                    <input type="text" placeholder="搜索模板..." class="bank-form-input" style="width: 100%;">
                  </div>
                </div>
              </div>

              <!-- 模板库展示 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">推荐模板</div>
                  <div style="display: flex; gap: 8px;">
                    <button class="bank-btn-ghost bank-btn-sm">
                      <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.8C8.5,18.5 7.96,18.13 7.44,17.7L4.83,18.64C4.6,18.71 4.35,18.65 4.21,18.46L2.21,15.04C2.07,14.85 2.09,14.59 2.28,14.42L4.42,12.54C4.38,12.24 4.38,11.76 4.42,11.46L2.28,9.58C2.09,9.41 2.07,9.15 2.21,8.96L4.21,5.54C4.35,5.35 4.6,5.29 4.83,5.36L7.44,6.3C7.96,5.87 8.5,5.5 9.13,5.2L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.2C15.5,5.5 16.04,5.87 16.56,6.3L19.17,5.36C19.4,5.29 19.65,5.35 19.79,5.54L21.79,8.96C21.93,9.15 21.91,9.41 21.72,9.58L19.58,11.46C19.62,11.76 19.62,12.24 19.58,12.54L21.72,14.42C21.91,14.59 21.93,14.85 21.79,15.04L19.79,18.46C19.65,18.65 19.4,18.71 19.17,18.64L16.56,17.7C16.04,18.13 15.5,18.5 14.87,18.8L14.5,21.58C14.46,21.82 14.25,22 14,22H10Z"/>
                      </svg>
                    </button>
                    <button class="bank-btn-ghost bank-btn-sm">
                      <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H13V7H15V5H17V9H19V11H17V9H15Z"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px;">
                  <!-- EAST5.0报送模板 -->
                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 12px; overflow: hidden; transition: all 0.3s ease;">
                    <div style="background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); padding: 20px; color: white;">
                      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                        <div style="width: 12px; height: 12px; background: white; border-radius: 50%; opacity: 0.9;"></div>
                        <span style="font-size: 18px; font-weight: 700;">EAST5.0监管报送系统</span>
                      </div>
                      <p style="font-size: 14px; opacity: 0.9;">适用于大型银行EAST5.0监管数据报送系统建设项目</p>
                    </div>
                    <div style="padding: 20px;">
                      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">项目周期</div>
                          <div style="font-weight: 600;">24-30周</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">预算范围</div>
                          <div style="font-weight: 600;">600-900万</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">团队规模</div>
                          <div style="font-weight: 600;">35-50人</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">复杂度</div>
                          <div style="font-weight: 600;">高</div>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">主要特性</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">70张监管报表</span>
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">33个上游系统</span>
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">15K+元数据表</span>
                          <span class="bank-badge bank-badge-warning" style="font-size: 10px;">等保三级</span>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">适用银行</div>
                        <div style="font-size: 13px;">国有大型银行、股份制银行</div>
                      </div>

                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary);">
                          使用次数：186
                        </div>
                        <div style="display: flex; gap: 8px;">
                          <button class="bank-btn-secondary bank-btn-sm" style="font-size: 12px;">查看详情</button>
                          <button class="bank-btn-primary bank-btn-sm" style="font-size: 12px;">使用模板</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 1104监管报表模板 -->
                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 12px; overflow: hidden; transition: all 0.3s ease;">
                    <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 20px; color: white;">
                      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                        <div style="width: 12px; height: 12px; background: white; border-radius: 50%; opacity: 0.9;"></div>
                        <span style="font-size: 18px; font-weight: 700;">1104监管报表系统</span>
                      </div>
                      <p style="font-size: 14px; opacity: 0.9;">适用于人民银行1104监管报表系统建设项目</p>
                    </div>
                    <div style="padding: 20px;">
                      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">项目周期</div>
                          <div style="font-weight: 600;">16-20周</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">预算范围</div>
                          <div style="font-weight: 600;">200-400万</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">团队规模</div>
                          <div style="font-weight: 600;">20-30人</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">复杂度</div>
                          <div style="font-weight: 600;">中</div>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">主要特性</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                          <span class="bank-badge bank-badge-success" style="font-size: 10px;">15张基础报表</span>
                          <span class="bank-badge bank-badge-success" style="font-size: 10px;">12张业务报表</span>
                          <span class="bank-badge bank-badge-warning" style="font-size: 10px;">月度报送</span>
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">统一监管报送</span>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">适用银行</div>
                        <div style="font-size: 13px;">各类商业银行、政策性银行</div>
                      </div>

                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary);">
                          使用次数：124
                        </div>
                        <div style="display: flex; gap: 8px;">
                          <button class="bank-btn-secondary bank-btn-sm" style="font-size: 12px;">查看详情</button>
                          <button class="bank-btn-primary bank-btn-sm" style="font-size: 12px;">使用模板</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 反洗钱系统模板 -->
                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 12px; overflow: hidden; transition: all 0.3s ease;">
                    <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 20px; color: white;">
                      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                        <div style="width: 12px; height: 12px; background: white; border-radius: 50%; opacity: 0.9;"></div>
                        <span style="font-size: 18px; font-weight: 700;">反洗钱监测系统</span>
                      </div>
                      <p style="font-size: 14px; opacity: 0.9;">适用于反洗钱监测分析和报送系统建设项目</p>
                    </div>
                    <div style="padding: 20px;">
                      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">项目周期</div>
                          <div style="font-weight: 600;">20-28周</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">预算范围</div>
                          <div style="font-weight: 600;">300-600万</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">团队规模</div>
                          <div style="font-weight: 600;">25-40人</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">复杂度</div>
                          <div style="font-weight: 600;">中高</div>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">主要特性</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                          <span class="bank-badge bank-badge-warning" style="font-size: 10px;">可疑交易监测</span>
                          <span class="bank-badge bank-badge-warning" style="font-size: 10px;">大额交易跟踪</span>
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">风险评级</span>
                          <span class="bank-badge bank-badge-success" style="font-size: 10px;">自动报送</span>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">适用银行</div>
                        <div style="font-size: 13px;">所有开展反洗钱业务的金融机构</div>
                      </div>

                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary);">
                          使用次数：98
                        </div>
                        <div style="display: flex; gap: 8px;">
                          <button class="bank-btn-secondary bank-btn-sm" style="font-size: 12px;">查看详情</button>
                          <button class="bank-btn-primary bank-btn-sm" style="font-size: 12px;">使用模板</button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- 大额交易报送模板 -->
                  <div style="background: white; border: 1px solid var(--bank-border); border-radius: 12px; overflow: hidden; transition: all 0.3s ease;">
                    <div style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); padding: 20px; color: white;">
                      <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                        <div style="width: 12px; height: 12px; background: white; border-radius: 50%; opacity: 0.9;"></div>
                        <span style="font-size: 18px; font-weight: 700;">大额交易报送系统</span>
                      </div>
                      <p style="font-size: 14px; opacity: 0.9;">适用于大额交易和可疑交易报告系统建设项目</p>
                    </div>
                    <div style="padding: 20px;">
                      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">项目周期</div>
                          <div style="font-weight: 600;">12-16周</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">预算范围</div>
                          <div style="font-weight: 600;">150-300万</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">团队规模</div>
                          <div style="font-weight: 600;">15-25人</div>
                        </div>
                        <div>
                          <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 4px;">复杂度</div>
                          <div style="font-weight: 600;">中</div>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">主要特性</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                          <span class="bank-badge bank-badge-primary" style="font-size: 10px;">5万以上监测</span>
                          <span class="bank-badge bank-badge-primary" style="font-size: 10px;">实时监控</span>
                          <span class="bank-badge bank-badge-success" style="font-size: 10px;">自动识别</span>
                          <span class="bank-badge bank-badge-info" style="font-size: 10px;">人行报送</span>
                        </div>
                      </div>

                      <div style="margin-bottom: 16px;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 6px;">适用银行</div>
                        <div style="font-size: 13px;">所有需要报送大额交易的银行机构</div>
                      </div>

                      <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 12px; color: var(--bank-text-secondary);">
                          使用次数：76
                        </div>
                        <div style="display: flex; gap: 8px;">
                          <button class="bank-btn-secondary bank-btn-sm" style="font-size: 12px;">查看详情</button>
                          <button class="bank-btn-primary bank-btn-sm" style="font-size: 12px;">使用模板</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- 自定义模板 -->
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">我的自定义模板</div>
                  <button class="bank-btn-primary bank-btn-sm" onclick="createCustomTemplate()">+ 创建模板</button>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                  <div style="background: #f8fafc; border: 1px solid var(--bank-border); border-radius: 8px; padding: 16px; border-left: 4px solid var(--bank-primary);">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                      <div>
                        <h4 style="margin-bottom: 4px; font-weight: 600;">某城商行EAST5.0定制模板</h4>
                        <p style="font-size: 12px; color: var(--bank-text-secondary);">基于城商行特点优化的EAST5.0报送模板</p>
                      </div>
                      <span class="bank-badge bank-badge-primary" style="font-size: 10px;">私有</span>
                    </div>
                    <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 12px;">
                      调整内容：简化元数据映射、优化数据采集流程、适配城商行组织架构
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div style="font-size: 12px; color: var(--bank-text-secondary);">
                        创建时间：2024-01-10
                      </div>
                      <div style="display: flex; gap: 4px;">
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">编辑</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">复制</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">删除</button>
                      </div>
                    </div>
                  </div>

                  <div style="background: #f8fafc; border: 1px solid var(--bank-border); border-radius: 8px; padding: 16px; border-left: 4px solid var(--bank-success);">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                      <div>
                        <h4 style="margin-bottom: 4px; font-weight: 600;">股份制银行AML快速实施模板</h4>
                        <p style="font-size: 12px; color: var(--bank-text-secondary);">针对股份制银行的快速AML部署方案</p>
                      </div>
                      <span class="bank-badge bank-badge-success" style="font-size: 10px;">私有</span>
                    </div>
                    <div style="font-size: 12px; color: var(--bank-text-secondary); margin-bottom: 12px;">
                      调整内容：压缩实施周期、采用敏捷开发、重点保障核心功能
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <div style="font-size: 12px; color: var(--bank-text-secondary);">
                        创建时间：2024-01-08
                      </div>
                      <div style="display: flex; gap: 4px;">
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">编辑</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">复制</button>
                        <button class="bank-btn-ghost bank-btn-sm" style="font-size: 10px;">删除</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            `;
            break;
          case 'settings':
            content = `
              <div class="bank-card">
                <div class="bank-card-header">
                  <div class="bank-card-title">
                    <svg width="16" height="16" fill="var(--bank-primary)" viewBox="0 0 24 24">
                      <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                    </svg>
                    系统设置
                  </div>
                  <button class="bank-btn-primary bank-btn-sm" onclick="saveSettings()">保存设置</button>
                </div>

                <!-- 基本设置 -->
                <div style="margin-bottom: 32px;">
                  <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 600; color: var(--bank-text-primary);">基本设置</h3>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">系统名称</label>
                        <input type="text" class="bank-form-input" value="监管报送产品实施项目评估系统">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">机构名称</label>
                        <input type="text" class="bank-form-input" placeholder="请输入您的机构名称">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">默认银行类型</label>
                        <select class="bank-form-select">
                          <option>国有银行</option>
                          <option>股份制银行</option>
                          <option>城商行</option>
                          <option>农商行</option>
                          <option>外资银行</option>
                        </select>
                      </div>
                    </div>
                    <div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">系统管理员</label>
                        <input type="text" class="bank-form-input" placeholder="系统管理员姓名">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">联系邮箱</label>
                        <input type="email" class="bank-form-input" placeholder="admin@bank.com">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">系统时区</label>
                        <select class="bank-form-select">
                          <option>北京时间 (GMT+8)</option>
                          <option>东京时间 (GMT+9)</option>
                          <option>伦敦时间 (GMT+0)</option>
                          <option>纽约时间 (GMT-5)</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 评估参数设置 -->
                <div style="margin-bottom: 32px;">
                  <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 600; color: var(--bank-text-primary);">评估参数设置</h3>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">人天成本基准 (元)</label>
                        <input type="number" class="bank-form-input" value="2500">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">项目经理单价 (元/人天)</label>
                        <input type="number" class="bank-form-input" value="3500">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">高级工程师单价 (元/人天)</label>
                        <input type="number" class="bank-form-input" value="2800">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">测试工程师单价 (元/人天)</label>
                        <input type="number" class="bank-form-input" value="2000">
                      </div>
                    </div>
                    <div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">风险系数 (%)</label>
                        <input type="number" class="bank-form-input" value="15" min="0" max="50">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">利润系数 (%)</label>
                        <input type="number" class="bank-form-input" value="20" min="0" max="50">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">默认项目周期 (周)</label>
                        <input type="number" class="bank-form-input" value="24" min="4" max="52">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">团队规模系数</label>
                        <input type="number" class="bank-form-input" value="1.2" min="0.5" max="3" step="0.1">
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 监管报送设置 -->
                <div style="margin-bottom: 32px;">
                  <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 600; color: var(--bank-text-primary);">监管报送设置</h3>
                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                      <div>
                        <h4 style="margin-bottom: 16px; font-weight: 600;">报送类型配置</h4>
                        <div style="space-y: 12px;">
                          <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用EAST5.0报送</span>
                          </label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用1104监管报表</span>
                          </label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用反洗钱报送</span>
                          </label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用大额交易报送</span>
                          </label>
                        </div>
                      </div>
                      <div>
                        <h4 style="margin-bottom: 16px; font-weight: 600;">合规标准</h4>
                        <div class="bank-form-group">
                          <label class="bank-form-label">等保要求等级</label>
                          <select class="bank-form-select">
                            <option>等保二级</option>
                            <option selected>等保三级</option>
                            <option>等保四级</option>
                          </select>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">数据报送频率</label>
                          <select class="bank-form-select">
                            <option>实时</option>
                            <option selected>每日</option>
                            <option>每周</option>
                            <option>每月</option>
                          </select>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">监管机构</label>
                          <select class="bank-form-select">
                            <option selected>人民银行</option>
                            <option>银保监会</option>
                            <option>证监会</option>
                            <option>外汇管理局</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 通知设置 -->
                <div style="margin-bottom: 32px;">
                  <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 600; color: var(--bank-text-primary);">通知设置</h3>
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <div>
                      <h4 style="margin-bottom: 16px; font-weight: 600;">邮件通知</h4>
                      <div style="space-y: 12px;">
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                          <input type="checkbox" checked style="width: 16px; height: 16px;">
                          <span style="font-size: 14px;">项目完成通知</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                          <input type="checkbox" checked style="width: 16px; height: 16px;">
                          <span style="font-size: 14px;">风险预警通知</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                          <input type="checkbox" style="width: 16px; height: 16px;">
                          <span style="font-size: 14px;">报告生成通知</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                          <input type="checkbox" checked style="width: 16px; height: 16px;">
                          <span style="font-size: 14px;">系统维护通知</span>
                        </label>
                      </div>
                    </div>
                    <div>
                      <h4 style="margin-bottom: 16px; font-weight: 600;">系统通知</h4>
                      <div class="bank-form-group">
                        <label class="bank-form-label">SMTP服务器</label>
                        <input type="text" class="bank-form-input" placeholder="smtp.bank.com">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">发送邮箱</label>
                        <input type="email" class="bank-form-input" placeholder="system@bank.com">
                      </div>
                      <div class="bank-form-group">
                        <label class="bank-form-label">邮箱密码</label>
                        <input type="password" class="bank-form-input" placeholder="••••••••">
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 数据备份设置 -->
                <div style="margin-bottom: 32px;">
                  <h3 style="margin-bottom: 20px; font-size: 18px; font-weight: 600; color: var(--bank-text-primary);">数据备份设置</h3>
                  <div style="background: #f8fafc; border-radius: 8px; padding: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                      <div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">自动备份频率</label>
                          <select class="bank-form-select">
                            <option>每日</option>
                            <option selected>每周</option>
                            <option>每月</option>
                            <option>手动</option>
                          </select>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">备份保留时间</label>
                          <select class="bank-form-select">
                            <option>30天</option>
                            <option selected>90天</option>
                            <option>180天</option>
                            <option>365天</option>
                          </select>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">备份存储位置</label>
                          <input type="text" class="bank-form-input" value="/backup/regulatory-system">
                        </div>
                      </div>
                      <div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">数据库备份</label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用数据库自动备份</span>
                          </label>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">文件备份</label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">启用SOW文档备份</span>
                          </label>
                        </div>
                        <div class="bank-form-group">
                          <label class="bank-form-label">备份压缩</label>
                          <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <input type="checkbox" checked style="width: 16px; height: 16px;">
                            <span style="font-size: 14px;">压缩备份文件以节省空间</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 操作按钮 -->
                <div style="display: flex; gap: 12px; justify-content: flex-end; padding-top: 20px; border-top: 1px solid var(--bank-border);">
                  <button class="bank-btn-secondary">重置默认</button>
                  <button class="bank-btn-secondary">导出配置</button>
                  <button class="bank-btn-primary">保存设置</button>
                </div>
              </div>
            `;
            break;
        }

        if (content) {
          // Create or update module content
          let moduleDiv = document.getElementById(\`${moduleName}-content\`);
          if (!moduleDiv) {
            moduleDiv = document.createElement('div');
            moduleDiv.id = \`${moduleName}-content\`;
            moduleDiv.className = 'module-content';
            mainContent.appendChild(moduleDiv);
          }
          moduleDiv.innerHTML = content;
          moduleDiv.style.display = 'block';
        }
      }

      function uploadSOW() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.doc,.docx,.pdf';
        input.onchange = handleSOWFileSelect;
        input.click();
      }

      function handleSOWFileSelect(event) {
        const file = event.target.files[0];
        if (file) {
          showNotification(\`已选择文件: \${file.name}\`, 'success');
        }
      }

      // Initialize bank system
      console.log('EAST5.0银行级系统已初始化');

      // Expose user management functions globally
      window.toggleUserMenu = toggleUserMenu;
      window.showUserProfile = showUserProfile;
      window.hideUserProfile = hideUserProfile;
      window.saveUserProfile = saveUserProfile;
      window.showUserSettings = showUserSettings;
      window.hideUserSettings = hideUserSettings;
      window.saveUserSettings = saveUserSettings;
      window.showUserPermissions = showUserPermissions;
      window.hideUserPermissions = hideUserPermissions;
      window.showTeamManagement = showTeamManagement;
      window.hideTeamManagement = hideTeamManagement;
      window.showAddTeamMember = showAddTeamMember;
      window.showSystemAdmin = showSystemAdmin;
      window.showHelp = showHelp;
      window.logout = logout;
      window.userManager = userManager;

      // Expose bank system functions globally
      window.switchModule = switchModule;
      window.uploadSOW = uploadSOW;
      window.handleSOWFileSelect = handleSOWFileSelect;

      // 监管报送项目相关功能
      window.createNewRegulatoryProject = createNewRegulatoryProject;
      window.viewProjectDetail = viewProjectDetail;
      window.editProject = editProject;
      window.analyzeSOW = analyzeSOW;
      window.downloadSOW = downloadSOW;
      window.deleteSOW = deleteSOW;
      window.generateRegulatoryWBS = generateRegulatoryWBS;
      window.expandWBS = expandWBS;
      window.calculateCost = calculateCost;
      window.assessRisks = assessRisks;
      window.generateReport = generateReport;
      window.previewReport = previewReport;
      window.exportReport = exportReport;
      window.createTemplate = createTemplate;
      window.saveSettings = saveSettings;

      // 通知系统
      window.showNotification = showNotification;
      window.hideNotification = hideNotification;
    });

    // ============ 功能实现函数 ============

    // 创建新的监管报送项目
    function createNewRegulatoryProject() {
      const modal = document.createElement('div');
      modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
      modal.innerHTML = `
        <div class="bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto">
          <div class="p-6 border-b">
            <h3 class="text-xl font-semibold">创建监管报送项目</h3>
          </div>
          <div class="p-6">
            <form class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">项目名称</label>
                <input type="text" id="reg-project-name" class="form-input" placeholder="例如：EAST5.0监管报送系统建设项目">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">报送类型</label>
                <select id="reg-project-type" class="form-input">
                  <option value="east5">EAST5.0报送</option>
                  <option value="1104">1104监管报表</option>
                  <option value="aml">反洗钱AML</option>
                  <option value="large-transaction">大额交易报送</option>
                  <option value="suspicious-transaction">可疑交易报送</option>
                  <option value="customer-info">客户信息报送</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">银行类型</label>
                <select id="reg-bank-type" class="form-input">
                  <option value="state-owned">国有银行</option>
                  <option value="joint-stock">股份制银行</option>
                  <option value="city-commercial">城商行</option>
                  <option value="rural-commercial">农商行</option>
                  <option value="foreign">外资银行</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">预算范围（万元）</label>
                <input type="number" id="reg-budget" class="form-input" placeholder="例如：680">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">项目周期（周）</label>
                <input type="number" id="reg-duration" class="form-input" placeholder="例如：26">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">项目描述</label>
                <textarea id="reg-description" class="form-input h-20 resize-none" placeholder="项目详细描述..."></textarea>
              </div>
            </form>
          </div>
          <div class="p-6 border-t flex justify-end space-x-4">
            <button onclick="this.closest('.fixed').remove()" class="btn btn-secondary">取消</button>
            <button onclick="submitRegulatoryProject()" class="btn btn-primary">创建项目</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    // 提交监管报送项目
    function submitRegulatoryProject() {
      const projectData = {
        name: document.getElementById('reg-project-name').value,
        type: document.getElementById('reg-project-type').value,
        bankType: document.getElementById('reg-bank-type').value,
        budget: document.getElementById('reg-budget').value,
        duration: document.getElementById('reg-duration').value,
        description: document.getElementById('reg-description').value
      };

      // 验证必填字段
      if (!projectData.name || !projectData.budget || !projectData.duration) {
        showNotification('请填写所有必填字段', 'error');
        return;
      }

      // 模拟保存项目
      showNotification(`项目"${projectData.name}"创建成功！`, 'success');
      document.querySelector('.fixed').remove();

      // 切换到项目管理页面
      switchModule('project');
    }

    // 查看项目详情
    function viewProjectDetail(projectId) {
      showNotification(`查看项目ID: ${projectId} 的详细信息`, 'info');
      // 这里可以打开项目详情模态框
    }

    // 编辑项目
    function editProject(projectId) {
      showNotification(`编辑项目ID: ${projectId}`, 'info');
      // 这里可以打开编辑项目模态框
    }

    // 分析SOW文档
    function analyzeSOW(sowId) {
      showNotification(`正在分析SOW文档 ID: ${sowId}`, 'info');
      // 模拟分析过程
      setTimeout(() => {
        showNotification('SOW文档分析完成！', 'success');
        switchModule('wbs');
      }, 2000);
    }

    // 下载SOW文档
    function downloadSOW(sowId) {
      showNotification(`开始下载SOW文档 ID: ${sowId}`, 'info');
    }

    // 删除SOW文档
    function deleteSOW(sowId) {
      if (confirm('确定要删除这个SOW文档吗？')) {
        showNotification(`SOW文档 ID: ${sowId} 已删除`, 'success');
      }
    }

    // 生成监管报送WBS
    function generateRegulatoryWBS() {
      showNotification('正在生成监管报送项目WBS...', 'info');
      // 模拟生成过程
      setTimeout(() => {
        showNotification('WBS生成完成！', 'success');
      }, 1500);
    }

    // 展开WBS节点
    function expandWBS(level) {
      const levelDiv = document.getElementById(`wbs-level-${level}`);
      if (levelDiv) {
        levelDiv.style.display = levelDiv.style.display === 'none' ? 'block' : 'none';
      }
    }

    // 计算成本
    function calculateCost() {
      showNotification('正在重新计算项目成本...', 'info');
      setTimeout(() => {
        showNotification('成本计算完成！', 'success');
      }, 1000);
    }

    // 评估风险
    function assessRisks() {
      showNotification('正在进行风险评估...', 'info');
      setTimeout(() => {
        showNotification('风险评估完成！', 'success');
      }, 1200);
    }

    // 生成报告
    function generateReport() {
      showNotification('正在生成评估报告...', 'info');
      setTimeout(() => {
        showNotification('报告生成完成！', 'success');
      }, 2000);
    }

    // 预览报告
    function previewReport() {
      showNotification('正在生成报告预览...', 'info');
      setTimeout(() => {
        showNotification('报告预览已准备就绪！', 'success');
        // 这里可以打开报告预览窗口
      }, 1500);
    }

    // 导出报告
    function exportReport() {
      showNotification('正在导出PDF报告...', 'info');
      setTimeout(() => {
        showNotification('PDF报告导出成功！', 'success');
      }, 1800);
    }

    // 创建模板
    function createTemplate() {
      showNotification('正在打开模板创建器...', 'info');
    }

    // 保存设置
    function saveSettings() {
      showNotification('正在保存系统设置...', 'info');
      setTimeout(() => {
        showNotification('设置保存成功！', 'success');
      }, 800);
    }

    // 通知系统
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification-toast');
      const title = document.getElementById('notification-title');
      const msg = document.getElementById('notification-message');

      // 设置标题和消息
      const titles = {
        'success': '操作成功',
        'error': '操作失败',
        'info': '系统提示',
        'warning': '警告'
      };

      title.textContent = titles[type] || '系统通知';
      msg.textContent = message;

      // 设置边框颜色
      notification.className = `fixed top-4 right-4 bg-white rounded-lg shadow-lg p-4 border-l-4 transform transition-transform duration-300 z-50`;

      if (type === 'success') {
        notification.classList.add('border-green-500');
      } else if (type === 'error') {
        notification.classList.add('border-red-500');
      } else if (type === 'warning') {
        notification.classList.add('border-yellow-500');
      } else {
        notification.classList.add('border-blue-500');
      }

      // 显示通知
      notification.classList.remove('translate-x-full');

      // 3秒后自动隐藏
      setTimeout(() => {
        hideNotification();
      }, 3000);
    }

    function hideNotification() {
      const notification = document.getElementById('notification-toast');
      notification.classList.add('translate-x-full');
    }

    // 模拟实时数据更新
    function initializeRealTimeData() {
      // 更新统计数据
      setInterval(() => {
        const totalProjects = document.getElementById('total-projects');
        if (totalProjects) {
          const currentCount = parseInt(totalProjects.textContent);
          if (Math.random() > 0.9) {
            totalProjects.textContent = currentCount + 1;
            showNotification('有新的项目创建', 'info');
          }
        }
      }, 30000);

      // 更新通知
      setInterval(() => {
        const notifications = [
          '监管政策更新：EAST5.0报送规范新增3张报表',
          '项目提醒：EAST5.0监管报送系统项目需要今日完成周报',
          '系统通知：成本估算算法已更新',
          '合规提醒：1104监管报表月度报送截止日临近',
          '系统维护：计划于今晚22:00进行系统升级'
        ];

        if (Math.random() > 0.8) {
          const randomNotification = notifications[Math.floor(Math.random() * notifications.length)];
          showNotification(randomNotification, 'info');
        }
      }, 45000);
    }

    // 初始化实时数据
    initializeRealTimeData();

    // 页面加载完成后的初始化
    console.log('监管报送产品实施项目评估系统已加载完成');
    console.log('✅ 所有模块功能已就绪');
    console.log('✅ 实时数据监控已启动');
  </script>

  <!-- Collaboration Modals -->
  <!-- Chat Modal -->
  <div id="chat-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center h-full p-4">
      <div class="bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col">
        <div class="flex items-center justify-between p-4 border-b">
          <h3 class="text-lg font-semibold">团队协作聊天</h3>
          <button onclick="toggleChat()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="flex-1 overflow-y-auto p-4 space-y-4" id="chat-messages">
          <!-- Messages will be populated here -->
        </div>
        <div class="p-4 border-t">
          <div class="flex space-x-2">
            <input type="text" id="chat-input" placeholder="输入消息..." class="flex-1 form-input">
            <button onclick="sendMessage()" class="btn btn-primary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Comments Panel -->
  <div id="comments-panel" class="fixed right-0 top-0 h-full w-96 bg-white shadow-xl z-40 transform translate-x-full transition-transform duration-300">
    <div class="flex flex-col h-full">
      <div class="flex items-center justify-between p-4 border-b">
        <h3 class="text-lg font-semibold">评论与反馈</h3>
        <button onclick="toggleComments()" class="text-gray-400 hover:text-gray-600">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="flex-1 overflow-y-auto p-4 space-y-4" id="comments-list">
        <!-- Comments will be populated here -->
      </div>
      <div class="p-4 border-t">
        <textarea id="comment-input" placeholder="添加评论..." class="w-full form-input h-20 resize-none"></textarea>
        <button onclick="addComment()" class="btn btn-primary w-full mt-2">发布评论</button>
      </div>
    </div>
  </div>

  <!-- Version History Modal -->
  <div id="version-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center h-full p-4">
      <div class="bg-white rounded-lg w-full max-w-3xl max-h-[80vh] flex flex-col">
        <div class="flex items-center justify-between p-4 border-b">
          <h3 class="text-lg font-semibold">版本历史</h3>
          <button onclick="toggleVersionHistory()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="flex-1 overflow-y-auto p-4">
          <div class="space-y-4" id="version-list">
            <!-- Version history will be populated here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Real-time Cursor Indicators -->
  <div id="cursor-indicators" class="fixed inset-0 pointer-events-none z-30">
    <!-- Real-time cursors will be shown here -->
  </div>

  <!-- Notification Toast -->
  <div id="notification-toast" class="fixed top-4 right-4 bg-white rounded-lg shadow-lg p-4 border-l-4 border-blue-500 transform translate-x-full transition-transform duration-300 z-50">
    <div class="flex items-center">
      <div class="flex-1">
        <h4 class="font-semibold" id="notification-title">系统通知</h4>
        <p class="text-sm text-gray-600" id="notification-message">消息内容</p>
      </div>
      <button onclick="hideNotification()" class="ml-4 text-gray-400 hover:text-gray-600">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Project Templates Modal -->
  <div id="templates-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center h-full p-4">
      <div class="bg-white rounded-lg w-full max-w-5xl max-h-[90vh] flex flex-col">
        <div class="flex items-center justify-between p-6 border-b">
          <h3 class="text-xl font-semibold">项目模板库</h3>
          <button onclick="hideProjectTemplates()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="flex-1 overflow-y-auto p-6">
          <!-- Template Categories -->
          <div class="mb-6">
            <div class="flex items-center space-x-4 mb-4">
              <button class="px-4 py-2 bg-blue-500 text-white rounded-lg" onclick="filterTemplates('all')">全部</button>
              <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300" onclick="filterTemplates('banking')">银行业</button>
              <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300" onclick="filterTemplates('insurance')">保险业</button>
              <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300" onclick="filterTemplates('securities')">证券业</button>
              <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300" onclick="filterTemplates('it')">IT系统</button>
            </div>
          </div>

          <!-- Template Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="templates-grid">
            <!-- Templates will be populated by JavaScript -->
          </div>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-between items-center">
            <div class="flex space-x-4">
              <button onclick="createCustomTemplate()" class="btn btn-secondary">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2h2.828a2 2 0 01-2.828-2.828l-8.586 8.586z"></path>
                </svg>
                创建自定义模板
              </button>
            </div>
            <button onclick="hideProjectTemplates()" class="btn btn-secondary">关闭</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- New Project Modal -->
  <div id="new-project-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center h-full p-4">
      <div class="bg-white rounded-lg w-full max-w-2xl max-h-[90vh] flex flex-col">
        <div class="flex items-center justify-between p-6 border-b">
          <h3 class="text-xl font-semibold">创建新项目</h3>
          <button onclick="hideNewProjectModal()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="flex-1 overflow-y-auto p-6">
          <form id="new-project-form" class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目名称</label>
              <input type="text" id="project-name" class="form-input" placeholder="输入项目名称">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目描述</label>
              <textarea id="project-description" class="form-input h-20 resize-none" placeholder="输入项目描述"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目类型</label>
              <select id="project-type" class="form-input">
                <option value="">选择项目类型</option>
                <option value="banking">银行业项目</option>
                <option value="insurance">保险业项目</option>
                <option value="securities">证券业项目</option>
                <option value="it">IT系统项目</option>
                <option value="other">其他项目</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">预算范围</label>
              <select id="budget-range" class="form-input">
                <option value="">选择预算范围</option>
                <option value="0-100">100万以下</option>
                <option value="100-500">100-500万</option>
                <option value="500-1000">500-1000万</option>
                <option value="1000-5000">1000-5000万</option>
                <option value="5000+">5000万以上</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">项目周期</label>
              <select id="project-duration" class="form-input">
                <option value="">选择项目周期</option>
                <option value="1-3">1-3个月</option>
                <option value="3-6">3-6个月</option>
                <option value="6-12">6-12个月</option>
                <option value="12-24">1-2年</option>
                <option value="24+">2年以上</option>
              </select>
            </div>
          </form>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-end space-x-4">
            <button onclick="hideNewProjectModal()" class="btn btn-secondary">取消</button>
            <button onclick="createProject()" class="btn btn-primary">创建项目</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Floating Action Button -->
  <button class="fab mobile-hidden" onclick="showMobileMenu()" data-tooltip="菜单">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
    </svg>
  </button>

  <!-- Mobile Navigation Menu -->
  <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-50 z-50 mobile-hidden" onclick="hideMobileMenu()">
    <div class="absolute right-0 top-0 h-full w-80 bg-white shadow-xl" onclick="event.stopPropagation()">
      <div class="p-6 border-b">
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold">项目菜单</h3>
          <button onclick="hideMobileMenu()" class="btn btn-ghost p-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>

      <div class="p-6 space-y-6">
        <!-- Project Actions -->
        <div>
          <h4 class="text-sm font-semibold text-gray-700 mb-3">项目操作</h4>
          <div class="space-y-2">
            <button class="btn btn-primary w-full btn-mobile-full" onclick="createNewProject(); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              新建项目
            </button>
            <button class="btn btn-secondary w-full btn-mobile-full" onclick="showProjectTemplates(); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
              </svg>
              项目模板
            </button>
          </div>
        </div>

        <!-- Evaluation Steps -->
        <div>
          <h4 class="text-sm font-semibold text-gray-700 mb-3">评估步骤</h4>
          <nav class="space-y-2">
            <div class="nav-item active" onclick="switchStep('upload'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
              </svg>
              <span>SOW文档上传</span>
            </div>
            <div class="nav-item" onclick="switchStep('analysis'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
              <span>智能解析分析</span>
            </div>
            <div class="nav-item" onclick="switchStep('wbs'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
              </svg>
              <span>WBS分解</span>
            </div>
            <div class="nav-item" onclick="switchStep('estimation'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
              </svg>
              <span>成本估算</span>
            </div>
            <div class="nav-item" onclick="switchStep('risk'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L5.268 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
              </svg>
              <span>风险评估</span>
            </div>
            <div class="nav-item" onclick="switchStep('report'); hideMobileMenu();">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v1a2 2 0 002 2h2a2 2 0 002-2v-1m6-10V5a2 2 0 00-2-2H7a2 2 0 00-2 2v2m12 0v10a2 2 0 01-2 2H7a2 2 0 01-2-2V7"></path>
              </svg>
              <span>报告生成</span>
            </div>
          </nav>
        </div>

        <!-- Recent Projects -->
        <div>
          <h4 class="text-sm font-semibold text-gray-700 mb-3">最近项目</h4>
          <div class="space-y-2">
            <div class="p-3 bg-gray-50 rounded-lg">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium text-sm">EAST5.0监管报送</p>
                  <p class="text-xs text-gray-500">2小时前</p>
                </div>
                <span class="badge badge-success">进行中</span>
              </div>
            </div>
            <div class="p-3 bg-gray-50 rounded-lg">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium text-sm">1104报表系统</p>
                  <p class="text-xs text-gray-500">1天前</p>
                </div>
                <span class="badge badge-warning">规划中</span>
              </div>
            </div>
            <div class="p-3 bg-gray-50 rounded-lg">
              <div class="flex items-center justify-between">
                <div>
                  <p class="font-medium text-sm">客户风险评级</p>
                  <p class="text-xs text-gray-500">3天前</p>
                </div>
                <span class="badge badge-info">已完成</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Stats -->
        <div>
          <h4 class="text-sm font-semibold text-gray-700 mb-3">快速统计</h4>
          <div class="grid grid-cols-2 gap-4">
            <div class="text-center p-3 bg-blue-50 rounded-lg">
              <p class="text-2xl font-bold text-blue-600">12</p>
              <p class="text-xs text-blue-600">总项目</p>
            </div>
            <div class="text-center p-3 bg-green-50 rounded-lg">
              <p class="text-2xl font-bold text-green-600">8</p>
              <p class="text-xs text-green-600">活跃中</p>
            </div>
            <div class="text-center p-3 bg-yellow-50 rounded-lg">
              <p class="text-2xl font-bold text-yellow-600">3</p>
              <p class="text-xs text-yellow-600">待审核</p>
            </div>
            <div class="text-center p-3 bg-purple-50 rounded-lg">
              <p class="text-2xl font-bold text-purple-600">24</p>
              <p class="text-xs text-purple-600">团队成员</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Management Modals -->

  <!-- User Profile Modal -->
  <div id="user-profile-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-lg shadow-xl max-w-md w-full modal-content">
        <div class="p-6 border-b">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">个人资料</h3>
            <button onclick="hideUserProfile()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6">
          <div class="text-center mb-6">
            <div class="w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl font-bold text-white">PM</span>
            </div>
            <h4 class="text-lg font-semibold">项目经理</h4>
            <p class="text-sm text-gray-500">pm@company.com</p>
          </div>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">姓名</label>
              <input type="text" value="项目经理" class="form-input" id="profile-name">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">邮箱</label>
              <input type="email" value="pm@company.com" class="form-input" id="profile-email">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">部门</label>
              <input type="text" value="项目管理部" class="form-input" id="profile-department">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">电话</label>
              <input type="tel" value="138-0000-0000" class="form-input" id="profile-phone">
            </div>
          </div>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-end space-x-4">
            <button onclick="hideUserProfile()" class="btn btn-secondary">取消</button>
            <button onclick="saveUserProfile()" class="btn btn-primary">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Settings Modal -->
  <div id="user-settings-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full modal-content">
        <div class="p-6 border-b">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">用户设置</h3>
            <button onclick="hideUserSettings()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="text-md font-semibold mb-4">界面设置</h4>
              <div class="space-y-3">
                <label class="flex items-center">
                  <input type="checkbox" checked class="form-checkbox mr-2">
                  <span class="text-sm">启用动画效果</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked class="form-checkbox mr-2">
                  <span class="text-sm">显示工具提示</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked class="form-checkbox mr-2">
                  <span class="text-sm">自动保存</span>
                </label>
              </div>
            </div>
            <div>
              <h4 class="text-md font-semibold mb-4">通知设置</h4>
              <div class="space-y-3">
                <label class="flex items-center">
                  <input type="checkbox" checked class="form-checkbox mr-2">
                  <span class="text-sm">邮件通知</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked class="form-checkbox mr-2">
                  <span class="text-sm">系统通知</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" class="form-checkbox mr-2">
                  <span class="text-sm">项目更新提醒</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-end space-x-4">
            <button onclick="hideUserSettings()" class="btn btn-secondary">取消</button>
            <button onclick="saveUserSettings()" class="btn btn-primary">保存设置</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Permissions Modal -->
  <div id="user-permissions-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-lg shadow-xl max-w-3xl w-full modal-content">
        <div class="p-6 border-b">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">权限管理</h3>
            <button onclick="hideUserPermissions()" class="text-gray-400 hover:text-gray-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6">
          <div class="mb-6">
            <h4 class="text-md font-semibold mb-4">当前权限</h4>
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <div class="flex items-center mb-2">
                <svg class="w-5 h-5 text-blue-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="font-medium text-blue-900">管理员权限</span>
              </div>
              <p class="text-sm text-blue-800">拥有系统的完整管理权限，包括用户管理、项目审批、系统配置等</p>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="text-md font-semibold mb-4">功能权限</h4>
              <div class="space-y-3">
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">项目管理</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">用户管理</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">权限分配</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">系统配置</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">数据导出</span>
                </label>
              </div>
            </div>
            <div>
              <h4 class="text-md font-semibold mb-4">数据权限</h4>
              <div class="space-y-3">
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">查看所有项目</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">编辑所有项目</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">删除项目</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">审批项目</span>
                </label>
                <label class="flex items-center">
                  <input type="checkbox" checked disabled class="form-checkbox mr-2">
                  <span class="text-sm">查看报表</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-end space-x-4">
            <button onclick="hideUserPermissions()" class="btn btn-secondary">关闭</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Team Management Modal -->
  <div id="team-management-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full modal-content">
        <div class="p-6 border-b">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-semibold">团队管理</h3>
            <div class="flex items-center space-x-4">
              <button onclick="showAddTeamMember()" class="btn btn-primary btn-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                添加成员
              </button>
              <button onclick="hideTeamManagement()" class="text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div class="p-6">
          <div class="mb-6">
            <div class="flex items-center justify-between mb-4">
              <h4 class="text-md font-semibold">团队成员列表</h4>
              <div class="flex items-center space-x-2">
                <input type="text" placeholder="搜索成员..." class="form-input" style="width: 200px;">
                <select class="form-input" style="width: 150px;">
                  <option>全部角色</option>
                  <option>管理员</option>
                  <option>项目经理</option>
                  <option>技术负责人</option>
                  <option>开发人员</option>
                  <option>测试人员</option>
                </select>
              </div>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b">
                    <th class="text-left py-2">姓名</th>
                    <th class="text-left py-2">邮箱</th>
                    <th class="text-left py-2">角色</th>
                    <th class="text-left py-2">状态</th>
                    <th class="text-left py-2">加入时间</th>
                    <th class="text-left py-2">操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-b">
                    <td class="py-2">
                      <div class="flex items-center">
                        <div class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center mr-2">
                          <span class="text-xs text-white">PM</span>
                        </div>
                        项目经理
                      </div>
                    </td>
                    <td class="py-2">pm@company.com</td>
                    <td class="py-2"><span class="badge badge-primary">管理员</span></td>
                    <td class="py-2"><span class="badge badge-success">在线</span></td>
                    <td class="py-2">2023-01-15</td>
                    <td class="py-2">
                      <button class="text-blue-600 hover:text-blue-800 mr-2">编辑</button>
                      <button class="text-red-600 hover:text-red-800">删除</button>
                    </td>
                  </tr>
                  <tr class="border-b">
                    <td class="py-2">
                      <div class="flex items-center">
                        <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2">
                          <span class="text-xs text-white">TL</span>
                        </div>
                        技术负责人
                      </div>
                    </td>
                    <td class="py-2">tl@company.com</td>
                    <td class="py-2"><span class="badge badge-warning">技术负责人</span></td>
                    <td class="py-2"><span class="badge badge-success">在线</span></td>
                    <td class="py-2">2023-02-20</td>
                    <td class="py-2">
                      <button class="text-blue-600 hover:text-blue-800 mr-2">编辑</button>
                      <button class="text-red-600 hover:text-red-800">删除</button>
                    </td>
                  </tr>
                  <tr class="border-b">
                    <td class="py-2">
                      <div class="flex items-center">
                        <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center mr-2">
                          <span class="text-xs text-white">QA</span>
                        </div>
                        质量保证
                      </div>
                    </td>
                    <td class="py-2">qa@company.com</td>
                    <td class="py-2"><span class="badge badge-info">测试人员</span></td>
                    <td class="py-2"><span class="badge badge-warning">离线</span></td>
                    <td class="py-2">2023-03-10</td>
                    <td class="py-2">
                      <button class="text-blue-600 hover:text-blue-800 mr-2">编辑</button>
                      <button class="text-red-600 hover:text-red-800">删除</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="p-6 border-t">
          <div class="flex justify-between items-center">
            <div class="text-sm text-gray-600">
              共 3 名团队成员
            </div>
            <div class="flex justify-end space-x-4">
              <button onclick="hideTeamManagement()" class="btn btn-secondary">关闭</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>